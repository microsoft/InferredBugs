        private string Pinghost(string hostname, string stepname)
        {
            Ping ping = new Ping();
            IPAddress[] ipAddr = null;
            try
            {
                ipAddr = Dns.GetHostAddresses(hostname);
            }
            catch (SocketException e)
            {
                DetectorUtil.WriteLog(stepname + " failed!", false, LogStyle.StepFailed);
                throw new Exception(string.Format("Cannot resolve host name {0}.\r\n{1}", hostname, e.Message));
            }
            try
            {
                ping.Send(ipAddr[0]);
            }
            catch (PingException e)
            {
                DetectorUtil.WriteLog(stepname + " failed!", false, LogStyle.StepFailed);
                throw new Exception(string.Format("Ping {0} error.\r\n{1}", hostname, e.Message));
            }

            DetectorUtil.WriteLog(stepname + " successful.", false, LogStyle.StepPassed);
            return ipAddr[0].ToString();
        }