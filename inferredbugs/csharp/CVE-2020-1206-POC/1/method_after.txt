        private string Pinghost(string hostname, string stepname)
        {
            Ping ping = new Ping();
            IPAddress[] ipAddr = null;
            uint actualIpIndex = 0;
            try
            {
                ipAddr = Dns.GetHostAddresses(hostname);
                foreach (var ip in ipAddr)
                {
                    // Break if current IP is not loopback addr (127.0.0.1 or ::1)
                    // Otherwise increment actualIpIndex
                    if (!IPAddress.IsLoopback(ip))
                    {
                        break;
                    }
                    actualIpIndex += 1;
                }
            }
            catch (SocketException e)
            {
                DetectorUtil.WriteLog(stepname + " failed!", false, LogStyle.StepFailed);
                throw new Exception(string.Format("Cannot resolve host name {0}.\r\n{1}", hostname, e.Message));
            }
            try
            {
                ping.Send(ipAddr[actualIpIndex]);
            }
            catch (PingException e)
            {
                DetectorUtil.WriteLog(stepname + " failed!", false, LogStyle.StepFailed);
                throw new Exception(string.Format("Ping {0} error.\r\n{1}", hostname, e.Message));
            }

            DetectorUtil.WriteLog(stepname + " successful.", false, LogStyle.StepPassed);
            return ipAddr[actualIpIndex].ToString();
        }