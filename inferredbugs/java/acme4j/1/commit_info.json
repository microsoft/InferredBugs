{"hash": "41dabd0cfd3de84bbaf34a48daa906ca53df3ac1", "message": "Add updateAuthorization() method to get the current authorization state", "file_num_lines": 339, "diff_parsed": {"added": [[171, ""], [172, "            @Override"], [173, "            public URI getLocation() throws AcmeException {"], [174, "                return locationUri;"], [175, "            }"], [191, "        assertThat(auth.getLocation(), is(locationUri));"], [192, ""], [193, "        assertThat(auth.getChallenges(), containsInAnyOrder("], [194, "                        (Challenge) httpChallenge, (Challenge) dnsChallenge));"], [195, ""], [196, "        assertThat(auth.getCombinations(), hasSize(2));"], [197, "        assertThat(auth.getCombinations().get(0), containsInAnyOrder("], [198, "                        (Challenge) httpChallenge));"], [199, "        assertThat(auth.getCombinations().get(1), containsInAnyOrder("], [200, "                        (Challenge) httpChallenge, (Challenge) dnsChallenge));"], [201, "    }"], [202, ""], [203, "    /**"], [204, "     * Test that {@link Authorization} are properly updated."], [205, "     */"], [206, "    @Test"], [207, "    public void testUpdateAuthorization() throws AcmeException {"], [208, "        Authorization auth = new Authorization(locationUri);"], [209, ""], [210, "        Connection connection = new DummyConnection() {"], [211, "            @Override"], [212, "            public int sendRequest(URI uri) throws AcmeException {"], [213, "                assertThat(uri, is(locationUri));"], [214, "                return HttpURLConnection.HTTP_OK;"], [215, "            }"], [216, ""], [217, "            @Override"], [218, "            public Map<String, Object> readJsonResponse() throws AcmeException {"], [219, "                return getJsonAsMap(\"updateAuthorizationResponse\");"], [220, "            }"], [221, "        };"], [222, ""], [223, "        HttpChallenge httpChallenge = new HttpChallenge();"], [224, "        DnsChallenge dnsChallenge = new DnsChallenge();"], [225, ""], [226, "        TestableAbstractAcmeClient client = new TestableAbstractAcmeClient(connection);"], [227, "        client.putTestChallenge(\"http-01\", httpChallenge);"], [228, "        client.putTestChallenge(\"dns-01\", dnsChallenge);"], [229, ""], [230, "        client.updateAuthorization(auth);"], [231, ""], [232, "        assertThat(auth.getDomain(), is(\"example.org\"));"], [233, "        assertThat(auth.getStatus(), is(\"valid\"));"], [234, "        assertThat(auth.getExpires(), is(\"2015-03-01\"));"], [235, "        assertThat(auth.getLocation(), is(locationUri));"]], "deleted": []}, "num_lines_added": 50, "num_lines_removed": 0}