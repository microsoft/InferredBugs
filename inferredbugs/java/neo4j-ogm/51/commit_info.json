{"hash": "a52329c2c3726159a65c162b646d3d49b22546e0", "message": "Change graph id handling for new entities #381\n\nReplace `System.identityHashCode` with decrementing counter.\n\nThis commit changes how org.neo4j.ogm.utils.EntityUtils.identity()\nworks.\n\nWhen the id is present it is returned - same as before.\n\nWhen the id is missing identityHashCode was used, which means multiple\ncalls returned same value. To keep this behaviour the id generated value\nis written to the entity.\n\nCode that depended on the null value of the id was changed to\n< 0 and >= 0 comparisons.", "file_num_lines": 569, "diff_parsed": {"added": [[296, "        Long id = (Long) classInfo.identityField().readProperty(entity);"], [301, "        if (id < 0) {"], [354, "            if (srcIdentity >= 0) {"], [492, "            Long relId = (Long) EntityUtils.identity(entity, metaData);"], [496, "            if (relId < 0 || relationshipEndsChanged) { //if the RE itself is new, or it exists but has one of it's end nodes changed"], [571, "        Long tgtIdentity = EntityUtils.identity(targetEntity, metaData);"], [572, "        Long srcIdentity = EntityUtils.identity(startEntity, metaData);"], [588, "            if (tgtIdentity >= 0 && srcIdentity >= 0) {"], [639, "        Long id = (Long) relEntityClassInfo.identityField().readProperty(relationshipEntity);"], [640, "        if (id < 0) {"]], "deleted": [[296, "        Object id = classInfo.identityField().readProperty(entity);"], [301, "        if (id == null) {"], [354, "            if (srcIdentity != null) {"], [492, "            Long relId = (Long) metaData.classInfo(entity).identityField().readProperty(entity);"], [496, "            if (relId == null || relationshipEndsChanged) { //if the RE itself is new, or it exists but has one of it's end nodes changed"], [571, "        ClassInfo targetInfo = metaData.classInfo(targetEntity);"], [572, "        ClassInfo startInfo = metaData.classInfo(startEntity);"], [574, "        Long tgtIdentity = (Long) targetInfo.identityField().readProperty(targetEntity);"], [575, "        Long srcIdentity = (Long) startInfo.identityField().readProperty(startEntity);"], [590, "            if (tgtIdentity != null && srcIdentity != null) {"], [641, "        if (relEntityClassInfo.identityField().readProperty(relationshipEntity) == null) {"]]}, "num_lines_added": 10, "num_lines_removed": 11}