{"hash": "a52329c2c3726159a65c162b646d3d49b22546e0", "message": "Change graph id handling for new entities #381\n\nReplace `System.identityHashCode` with decrementing counter.\n\nThis commit changes how org.neo4j.ogm.utils.EntityUtils.identity()\nworks.\n\nWhen the id is present it is returned - same as before.\n\nWhen the id is missing identityHashCode was used, which means multiple\ncalls returned same value. To keep this behaviour the id generated value\nis written to the entity.\n\nCode that depended on the null value of the id was changed to\n< 0 and >= 0 comparisons.", "file_num_lines": 275, "diff_parsed": {"added": [[22, "import org.neo4j.ogm.utils.EntityUtils;"], [215, "            removeClass(type);"], [251, "        Long id = EntityUtils.identity(entity, metaData);"], [253, "        purge(entity, type);"], [255, "        if (id >= 0) {"], [283, "        Long id = EntityUtils.identity(entity, metaData);"], [285, "        if (id >= 0) {"], [329, "    private void removeClass(Class<?> type) {"], [332, "            purge(entity, type);"], [338, "    private void purge(Object entity, Class type) {"], [339, "        Long id = EntityUtils.identity(entity, metaData);"], [341, "        if (id >= 0) {"], [381, "                purge(relEntity, relClassInfo.getUnderlyingClass());"]], "deleted": [[214, "            removeType(type, identityReader);"], [250, "        ClassInfo classInfo = metaData.classInfo(type.getName());"], [251, "        FieldInfo identityReader = classInfo.identityField();"], [252, "        Long id = (Long) identityReader.readProperty(entity);"], [254, "        purge(entity, identityReader, type);"], [256, "        if (id != null) {"], [284, "        FieldInfo identityReader = classInfo.identityField();"], [285, ""], [286, "        Long id = (Long) identityReader.readProperty(entity);"], [288, "        if (id != null) {"], [332, "    private void removeType(Class<?> type, FieldInfo identityReader) {"], [335, "            purge(entity, identityReader, type);"], [341, "    private void purge(Object entity, FieldInfo fieldInfo, Class type) {"], [342, "        Long id = (Long) fieldInfo.readProperty(entity);"], [344, "        if (id != null) {"], [384, "                purge(relEntity, relIdentityReader, relClassInfo.getUnderlyingClass());"]]}, "num_lines_added": 13, "num_lines_removed": 16}