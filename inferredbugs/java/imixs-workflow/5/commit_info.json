{"hash": "d8e22022c7119806d0760c976896bd861973f4c4", "message": "issue #50", "file_num_lines": 276, "diff_parsed": {"added": [[142, ""], [176, "\t\t\t// e.printStackTrace();"], [244, ""], [245, "\t\tObject[] result = rulePlugin.evaluateScriptObject(engine, \"txtname\");"], [246, "\t\tif (result != null) {"], [251, "\t\tresult = rulePlugin.evaluateScriptObject(engine, \"someData\");"], [252, "\t\tif (result != null) {"], [325, "\t\tString script = \" var followUp=null;\""], [326, "\t\t\t\t+ \" if (_amount_brutto[0]>5000.50)\" + \"    followUp=90;\";"], [330, "\t\tadocumentContext.replaceItemValue(\"_amount_brutto\", new BigDecimal("], [331, "\t\t\t\t5000.51));"], [381, ""], [391, "\t/**"], [392, "\t * This test test if a the properties of an activity entity can be evaluated"], [393, "\t * by a script"], [394, "\t *"], [395, "\t * @throws ScriptException"], [396, "\t * @throws PluginException"], [397, "\t */"], [398, "\t@Test"], [399, "\tpublic void testSimpleActivityScript() throws ScriptException,"], [400, "\t\t\tPluginException {"], [401, ""], [402, "\t\tItemCollection adocumentContext = new ItemCollection();"], [403, "\t\tadocumentContext.replaceItemValue(\"txtName\", \"Anna\");"], [404, ""], [405, "\t\t// simulate an activity"], [406, "\t\tItemCollection adocumentActivity = new ItemCollection();"], [407, "\t\tadocumentActivity.replaceItemValue(\"keyMailEnabled\", \"1\");"], [408, ""], [409, "\t\t// set a business rule"], [410, "\t\tString script = \"var isValid =  '1'==activity.get('keymailenabled')[0];\";"], [411, ""], [412, "\t\tSystem.out.println(\"Script=\" + script);"], [413, "\t\tadocumentActivity.replaceItemValue(\"txtBusinessRUle\", script);"], [414, ""], [415, "\t\tint result = rulePlugin.run(adocumentContext, adocumentActivity);"], [416, ""], [417, "\t\tAssert.assertTrue(result == Plugin.PLUGIN_OK);"], [418, ""], [419, "\t\tAssert.assertTrue(rulePlugin.isValid(adocumentContext,"], [420, "\t\t\t\tadocumentActivity));"], [421, ""], [422, "\t}"], [423, ""], [424, "\t/**"], [425, "\t * This test test if a the properties of an workitem entity can be evaluated"], [426, "\t * by a script"], [427, "\t *"], [428, "\t * @throws ScriptException"], [429, "\t * @throws PluginException"], [430, "\t */"], [431, "\t@Test"], [432, "\tpublic void testSimpleWorkitemScript() throws ScriptException,"], [433, "\t\t\tPluginException {"], [434, ""], [435, "\t\tItemCollection adocumentContext = new ItemCollection();"], [436, "\t\tadocumentContext.replaceItemValue(\"txtName\", \"Anna\");"], [437, "\t\tadocumentContext.replaceItemValue(\"$ProcessID\", 1000);"], [438, "\t\t// simulate an activity"], [439, "\t\tItemCollection adocumentActivity = new ItemCollection();"], [440, "\t\tadocumentActivity.replaceItemValue(\"keyMailEnabled\", \"1\");"], [441, ""], [442, "\t\t// set a business rule"], [443, "\t\tString script = \"var isValid =  1000==workitem.get('$processid')[0];\";"], [444, ""], [445, "\t\tSystem.out.println(\"Script=\" + script);"], [446, "\t\tadocumentActivity.replaceItemValue(\"txtBusinessRUle\", script);"], [447, ""], [448, "\t\tint result = rulePlugin.run(adocumentContext, adocumentActivity);"], [449, ""], [450, "\t\tAssert.assertTrue(result == Plugin.PLUGIN_OK);"], [451, ""], [452, "\t\tAssert.assertTrue(rulePlugin.isValid(adocumentContext,"], [453, "\t\t\t\tadocumentActivity));"], [454, ""], [455, "\t}"], [456, ""], [457, "\t/**"], [458, "\t * This test test if a the properties of an workitem entity can be evaluated"], [459, "\t * by a script. In addition the test verifies if the workitem itself can be"], [460, "\t * manipulated by the script. This may not happen!"], [461, "\t *"], [462, "\t * But manipulation for an Activity should be possible!"], [463, "\t *"], [464, "\t * @throws ScriptException"], [465, "\t * @throws PluginException"], [466, "\t */"], [467, "\t@Test"], [468, "\tpublic void testComplexWorkitemScript() throws ScriptException,"], [469, "\t\t\tPluginException {"], [470, ""], [471, "\t\tItemCollection adocumentContext = new ItemCollection();"], [472, "\t\tadocumentContext.replaceItemValue(\"txtName\", \"Anna\");"], [473, "\t\tadocumentContext.replaceItemValue(\"$ProcessID\", 1000);"], [474, "\t\t// simulate an activity"], [475, "\t\tItemCollection adocumentActivity = new ItemCollection();"], [476, "\t\tadocumentActivity.replaceItemValue(\"keyMailEnabled\", \"1\");"], [477, ""], [478, "\t\t// set a business rule"], [479, "\t\tString script = \"\";"], [480, "\t\tscript += \"var isValid =  1000==workitem.get('$processid')[0];\";"], [481, "\t\t// now add a manipulation!"], [482, "\t\tscript += \" workitem.put('$processid',[99]);\";"], [483, "\t\t// add maniputlation to itemCollection"], [484, "\t\tscript += \" activity.put('keymailenabled',['0']);\";"], [485, ""], [486, "\t\tSystem.out.println(\"Script=\" + script);"], [487, "\t\tadocumentActivity.replaceItemValue(\"txtBusinessRUle\", script);"], [488, ""], [489, "\t\tint result = rulePlugin.run(adocumentContext, adocumentActivity);"], [490, ""], [491, "\t\tAssert.assertTrue(result == Plugin.PLUGIN_OK);"], [492, ""], [493, "\t\tAssert.assertTrue(rulePlugin.isValid(adocumentContext,"], [494, "\t\t\t\tadocumentActivity));"], [495, ""], [496, "\t\tAssert.assertEquals(1000,"], [497, "\t\t\t\tadocumentContext.getItemValueInteger(\"$ProcessID\"));"], [498, ""], [499, "\t\t// test manipulation of activity"], [500, "\t\tAssert.assertEquals(\"0\","], [501, "\t\t\t\tadocumentActivity.getItemValueString(\"keyMailEnabled\"));"], [502, "\t\t// test for integer value"], [503, "\t\tAssert.assertEquals(0,"], [504, "\t\t\t\tadocumentActivity.getItemValueInteger(\"keyMailEnabled\"));"], [505, ""], [506, "\t}"]], "deleted": [[142, ""], [176, "\t\t\t//e.printStackTrace();"], [244, ""], [245, "\t\tObject[] result=rulePlugin.evaluateScriptObject(engine,\"txtname\");"], [246, "\t\tif (result!=null) {"], [251, "\t\tresult=rulePlugin.evaluateScriptObject(engine,\"someData\");"], [252, "\t\tif (result!=null) {"], [315, ""], [316, ""], [317, ""], [328, "\t\tString script = \" var followUp=null;\" + \" if (_amount_brutto[0]>5000.50)\""], [329, "\t\t\t\t+ \"    followUp=90;\";"], [333, "\t\tadocumentContext.replaceItemValue(\"_amount_brutto\", new BigDecimal(5000.51));"], [350, ""], [353, ""], [354, ""], [355, ""], [356, ""], [357, ""], [358, ""], [359, ""], [360, ""], [361, ""], [362, ""], [363, ""], [395, ""]]}, "num_lines_added": 128, "num_lines_removed": 26}