{"hash": "7400bc551b5da287b8d682ff5237803899922870", "message": "fixed Class Cast Exception bug\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jsecurity/trunk@711024 13f79535-47bb-0310-9956-ffa450edef68", "file_num_lines": 19, "diff_parsed": {"added": [[22, "import org.jsecurity.util.CollectionUtils;"], [43, "        String[] rolesArray = (String[]) mappedValue;"], [44, ""], [45, "        if (rolesArray == null || rolesArray.length == 0) {"], [46, "            //no roles specified, so nothing to check - allow access."], [47, "            return true;"], [50, "        Set<String> roles = CollectionUtils.asSet(rolesArray);"], [51, "        return subject.hasAllRoles(roles);"]], "deleted": [[42, "        Set<String> roles = (Set<String>) mappedValue;"], [43, ""], [44, "        boolean hasRoles = true;"], [45, "        if (roles != null && !roles.isEmpty()) {"], [46, "            if (roles.size() == 1) {"], [47, "                if (!subject.hasRole(roles.iterator().next())) {"], [48, "                    hasRoles = false;"], [49, "                }"], [50, "            } else {"], [51, "                if (!subject.hasAllRoles(roles)) {"], [52, "                    hasRoles = false;"], [53, "                }"], [54, "            }"], [57, "        return hasRoles;"]]}, "num_lines_added": 8, "num_lines_removed": 14}