{"bug_class": "PROVER", "kind": "ERROR", "bug_type": "NULL_DEREFERENCE", "qualifier": "object `session.deployment` last assigned on line 182 could be null and is dereferenced by call to `isActive()` at line 183.", "severity": "HIGH", "visibility": "user", "line": 183, "column": -1, "procedure": "void KeycloakAuthenticatorValve.checkKeycloakSession(Request,HttpFacade)", "procedure_id": "org.keycloak.adapters.tomcat7.KeycloakAuthenticatorValve.checkKeycloakSession(org.apache.catalina.co.4e8490abf61e2cff39ec52b1d3b405c9", "procedure_start_line": 177, "file": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "bug_trace": [{"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 177, "column_number": -1, "description": "start of procedure checkKeycloakSession(...)"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 178, "column_number": -1, "description": "Taking true branch"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 178, "column_number": -1, "description": "Taking false branch"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 179, "column_number": -1, "description": ""}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 180, "column_number": -1, "description": "Taking false branch"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 182, "column_number": -1, "description": ""}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 57, "column_number": -1, "description": "start of procedure getDeployment()"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 58, "column_number": -1, "description": "return from a call to KeycloakDeployment RefreshableKeycloakSecurityContext.getDeployment()"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 182, "column_number": -1, "description": "Taking true branch"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/AdapterDeploymentContext.java", "line_number": 48, "column_number": -1, "description": "start of procedure resolveDeployment(...)"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/AdapterDeploymentContext.java", "line_number": 49, "column_number": -1, "description": ""}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/AdapterDeploymentContext.java", "line_number": 50, "column_number": -1, "description": "Taking true branch"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/AdapterDeploymentContext.java", "line_number": 55, "column_number": -1, "description": "return from a call to KeycloakDeployment AdapterDeploymentContext.resolveDeployment(HttpFacade)"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 182, "column_number": -1, "description": ""}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 61, "column_number": -1, "description": "start of procedure setDeployment(...)"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 62, "column_number": -1, "description": ""}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 63, "column_number": -1, "description": "return from a call to void RefreshableKeycloakSecurityContext.setDeployment(KeycloakDeployment)"}, {"level": 0, "filename": "integration/tomcat7/adapter/src/main/java/org/keycloak/adapters/tomcat7/KeycloakAuthenticatorValve.java", "line_number": 183, "column_number": -1, "description": ""}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 54, "column_number": -1, "description": "start of procedure isActive()"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 79, "column_number": -1, "description": "start of procedure isActive()"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 80, "column_number": -1, "description": ""}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 53, "column_number": -1, "description": "start of procedure isExpired()"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 54, "column_number": -1, "description": ""}, {"level": 4, "filename": "core/src/main/java/org/keycloak/util/Time.java", "line_number": 13, "column_number": -1, "description": "start of procedure currentTime()"}, {"level": 4, "filename": "core/src/main/java/org/keycloak/util/Time.java", "line_number": 13, "column_number": -1, "description": "return from a call to int Time.currentTime()"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 54, "column_number": -1, "description": "Taking true branch"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 54, "column_number": -1, "description": "return from a call to boolean JsonWebToken.isExpired()"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 80, "column_number": -1, "description": "Taking false branch"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 68, "column_number": -1, "description": "start of procedure isNotBefore()"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 69, "column_number": -1, "description": ""}, {"level": 4, "filename": "core/src/main/java/org/keycloak/util/Time.java", "line_number": 13, "column_number": -1, "description": "start of procedure currentTime()"}, {"level": 4, "filename": "core/src/main/java/org/keycloak/util/Time.java", "line_number": 13, "column_number": -1, "description": "return from a call to int Time.currentTime()"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 69, "column_number": -1, "description": "Taking true branch"}, {"level": 3, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 69, "column_number": -1, "description": "return from a call to boolean JsonWebToken.isNotBefore()"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 80, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 80, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 80, "column_number": -1, "description": "return from a call to boolean JsonWebToken.isActive()"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 54, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 83, "column_number": -1, "description": "start of procedure getIssuedAt()"}, {"level": 2, "filename": "core/src/main/java/org/keycloak/representations/JsonWebToken.java", "line_number": 84, "column_number": -1, "description": "return from a call to int JsonWebToken.getIssuedAt()"}, {"level": 1, "filename": "integration/adapter-core/src/main/java/org/keycloak/adapters/RefreshableKeycloakSecurityContext.java", "line_number": 54, "column_number": -1, "description": ""}], "key": "KeycloakAuthenticatorValve.java|checkKeycloakSession|NULL_DEREFERENCE", "node_key": "dc9986604e83d90bc0a0042a8f0ca6d0", "hash": "4602219ccc3260ec5701c0db5f3d9768", "bug_type_hum": "Null Dereference", "censored_reason": ""}