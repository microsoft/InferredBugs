{"bug_class": "PROVER", "kind": "ERROR", "bug_type": "THREAD_SAFETY_VIOLATION", "qualifier": "Read/Write race. Non-private method `com.alibaba.nacos.naming.core.ServiceManager.updateIpAddresses` indirectly reads without synchronization from `instance.com.alibaba.nacos.api.naming.pojo.Instance.instanceIndex`. Potentially races with write in method `ServiceManager.removeInstance(...)`.\n Reporting because another access to the same memory occurs on a background thread, although this access may not.\n\nNote that the prefix path instance has been contaminated during the execution, so the reported race on instance.com.alibaba.nacos.api.naming.pojo.Instance.instanceIndex might be a false positive.", "severity": "HIGH", "visibility": "user", "line": 591, "column": -1, "procedure": "List ServiceManager.updateIpAddresses(Service,String,boolean,com.alibaba.nacos.naming.core.Instance[])", "procedure_id": "com.alibaba.nacos.naming.core.ServiceManager.updateIpAddresses(com.alibaba.nacos.naming.core.Service.86cdfd6a82ea313b34dd4473d240e6b5", "procedure_start_line": 580, "file": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "bug_trace": [{"level": 0, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 591, "column_number": -1, "description": "<Read trace>"}, {"level": 0, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 591, "column_number": -1, "description": "call to Integer Instance.getInstanceIndex()"}, {"level": 1, "filename": "api/src/main/java/com/alibaba/nacos/api/naming/pojo/Instance.java", "line_number": 177, "column_number": -1, "description": "access to `this.com.alibaba.nacos.api.naming.pojo.Instance.instanceIndex`"}, {"level": 0, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 541, "column_number": -1, "description": "<Write trace>"}, {"level": 0, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 541, "column_number": -1, "description": "call to void ServiceManager.removeInstance(String,String,boolean,Service,com.alibaba.nacos.naming.core.Instance[])"}, {"level": 1, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 549, "column_number": -1, "description": "call to List ServiceManager.substractIpAddresses(Service,boolean,com.alibaba.nacos.naming.core.Instance[])"}, {"level": 2, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 635, "column_number": -1, "description": "call to List ServiceManager.updateIpAddresses(Service,String,boolean,com.alibaba.nacos.naming.core.Instance[])"}, {"level": 3, "filename": "naming/src/main/java/com/alibaba/nacos/naming/core/ServiceManager.java", "line_number": 620, "column_number": -1, "description": "call to void Instance.setInstanceIndex(Integer)"}, {"level": 4, "filename": "api/src/main/java/com/alibaba/nacos/api/naming/pojo/Instance.java", "line_number": 181, "column_number": -1, "description": "access to `this.com.alibaba.nacos.api.naming.pojo.Instance.instanceIndex`"}], "key": "ServiceManager.java|updateIpAddresses|THREAD_SAFETY_VIOLATION", "node_key": "9c5d6d9028928346cc4fb44cced5dea1", "hash": "eff77f4dc44f5e214c8b79cec6d644e4", "bug_type_hum": "Thread Safety Violation", "censored_reason": ""}