{"hash": "f5cbe77170da0c33fc6cfdda1e9aebbffa190c96", "message": "Optimized. Avoid large ClassPool memory usage", "file_num_lines": 40, "diff_parsed": {"added": [[14, "import org.hotswap.agent.plugin.proxy.java.NewClassLoaderJavaProxyTransformer;"], [37, "\t\tif (NewClassLoaderJavaProxyTransformer.isProxy(classBeingRedefined.getName())) {"], [38, "\t\t\treturn NewClassLoaderJavaProxyTransformer.transform(classBeingRedefined, classfileBuffer, loader);"], [39, "\t\t} else if (CglibProxyTransformer.isProxy(loader, classBeingRedefined.getName())) {"], [40, "\t\t\treturn CglibProxyTransformer.transform(classBeingRedefined, classfileBuffer, loader);"], [42, "\t\treturn classfileBuffer;"], [56, "\t\t\t// we dont need to store the defined CtClass-es in the pool"]], "deleted": [[10, "import org.hotswap.agent.javassist.ClassPool;"], [15, "import org.hotswap.agent.plugin.proxy.java.JavaProxyTransformer;"], [16, "import org.hotswap.agent.plugin.proxy.java.JavassistProxyTransformer;"], [39, "\t\t// load the class in the pool for ClassfileSignatureComparer and JavassistProxyTransformer"], [40, "\t\tClassPool cp = ProxyTransformationUtils.getClassPool(loader);"], [41, "\t\tCtClass cc = cp.makeClass(new ByteArrayInputStream(classfileBuffer), false);"], [42, ""], [43, "\t\tbyte[] result = classfileBuffer;"], [44, ""], [45, "\t\tboolean useJavassistProxyTransformer = true;"], [46, "\t\tif (useJavassistProxyTransformer) {"], [47, "\t\t\tresult = JavassistProxyTransformer.transform(classBeingRedefined, cc, cp, result);"], [48, "\t\t} else {"], [49, "\t\t\tresult = JavaProxyTransformer.transform(classBeingRedefined, cc, cp, result);"], [51, "\t\treturn CglibProxyTransformer.transform(classBeingRedefined, cc, cp, result, loader);"], [65, "\t\t\t// we dont need to store defined CtClass-es in the pool"]]}, "num_lines_added": 7, "num_lines_removed": 16}