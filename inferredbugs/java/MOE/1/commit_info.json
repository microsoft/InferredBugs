{"hash": "9b0bb0ab6884db3916096604e4e0f61db6ce5382", "message": "Remove more Injector.INSTANCE calls, or move them further up the call-stack.\n\tChange on 2015/08/24 by cgruber <cgruber@google.com>\n-------------\nCreated by MOE: https://github.com/google/moe\nMOE_MIGRATED_REVID=101369064", "file_num_lines": 130, "diff_parsed": {"added": [[9, "import com.google.devtools.moe.client.CommandRunner;"], [13, "import com.google.devtools.moe.client.Ui;"], [66, "// TODO(cgruber) AutoFactory or split out a MergeResult object with metadata/reporting."], [68, "  private final Ui ui;"], [69, "  private final FileSystem filesystem;"], [70, "  private final CommandRunner cmd;"], [75, "      Ui ui,"], [76, "      FileSystem filesystem,"], [77, "      CommandRunner cmd,"], [78, "      Codebase originalCodebase,"], [79, "      Codebase modifiedCodebase,"], [80, "      Codebase destinationCodebase) {"], [81, "    this.ui = ui;"], [82, "    this.filesystem = filesystem;"], [83, "    this.cmd = cmd;"], [88, "    File mergedDir = filesystem.getTemporaryDirectory(\"merged_codebase_\");"], [126, "    ui.info(\"Merged codebase generated at: %s\", mergedCodebase.getPath().getAbsolutePath());"], [127, "    ui.info("], [128, "        \"%d files merged successfully\\n%d files have merge \""], [129, "            + \"conflicts. Edit the following files to resolve conflicts:\\n%s\","], [130, "        mergedFiles.size(),"], [131, "        failedToMergeFiles.size(),"], [132, "        failedToMergeFiles);"], [146, "      filesystem.makeDirsForFile(mergedFile);"], [147, "      filesystem.copyFile(destFile, mergedFile);"], [169, "    boolean origExists = filesystem.exists(origFile);"], [172, "    boolean destExists = filesystem.exists(destFile);"], [175, "    boolean modExists = filesystem.exists(modFile);"], [216, "      cmd.runCommand("], [217, "          \"merge\","], [218, "          ImmutableList.of("], [219, "              mergedFile.getAbsolutePath(), origFile.getAbsolutePath(), modFile.getAbsolutePath()),"], [220, "          this.mergedCodebase.getPath().getAbsolutePath());"]], "deleted": [[11, "import com.google.devtools.moe.client.Injector;"], [66, ""], [71, "      Codebase originalCodebase, Codebase modifiedCodebase, Codebase destinationCodebase) {"], [76, "    File mergedDir = Injector.INSTANCE.fileSystem().getTemporaryDirectory(\"merged_codebase_\");"], [114, "    Injector.INSTANCE"], [115, "        .ui()"], [116, "        .info(\"Merged codebase generated at: %s\", mergedCodebase.getPath().getAbsolutePath());"], [117, "    Injector.INSTANCE"], [118, "        .ui()"], [119, "        .info("], [120, "            \"%d files merged successfully\\n%d files have merge \""], [121, "                + \"conflicts. Edit the following files to resolve conflicts:\\n%s\","], [122, "            mergedFiles.size(),"], [123, "            failedToMergeFiles.size(),"], [124, "            failedToMergeFiles);"], [136, "    FileSystem fs = Injector.INSTANCE.fileSystem();"], [139, "      fs.makeDirsForFile(mergedFile);"], [140, "      fs.copyFile(destFile, mergedFile);"], [161, "    FileSystem fs = Injector.INSTANCE.fileSystem();"], [162, ""], [164, "    boolean origExists = fs.exists(origFile);"], [167, "    boolean destExists = fs.exists(destFile);"], [170, "    boolean modExists = fs.exists(modFile);"], [211, "      Injector.INSTANCE"], [212, "          .cmd()"], [213, "          .runCommand("], [214, "              \"merge\","], [215, "              ImmutableList.of("], [216, "                  mergedFile.getAbsolutePath(),"], [217, "                  origFile.getAbsolutePath(),"], [218, "                  modFile.getAbsolutePath()),"], [219, "              this.mergedCodebase.getPath().getAbsolutePath());"]]}, "num_lines_added": 33, "num_lines_removed": 32}