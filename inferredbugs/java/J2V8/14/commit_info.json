{"hash": "d6c99e0de243d9b6e68f384b22c07db859d2ea28", "message": "Add lightweight wrappers for TypedArrays and ArrayBuffers\n\nThe V8TypedArrays and V8ArrayBuffers contain handles to V8\nobjects which must be released. This change-set adds\nlightweight wrappers for these two objects. These lightweight\nwrappers have no underlying resource associated with them\nand do not have to be released.\n\nIf the objects which they wrap are accessed, those objects\nmust be released.", "file_num_lines": 2284, "diff_parsed": {"added": [[19, "import java.nio.ByteBuffer;"], [1258, "        V8ArrayBuffer result = ((ArrayBuffer) V8ObjectUtils.getValue(root, 0)).getV8ArrayBuffer();"], [1273, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1288, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1303, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1319, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1335, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1351, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1367, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1384, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1400, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1416, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, 0)).getV8TypedArray();"], [1430, "        V8ArrayBuffer result = ((ArrayBuffer) V8ObjectUtils.getValue(root, \"items\")).getV8ArrayBuffer();"], [1445, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1461, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1477, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1493, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1509, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1525, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1541, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1557, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1573, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(root, \"items\")).getV8TypedArray();"], [1581, ""], [1584, "        TypedArray int8Array = new TypedArray(v8, new ArrayBuffer(v8, ByteBuffer.allocateDirect(8)), V8Value.INT_8_ARRAY, 0, 8);"], [1585, "        V8TypedArray v8TypedArray = int8Array.getV8TypedArray();"], [1586, "        V8ArrayBuffer v8ArrayBuffer = v8TypedArray.getBuffer();"], [1587, "        v8ArrayBuffer.put(0, (byte) 7);"], [1588, "        v8TypedArray.close();"], [1589, "        v8ArrayBuffer.close();"], [1596, "        assertEquals((byte) 7, v8Array.get(0));"], [1604, "        TypedArray int8Array = new TypedArray(v8, new ArrayBuffer(v8, ByteBuffer.allocateDirect(8)), V8Value.INT_8_ARRAY, 0, 8);"], [1605, "        V8TypedArray v8TypedArray = int8Array.getV8TypedArray();"], [1606, "        V8ArrayBuffer v8ArrayBuffer = v8TypedArray.getBuffer();"], [1607, "        v8ArrayBuffer.put(0, (byte) 7);"], [1608, "        v8TypedArray.close();"], [1609, "        v8ArrayBuffer.close();"], [1613, "        assertEquals((byte) 7, v8Array.get(0));"], [1620, "        ArrayBuffer arrayBuffer = new ArrayBuffer(v8, ByteBuffer.allocateDirect(8));"], [1627, "        assertEquals(arrayBuffer.getV8ArrayBuffer().setWeak(), v8ArrayBuffer);"], [1634, "        ArrayBuffer arrayBuffer = new ArrayBuffer(v8, ByteBuffer.allocateDirect(8));"], [1641, "        assertEquals(arrayBuffer.getV8ArrayBuffer().setWeak(), v8ArrayBuffer);"], [1648, "        ArrayBuffer arrayBuffer = new ArrayBuffer(v8, ByteBuffer.allocateDirect(8));"], [1652, "        assertEquals(arrayBuffer.getV8ArrayBuffer().setWeak(), v8ArrayBuffer);"], [1658, "        ArrayBuffer arrayBuffer = new ArrayBuffer(v8, ByteBuffer.allocateDirect(8));"], [1668, "        TypedArray int8Array = new TypedArray(v8, new ArrayBuffer(v8, ByteBuffer.allocateDirect(8)), V8Value.INT_8_ARRAY, 0, 8);"], [1669, "        V8TypedArray v8TypedArray = int8Array.getV8TypedArray();"], [1670, "        V8ArrayBuffer v8ArrayBuffer = v8TypedArray.getBuffer();"], [1671, "        v8ArrayBuffer.put(0, (byte) 7);"], [1672, "        v8TypedArray.close();"], [1673, "        v8ArrayBuffer.close();"], [1680, "        assertEquals((byte) 7, v8Array.get(0));"], [2417, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2422, "        result.close();"], [2431, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2435, "        result.close();"], [2445, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2450, "        result.close();"], [2460, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(int8ClampedArray)).getV8TypedArray();"], [2465, "        result.close();"], [2475, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2480, "        result.close();"], [2490, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2495, "        result.close();"], [2505, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2510, "        result.close();"], [2520, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(intsArray)).getV8TypedArray();"], [2525, "        result.close();"], [2535, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(floatsArray)).getV8TypedArray();"], [2540, "        result.close();"], [2550, "        V8TypedArray result = ((TypedArray) V8ObjectUtils.getValue(floatsArray)).getV8TypedArray();"], [2555, "        result.close();"], [2563, "        V8ArrayBuffer result = ((ArrayBuffer) V8ObjectUtils.getValue(buf)).getV8ArrayBuffer();"], [2567, "        result.close();"], [2696, "        @SuppressWarnings(\"resource\")"]], "deleted": [[1257, "        V8ArrayBuffer result = (V8ArrayBuffer) V8ObjectUtils.getValue(root, 0);"], [1272, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1287, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1302, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1318, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1334, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1350, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1366, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1383, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1399, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1415, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, 0);"], [1429, "        V8ArrayBuffer result = (V8ArrayBuffer) V8ObjectUtils.getValue(root, \"items\");"], [1444, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1460, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1476, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1492, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1508, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1524, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1540, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1556, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1572, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(root, \"items\");"], [1580, "    /*"], [1583, "        Int8Array int8Array = new Int8Array(ByteBuffer.allocateDirect(8));"], [1584, "        int8Array.put(0, (byte) 7);"], [1591, "        assertEquals(7, v8Array.get(0));"], [1596, "    */"], [1598, "    /*"], [1601, "        Int8Array int8Array = new Int8Array(ByteBuffer.allocateDirect(8));"], [1602, "        int8Array.put(0, (byte) 7);"], [1606, "        assertEquals(7, v8Array.get(0));"], [1610, "    */"], [1612, "    /*"], [1615, "        ArrayBuffer arrayBuffer = new ArrayBuffer(8);"], [1622, "        assertEquals(arrayBuffer.getByteBuffer(), v8ArrayBuffer.getBackingStore());"], [1626, "    */"], [1628, "    /*"], [1631, "        ArrayBuffer arrayBuffer = new ArrayBuffer(8);"], [1638, "        assertEquals(arrayBuffer.getByteBuffer(), v8ArrayBuffer.getBackingStore());"], [1642, "    */"], [1644, "    /*"], [1647, "        ArrayBuffer arrayBuffer = new ArrayBuffer(8);"], [1651, "        assertEquals(arrayBuffer.getByteBuffer(), v8ArrayBuffer.getBackingStore());"], [1654, "    */"], [1656, "    /*"], [1659, "        ArrayBuffer arrayBuffer = new ArrayBuffer(8);"], [1666, "    */"], [1668, "    /*"], [1671, "        Int8Array int8Array = new Int8Array(ByteBuffer.allocateDirect(8));"], [1672, "        int8Array.put(0, (byte) 7);"], [1679, "        assertEquals(7, v8Array.get(0));"], [1684, "    */"], [2417, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2430, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2443, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2457, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(int8ClampedArray);"], [2471, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2485, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2499, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2513, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(intsArray);"], [2527, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(floatsArray);"], [2541, "        V8TypedArray result = (V8TypedArray) V8ObjectUtils.getValue(floatsArray);"], [2553, "        V8ArrayBuffer result = (V8ArrayBuffer) V8ObjectUtils.getValue(buf);"]]}, "num_lines_added": 74, "num_lines_removed": 62}