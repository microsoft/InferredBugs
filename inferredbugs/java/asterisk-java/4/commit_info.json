{"hash": "5533279429e5c2984ce1363d58cc0d118546bf9a", "message": "Attempt to support some proxy actions", "file_num_lines": 921, "diff_parsed": {"added": [[501, "        fireEvent(connectEvent);"], [639, "    /*"], [640, "     * Implements synchronous sending of \"simple\" actions."], [641, "     */"], [693, "        final String internalActionId;"], [697, "            throw new IllegalArgumentException(\"Unable to send action: action is null.\");"], [700, "        // In general sending actions is only allowed while connected, though"], [701, "        // there are a few exceptions, these are handled here:"], [706, "            //TODO add ProxyLogin"], [746, "    /*"], [747, "     * Implements synchronous sending of event generating actions."], [748, "     */"], [754, "        final ResponseEventsImpl responseEvents;"], [755, "        final ResponseEventHandler responseEventHandler;"], [756, "        final String internalActionId;"], [769, "        else if (!ResponseEvent.class.isAssignableFrom(action.getActionCompleteEventClass()))"], [785, "        responseEventHandler = new ResponseEventHandler("], [786, "                responseEvents,"], [787, "                action.getActionCompleteEventClass());"], [800, "            this.responseEventListeners.put(internalActionId, responseEventHandler);"], [806, "            // only wait if response has not yet arrived."], [807, "            if ((responseEvents.getResponse() == null || !responseEvents.isComplete()))"], [809, "                try"], [810, "                {"], [811, "                    responseEvents.wait(timeout);"], [812, "                }"], [813, "                catch (InterruptedException e)"], [814, "                {"], [815, "                    logger.warn(\"Interrupted while waiting for response events.\");"], [816, "                }"], [821, "        if ((responseEvents.getResponse() == null || !responseEvents.isComplete()))"], [836, "        // remove the event handler"], [837, "        // Note: The response handler has already been removed"], [838, "        //       when the response was received"], [949, "            logger.error(\"Unable to dispatch null response. This should never happen. Please file a bug.\");"], [996, "            catch (Exception e)"], [1018, "            logger.error(\"Unable to dispatch null event. This should never happen. Please file a bug.\");"], [1024, "        // Some events need special treatment besides forwarding them to the"], [1025, "        // registered eventListeners (clients)"], [1026, "        // These events are handled here at first:"], [1027, ""], [1028, "        // Dispatch ResponseEvents to the appropriate responseEventListener"], [1049, "                        catch (Exception e)"], [1051, "                            logger.warn(\"Unexpected exception in response event listener \""], [1062, "                // Example: QueueMemberStatusEvent."], [1069, "            // When we receive get disconnected while we are connected start"], [1070, "            // a new reconnect thread and set the state to RECONNECTING."], [1074, "                // close socket if still open and remove reference to readerThread"], [1075, "                // After sending the DisconnectThread that thread will die anyway."], [1087, "                // now the DisconnectEvent is dispatched to registered eventListeners"], [1088, "                // (clients) and after that the ManagerReaderThread is gone."], [1089, "                // So effectively we replaced the reader thread by a ReconnectThread."], [1090, "            }"], [1091, "            else"], [1092, "            {"], [1093, "                // when we receive a DisconnectEvent while not connected we"], [1094, "                // ignore it and do not send it to clients"], [1095, "                return;"], [1106, "            // no need to send this event to clients"], [1107, "            return;"], [1110, "        fireEvent(event);"], [1111, "    }"], [1112, ""], [1113, "    /**"], [1114, "     * Notifies all {@link ManagerEventListener}s registered by users."], [1115, "     *"], [1116, "     * @param event the event to propagate"], [1117, "     */"], [1118, "    private void fireEvent(ManagerEvent event)"], [1119, "    {"], [1136, ""]], "deleted": [[501, "        dispatchEvent(connectEvent);"], [690, "        String internalActionId;"], [694, "            throw new IllegalArgumentException("], [695, "                    \"Unable to send action: action is null.\");"], [746, "        ResponseEventsImpl responseEvents;"], [747, "        ResponseEventHandler responseEventHandler;"], [748, "        String internalActionId;"], [761, "        else if (!ResponseEvent.class.isAssignableFrom(action"], [762, "                .getActionCompleteEventClass()))"], [778, "        responseEventHandler = new ResponseEventHandler(responseEvents, action"], [779, "                .getActionCompleteEventClass());"], [792, "            this.responseEventListeners.put(internalActionId,"], [793, "                    responseEventHandler);"], [799, "            try"], [801, "                responseEvents.wait(timeout);"], [802, "            }"], [803, "            catch (InterruptedException ex)"], [804, "            {"], [805, "                logger.warn(\"Interrupted while waiting for response events\");"], [810, "        if ((responseEvents.getResponse() == null || !responseEvents"], [811, "                .isComplete()))"], [826, "        // remove the event handler (note: the response handler is removed"], [827, "        // automatically when the response is received)"], [938, "            logger.error(\"Unable to dispatch null response\");"], [985, "            catch (RuntimeException e)"], [1007, "            logger.error(\"Unable to dispatch null event\");"], [1013, "        // dispatch ResponseEvents to the appropriate responseEventHandler"], [1034, "                        catch (RuntimeException e)"], [1036, "                            logger.warn(\"Unexpected exception in event listener \""], [1047, "                // example: QueueMemberStatusEvent."], [1080, "        // dispatch to listeners registered by users"], [1097, ""]]}, "num_lines_added": 71, "num_lines_removed": 32}