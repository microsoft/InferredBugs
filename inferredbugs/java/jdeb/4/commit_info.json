{"hash": "018fb17d1610110e466db208fee1bdc12474e603", "message": "Added support for bzip2 compressed archives in the <data> element of the Ant task", "file_num_lines": 63, "diff_parsed": {"added": [[21, "import java.io.InputStream;"], [22, "import java.io.PushbackInputStream;"], [25, "import org.apache.tools.bzip2.CBZip2InputStream;"], [50, "\t\t\tarchiveInputStream = new TarInputStream(getCompressedInputStream(new FileInputStream(archive)));"], [84, "\t}"], [86, ""], [87, "\t/**"], [88, "\t * Guess the compression used by looking at the first bytes of the stream."], [89, "\t */"], [90, "\tprivate InputStream getCompressedInputStream(InputStream in) throws IOException {"], [91, "\t\tPushbackInputStream pin = new PushbackInputStream(in, 2);"], [92, "\t\tbyte[] header = new byte[2];"], [93, "\t\tpin.read(header);"], [94, ""], [95, "\t\tif (header[0] == (byte) 0x1f && header[1] == (byte) 0x8b) {"], [96, "\t\t\tpin.unread(header);"], [97, "\t\t\treturn new GZIPInputStream(pin);"], [98, "\t\t} else if (header[0] == 'B' && header[1] == 'Z') {"], [99, "\t\t\treturn new CBZip2InputStream(pin);"], [100, "\t\t} else {"], [101, "\t\t\tthrow new IOException(\"Unsupported archive format : \" + archive);"], [102, "\t\t}"], [103, "\t}"]], "deleted": [[47, "\t\t\tarchiveInputStream = new TarInputStream(new GZIPInputStream(new FileInputStream(archive)));"], [81, "\t}"], [83, ""]]}, "num_lines_added": 23, "num_lines_removed": 3}