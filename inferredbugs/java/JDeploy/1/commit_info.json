{"hash": "7dd22cf00fc7cb3acc7ddd2687ce89f7a9533963", "message": "\u66f4\u65b0\u8c03\u7528Shell\u811a\u672c\u7684\u5b9e\u73b0\uff0c\u91c7\u7528commons-exec\uff0c\u6dfb\u52a0\u8d85\u65f6\u673a\u5236\u3002", "file_num_lines": 21, "diff_parsed": {"added": [[3, "import org.apache.commons.exec.CommandLine;"], [4, "import org.apache.commons.exec.DefaultExecutor;"], [5, "import org.apache.commons.exec.ExecuteWatchdog;"], [6, "import org.apache.commons.exec.PumpStreamHandler;"], [8, "import java.io.ByteArrayOutputStream;"], [16, "\tpublic static String exec(String cmd) throws IOException {"], [17, ""], [18, "\t\tCommandLine cmdLine = CommandLine.parse(cmd);"], [19, "\t\tDefaultExecutor executor = new DefaultExecutor();"], [20, ""], [21, "\t\t// \u9632\u6b62\u629b\u51fa\u5f02\u5e38"], [22, "\t\texecutor.setExitValues(null);"], [23, ""], [24, "\t\t// \u547d\u4ee4\u6267\u884c\u7684\u8d85\u65f6\u65f6\u95f4"], [25, "\t\tExecuteWatchdog watchdog = new ExecuteWatchdog(600000);"], [26, "\t\texecutor.setWatchdog(watchdog);"], [27, ""], [28, "\t\tByteArrayOutputStream outputStream = new ByteArrayOutputStream();"], [29, "\t\tPumpStreamHandler streamHandler = new PumpStreamHandler(outputStream);"], [30, "\t\texecutor.setStreamHandler(streamHandler);"], [31, ""], [32, "\t\texecutor.execute(cmdLine);"], [33, ""], [34, "\t\treturn outputStream.toString();"], [35, "\t}"]], "deleted": [[3, "import org.apache.commons.io.IOUtils;"], [6, "import java.io.InputStream;"], [13, "    public static String exec(String cmd) throws IOException {"], [14, "        Process process = Runtime.getRuntime().exec(cmd);"], [15, "        InputStream inputStream = process.getInputStream();"], [16, "        InputStream errorStream = process.getErrorStream();"], [17, "        try {"], [18, "            String err = IOUtils.toString(errorStream, \"UTF-8\");"], [19, "            String out = IOUtils.toString(inputStream, \"UTF-8\");"], [20, "            return err + \"\\n\" + out;"], [21, "        } finally {"], [22, "            inputStream.close();"], [23, "            errorStream.close();"], [24, "        }"], [25, "    }"]]}, "num_lines_added": 25, "num_lines_removed": 15}