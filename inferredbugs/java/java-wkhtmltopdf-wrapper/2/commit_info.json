{"hash": "1c7cc9f94f3b353ec84016b0865a1848b1d07a8d", "message": "Do not persist file on harddrive but redirect from stdOut into byteArray, save to file if explicitly requested", "file_num_lines": 92, "diff_parsed": {"added": [[3, "import java.io.*;"], [70, "        byte[] pdf = this.getPDF();"], [71, "        File file = new File(path);"], [72, ""], [73, "        BufferedOutputStream bufferedOutputStream = new BufferedOutputStream(new FileOutputStream(file));"], [74, "        bufferedOutputStream.write(pdf);"], [75, "        bufferedOutputStream.flush();"], [76, "        bufferedOutputStream.close();"], [77, ""], [78, "        return file;"], [79, "\t}"], [80, ""], [81, "    public byte[] getPDF() throws IOException, InterruptedException {"], [82, "        Runtime runtime = Runtime.getRuntime();"], [83, "        if(htmlFromString && !this.params.contains(new Param(\"-\"))) {"], [84, "            this.addParam(new Param(\"-\"));"], [85, "        }"], [86, "        String command = this.commandWithParameters() + Symbol.separator + \"-\";"], [87, "        Process process = runtime.exec(command);"], [89, "            OutputStream stdInStream = process.getOutputStream();"], [90, "            stdInStream.write(htmlInput.getBytes());"], [91, "            stdInStream.close();"], [93, "        InputStream stdOutStream = process.getInputStream();"], [94, "        InputStream stdErrStream = process.getErrorStream();"], [95, "        process.waitFor();"], [97, "        ByteArrayOutputStream stdOut = new ByteArrayOutputStream();"], [98, "        ByteArrayOutputStream stdErr = new ByteArrayOutputStream();"], [99, ""], [100, "        for(int i = 0; i < stdOutStream.available(); i++) {"], [101, "            stdOut.write((char) stdOutStream.read());"], [102, "        }"], [103, "        stdOutStream.close();"], [104, "        for(int i = 0; i < stdErrStream.available(); i++) {"], [105, "            stdErr.write((char) stdErrStream.read());"], [107, "        stdErrStream.close();"], [109, "        if(process.exitValue() != 0) {"], [110, "            throw new RuntimeException(\"Process (\" + command + \") exited with status code \" + process.exitValue() + \":\\n\"+new String(stdErr.toByteArray()));"], [111, "        }"], [112, ""], [113, "        return stdOut.toByteArray();"], [114, "    }"]], "deleted": [[3, "import java.io.File;"], [4, "import java.io.IOException;"], [5, "import java.io.OutputStream;"], [68, "\t * TODO save file and returns"], [69, "\t *"], [74, "\t\tRuntime rt = Runtime.getRuntime();"], [75, "        String command = this.commandWithParameters() + Symbol.separator + path;"], [76, "        Process proc = rt.exec(command);"], [78, "            OutputStream stdin = proc.getOutputStream();"], [79, "            stdin.write(htmlInput.getBytes());"], [80, "            stdin.close();"], [83, "\t\tproc.waitFor();"], [84, "        if(proc.exitValue() != 0) {"], [85, "            throw new RuntimeException(\"Process (\" + command + \") exited with status code \" + proc.exitValue());"], [88, "\t\treturn new File(path);"], [89, "\t}"]]}, "num_lines_added": 41, "num_lines_removed": 16}