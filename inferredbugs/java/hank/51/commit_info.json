{"hash": "60ae08c6210be68a1eb8f5b68d3c311d03af0033", "message": "Add Snappy as an option for Curly block compression.", "file_num_lines": 102, "diff_parsed": {"added": [[128, ""], [129, "  public void testSnappyBlockCompression() throws Exception {"], [130, "    ByteArrayOutputStream s = new ByteArrayOutputStream();"], [131, "    MapWriter keyfileWriter = new MapWriter();"], [132, "    CurlyWriter writer = new CurlyWriter(s, keyfileWriter, 3, -1, BlockCompressionCodec.SNAPPY, 1024, 2);"], [133, "    writer.write(KEY1, VALUE1);"], [134, "    writer.write(KEY2, VALUE2);"], [135, "    writer.write(KEY3, VALUE3);"], [136, "    writer.close();"], [137, "    assertTrue(writer.getNumBytesWritten() > 0);"], [138, "    assertEquals(3, writer.getNumRecordsWritten());"], [139, ""], [140, "    // verify the keyfile looks as expected"], [141, "    assertTrue(keyfileWriter.entries.containsKey(KEY1));"], [142, "    assertEquals(ByteBuffer.wrap(new byte[]{0, 0, 0, 0, 0}), keyfileWriter.entries.get(KEY1));"], [143, "    assertTrue(keyfileWriter.entries.containsKey(KEY2));"], [144, "    assertEquals(ByteBuffer.wrap(new byte[]{0, 0, 0, 5, 0}), keyfileWriter.entries.get(KEY2));"], [145, "    assertTrue(keyfileWriter.entries.containsKey(KEY3));"], [146, "    assertEquals(ByteBuffer.wrap(new byte[]{0, 0, 0, 10, 0}), keyfileWriter.entries.get(KEY3));"], [147, ""], [148, "    assertFalse(keyfileWriter.entries.containsKey(KEY4));"], [149, ""], [150, "    // verify that the record stream looks as expected"], [151, "    assertEquals(ByteBuffer.wrap(EXPECTED_RECORD_FILE_BLOCK_COMPRESSED_SNAPPY), ByteBuffer.wrap(s.toByteArray()));"], [152, "  }"]], "deleted": [[19, "import com.rapleaf.hank.util.Bytes;"], [118, "    System.out.println(\"k1=\" + Bytes.bytesToHexString(keyfileWriter.entries.get(KEY1))); //TODO: remove"], [119, "    System.out.println(\"k2=\" + Bytes.bytesToHexString(keyfileWriter.entries.get(KEY2))); //TODO: remove"], [120, "    System.out.println(\"k3=\" + Bytes.bytesToHexString(keyfileWriter.entries.get(KEY3))); //TODO: remove"], [130, "    System.out.println(Bytes.bytesToHexString(ByteBuffer.wrap(s.toByteArray()))); //TODO: remove"]]}, "num_lines_added": 25, "num_lines_removed": 5}