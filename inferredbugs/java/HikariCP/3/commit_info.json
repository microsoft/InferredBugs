{"hash": "8378ab9d1eae23f11f34fc37f8fcdfdb716be1ae", "message": "Changes to prevent over aggressive optimization by the JIT which was producing\nincorrect benchmarking results.", "file_num_lines": 364, "diff_parsed": {"added": [[35, "    private static String DATABASE;"], [50, "        DATABASE= args[0];"], [53, "        if (DATABASE.equals(\"hikari\"))"], [58, "        else if (DATABASE.equals(\"bone\"))"], [63, "        else if (DATABASE.equals(\"dbpool\"))"], [68, "        else if (DATABASE.equals(\"c3p0\"))"], [73, "        else if (DATABASE.equals(\"tomcat\"))"], [80, "            System.err.println(\"Start with one of: hikari, bone, dbpool, c3p0, tomcat\");"], [86, "        benchmarks.startMixedBench(10, 6000);"], [87, "        benchmarks.startMixedBench(10, 6000);"], [152, "        long counter = 0;"], [162, "            counter += runner.getCounter();"], [167, "        System.out.printf(\" %s max=%d%5$s, avg=%d%5$s, med=%d%5$s\\n\", (Boolean.getBoolean(\"showCounter\") ? \"Counter=\" + counter : \"\"), max, avg, med, timeUnit);"], [238, "            cpds.setInitialPoolSize(POOL_MAX / 2);"], [262, "        p.setMinIdle(POOL_MAX / 2);"], [269, "        p.setJdbcInterceptors(\"StatementFinalizer\");"], [280, "        private volatile long start;"], [281, "        private volatile long finish;"], [282, "        private volatile int counter;"], [298, "                int localCounter = 0;"], [304, "                        Connection connection = ds.getConnection();"], [314, ""], [315, "                        localCounter += statement.unwrap(StubPreparedStatement.class).getCount();"], [322, "                            localCounter += resultSet.getInt(1); // ensures the JIT doesn't optimize this loop away"], [324, ""], [325, "                        connection.close();"], [328, ""], [329, "                counter = localCounter;"]], "deleted": [[51, "        if (args[0].equals(\"hikari\"))"], [56, "        else if (args[0].equals(\"bone\"))"], [61, "        else if (args[0].equals(\"dbpool\"))"], [66, "        else if (args[0].equals(\"c3p0\"))"], [71, "        else if (args[0].equals(\"tomcat\"))"], [78, "            System.err.println(\"Start with one of: hikari, bone\");"], [84, "        benchmarks.startMixedBench(100, 10000);"], [85, "        benchmarks.startMixedBench(100, 10000);"], [163, "        System.out.printf(\"  max=%d%4$s, avg=%d%4$s, med=%d%4$s\\n\", max, avg, med, timeUnit);"], [257, "        p.setMinIdle(0);"], [274, "        private long start;"], [275, "        private long finish;"], [276, "        private int counter;"], [295, "                    Connection connection = ds.getConnection();"], [307, "                        statement.close();"], [314, "                            counter += resultSet.getInt(1); // ensures the JIT doesn't optimize this loop away"], [316, "                        resultSet.close();"], [317, "                        statement.close();"], [319, "                    connection.close();"]]}, "num_lines_added": 28, "num_lines_removed": 19}