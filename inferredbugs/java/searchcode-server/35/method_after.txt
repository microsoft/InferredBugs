    public SourceCodeDTO saveCode(CodeIndexDocument codeIndexDocument) {
        Optional<SourceCodeDTO> existing = this.getByCodeIndexDocument(codeIndexDocument);
        ConnStmtRs connStmtRs = new ConnStmtRs();

        try {
            connStmtRs.conn = this.dbConfig.getConnection();

            // If the language does not exist then create it
            Optional<LanguageTypeDTO> languageType = this.languageType.createLanguageType(codeIndexDocument.getLanguageName());

            String query = "INSERT INTO `sourcecode` (`id`, `repoid`, `languageid`, `sourceid`, `ownerid`, `licenseid`, `location`, `filename`, `content`, `hash`, `simhash`, `linescount`, `data`) VALUES " +
                    "(NULL, ?, ?, ?, ?, ?, ?, ?, COMPRESS(?), ?, ?, ?, ?)";

            // Why is this here and not above??
            if (existing.isPresent()) {
                return existing.get();
            }

            connStmtRs.stmt = connStmtRs.conn.prepareStatement(query, Statement.RETURN_GENERATED_KEYS);
            connStmtRs.stmt.setInt(1, 31337);
            connStmtRs.stmt.setInt(2, languageType.get().getId());
            connStmtRs.stmt.setInt(3, 31337);
            connStmtRs.stmt.setInt(4, 31337);
            connStmtRs.stmt.setInt(5, 31337);
            connStmtRs.stmt.setString(6, this.getLocation(codeIndexDocument));
            connStmtRs.stmt.setString(7, codeIndexDocument.getFileName());
            connStmtRs.stmt.setString(8, codeIndexDocument.getContents());
            connStmtRs.stmt.setString(9, codeIndexDocument.getHash());
            connStmtRs.stmt.setString(10, "simhash");
            connStmtRs.stmt.setInt(11, codeIndexDocument.getLines());
            connStmtRs.stmt.setString(12, "{}");

            connStmtRs.stmt.execute();
            ResultSet tableKeys = connStmtRs.stmt.getGeneratedKeys();
            tableKeys.next();
            int autoGeneratedID = tableKeys.getInt(1);
            return this.getById(autoGeneratedID).get();
        } catch (SQLException ex) {
            this.logger.severe(String.format("4a1aa86d::error in class %s exception %s searchcode save code with name %s", ex.getClass(), ex.getMessage(), codeIndexDocument.getFileName()));
        } finally {
            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());
        }

        return null;
    }