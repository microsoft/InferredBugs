{"hash": "4a7c3ac6ad8e160304a9cb6efa14727b9832544b", "message": "Clean up closing", "file_num_lines": 235, "diff_parsed": {"added": [[7, "import com.searchcode.app.dto.ConnStmtRs;"], [42, "        ConnStmtRs connStmtRs = new ConnStmtRs();"], [45, "            connStmtRs.conn = this.dbConfig.getConnection();"], [46, "            connStmtRs.stmt = connStmtRs.conn.prepareStatement(\"select id from code order by id desc limit 1;\");"], [47, "            connStmtRs.rs = connStmtRs.stmt.executeQuery();"], [49, "            while (connStmtRs.rs.next()) {"], [50, "                maxId = connStmtRs.rs.getInt(1);"], [55, "            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());"], [63, "        ConnStmtRs connStmtRs = new ConnStmtRs();"], [72, "            connStmtRs.conn = this.dbConfig.getConnection();"], [73, "            connStmtRs.stmt = connStmtRs.conn.prepareStatement(\"select c.id,c.filename,c.location,\" +"], [88, "            connStmtRs.rs = connStmtRs.stmt.executeQuery();"], [112, "            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());"], [120, "        ConnStmtRs connStmtRs = new ConnStmtRs();"], [123, "            connStmtRs.conn = this.dbConfig.getConnection();"], [124, "            connStmtRs.stmt = connStmtRs.conn.prepareStatement(\"SELECT c.id, c.repoid, c.filetypeid, c.languagename, r.sourceid, \" +"], [132, "            connStmtRs.stmt.setInt(1, start);"], [133, "            connStmtRs.stmt.setInt(2, end);"], [135, "            connStmtRs.rs = connStmtRs.stmt.executeQuery();"], [137, "            while (connStmtRs.rs.next()) {"], [139, "                        connStmtRs.rs.getInt(\"id\"),"], [140, "                        connStmtRs.rs.getInt(\"repoid\"),"], [141, "                        connStmtRs.rs.getInt(\"filetypeid\"),"], [142, "                        connStmtRs.rs.getInt(\"languagename\"),"], [143, "                        connStmtRs.rs.getInt(\"sourceid\"),"], [144, "                        connStmtRs.rs.getString(\"content\"),"], [145, "                        connStmtRs.rs.getString(\"filename\"),"], [146, "                        connStmtRs.rs.getInt(\"linescount\")"], [152, "            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());"], [160, "        ConnStmtRs connStmtRs = new ConnStmtRs();"], [163, "            connStmtRs.conn = this.dbConfig.getConnection();"], [171, "            connStmtRs.stmt = connStmtRs.conn.prepareStatement(query, Statement.RETURN_GENERATED_KEYS);"], [172, "            connStmtRs.stmt.setString(1, this.getLocation(codeIndexDocument));"], [173, "            connStmtRs.stmt.setString(2, codeIndexDocument.getFileName());"], [175, "            connStmtRs.rs = connStmtRs.stmt.executeQuery();"], [176, "            while (connStmtRs.rs.next()) {"], [178, "                        connStmtRs.rs.getInt(\"id\"),"], [179, "                        connStmtRs.rs.getInt(\"repoid\"),"], [180, "                        connStmtRs.rs.getInt(\"languageid\"),"], [181, "                        connStmtRs.rs.getString(\"languagename\"),"], [182, "                        connStmtRs.rs.getInt(\"sourceid\"),"], [183, "                        connStmtRs.rs.getInt(\"ownerid\"),"], [184, "                        connStmtRs.rs.getInt(\"licenseid\"),"], [185, "                        connStmtRs.rs.getString(\"location\"),"], [186, "                        connStmtRs.rs.getString(\"filename\"),"], [187, "                        connStmtRs.rs.getString(\"content\"),"], [188, "                        connStmtRs.rs.getString(\"hash\"),"], [189, "                        connStmtRs.rs.getString(\"simhash\"),"], [190, "                        connStmtRs.rs.getInt(\"linescount\"),"], [191, "                        connStmtRs.rs.getString(\"data\")"], [198, "            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());"], [206, "        ConnStmtRs connStmtRs = new ConnStmtRs();"], [209, "            connStmtRs.conn = this.dbConfig.getConnection();"], [216, "            connStmtRs.stmt = connStmtRs.conn.prepareStatement(query);"], [217, "            connStmtRs.stmt.setInt(1, id);"], [219, "            connStmtRs.rs = connStmtRs.stmt.executeQuery();"], [220, "            while (connStmtRs.rs.next()) {"], [222, "                        connStmtRs.rs.getInt(\"id\"),"], [223, "                        connStmtRs.rs.getInt(\"repoid\"),"], [224, "                        connStmtRs.rs.getInt(\"languageid\"),"], [225, "                        connStmtRs.rs.getString(\"languagename\"),"], [226, "                        connStmtRs.rs.getInt(\"sourceid\"),"], [227, "                        connStmtRs.rs.getInt(\"ownerid\"),"], [228, "                        connStmtRs.rs.getInt(\"licenseid\"),"], [229, "                        connStmtRs.rs.getString(\"location\"),"], [230, "                        connStmtRs.rs.getString(\"filename\"),"], [231, "                        connStmtRs.rs.getString(\"content\"),"], [232, "                        connStmtRs.rs.getString(\"hash\"),"], [233, "                        connStmtRs.rs.getString(\"simhash\"),"], [234, "                        connStmtRs.rs.getInt(\"linescount\"),"], [235, "                        connStmtRs.rs.getString(\"data\")"], [242, "            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());"], [250, "        ConnStmtRs connStmtRs = new ConnStmtRs();"], [253, "            connStmtRs.conn = this.dbConfig.getConnection();"], [266, "            connStmtRs.stmt = connStmtRs.conn.prepareStatement(query, Statement.RETURN_GENERATED_KEYS);"], [267, "            connStmtRs.stmt.setInt(1, 31337);"], [268, "            connStmtRs.stmt.setInt(2, languageType.get().getId());"], [269, "            connStmtRs.stmt.setInt(3, 31337);"], [270, "            connStmtRs.stmt.setInt(4, 31337);"], [271, "            connStmtRs.stmt.setInt(5, 31337);"], [272, "            connStmtRs.stmt.setString(6, this.getLocation(codeIndexDocument));"], [273, "            connStmtRs.stmt.setString(7, codeIndexDocument.getFileName());"], [274, "            connStmtRs.stmt.setString(8, codeIndexDocument.getContents());"], [275, "            connStmtRs.stmt.setString(9, codeIndexDocument.getHash());"], [276, "            connStmtRs.stmt.setString(10, \"simhash\");"], [277, "            connStmtRs.stmt.setInt(11, codeIndexDocument.getLines());"], [278, "            connStmtRs.stmt.setString(12, \"{}\");"], [279, ""], [280, "            connStmtRs.stmt.execute();"], [281, "            ResultSet tableKeys = connStmtRs.stmt.getGeneratedKeys();"], [288, "            this.helpers.closeQuietly(connStmtRs, this.dbConfig.closeConnection());"]], "deleted": [[41, ""], [42, "        Connection conn = null;"], [43, "        PreparedStatement stmt = null;"], [44, "        ResultSet rs = null;"], [47, "            conn = this.dbConfig.getConnection();"], [48, "            stmt = conn.prepareStatement(\"select id from code order by id desc limit 1;\");"], [49, "            rs = stmt.executeQuery();"], [51, "            while (rs.next()) {"], [52, "                maxId = rs.getInt(1);"], [57, "            this.helpers.closeQuietly(rs);"], [58, "            this.helpers.closeQuietly(stmt);"], [59, "            this.helpers.closeQuietly(conn);"], [67, ""], [68, "        Connection conn = null;"], [69, "        PreparedStatement stmt = null;"], [70, "        ResultSet rs = null;"], [79, "            conn = this.dbConfig.getConnection();"], [80, "            stmt = conn.prepareStatement(\"select c.id,c.filename,c.location,\" +"], [95, "            rs = stmt.executeQuery();"], [119, "            this.helpers.closeQuietly(rs);"], [120, "            this.helpers.closeQuietly(stmt);"], [121, "            this.helpers.closeQuietly(conn);"], [128, ""], [130, ""], [131, "        Connection conn = null;"], [132, "        PreparedStatement stmt = null;"], [133, "        ResultSet rs = null;"], [136, "            conn = this.dbConfig.getConnection();"], [137, "            stmt = conn.prepareStatement(\"SELECT c.id, c.repoid, c.filetypeid, c.languagename, r.sourceid, \" +"], [145, "            stmt.setInt(1, start);"], [146, "            stmt.setInt(2, end);"], [148, "            rs = stmt.executeQuery();"], [150, "            while (rs.next()) {"], [152, "                        rs.getInt(\"id\"),"], [153, "                        rs.getInt(\"repoid\"),"], [154, "                        rs.getInt(\"filetypeid\"),"], [155, "                        rs.getInt(\"languagename\"),"], [156, "                        rs.getInt(\"sourceid\"),"], [157, "                        rs.getString(\"content\"),"], [158, "                        rs.getString(\"filename\"),"], [159, "                        rs.getInt(\"linescount\")"], [165, "            this.helpers.closeQuietly(rs);"], [166, "            this.helpers.closeQuietly(stmt);"], [167, "            this.helpers.closeQuietly(conn);"], [175, ""], [176, "        Connection conn = null;"], [177, "        PreparedStatement stmt = null;"], [178, "        ResultSet resultSet = null;"], [181, "            conn = this.dbConfig.getConnection();"], [189, "            stmt = conn.prepareStatement(query, Statement.RETURN_GENERATED_KEYS);"], [190, "            stmt.setString(1, this.getLocation(codeIndexDocument));"], [191, "            stmt.setString(2, codeIndexDocument.getFileName());"], [193, "            resultSet = stmt.executeQuery();"], [194, "            while (resultSet.next()) {"], [196, "                        resultSet.getInt(\"id\"),"], [197, "                        resultSet.getInt(\"repoid\"),"], [198, "                        resultSet.getInt(\"languageid\"),"], [199, "                        resultSet.getString(\"languagename\"),"], [200, "                        resultSet.getInt(\"sourceid\"),"], [201, "                        resultSet.getInt(\"ownerid\"),"], [202, "                        resultSet.getInt(\"licenseid\"),"], [203, "                        resultSet.getString(\"location\"),"], [204, "                        resultSet.getString(\"filename\"),"], [205, "                        resultSet.getString(\"content\"),"], [206, "                        resultSet.getString(\"hash\"),"], [207, "                        resultSet.getString(\"simhash\"),"], [208, "                        resultSet.getInt(\"linescount\"),"], [209, "                        resultSet.getString(\"data\")"], [216, "            this.helpers.closeQuietly(resultSet);"], [217, "            this.helpers.closeQuietly(stmt);"], [218, "            this.helpers.closeQuietly(conn);"], [226, ""], [227, "        Connection conn = null;"], [228, "        PreparedStatement stmt = null;"], [229, "        ResultSet resultSet = null;"], [232, "            conn = this.dbConfig.getConnection();"], [239, "            stmt = conn.prepareStatement(query);"], [240, "            stmt.setInt(1, id);"], [242, "            resultSet = stmt.executeQuery();"], [243, "            while (resultSet.next()) {"], [245, "                        resultSet.getInt(\"id\"),"], [246, "                        resultSet.getInt(\"repoid\"),"], [247, "                        resultSet.getInt(\"languageid\"),"], [248, "                        resultSet.getString(\"languagename\"),"], [249, "                        resultSet.getInt(\"sourceid\"),"], [250, "                        resultSet.getInt(\"ownerid\"),"], [251, "                        resultSet.getInt(\"licenseid\"),"], [252, "                        resultSet.getString(\"location\"),"], [253, "                        resultSet.getString(\"filename\"),"], [254, "                        resultSet.getString(\"content\"),"], [255, "                        resultSet.getString(\"hash\"),"], [256, "                        resultSet.getString(\"simhash\"),"], [257, "                        resultSet.getInt(\"linescount\"),"], [258, "                        resultSet.getString(\"data\")"], [265, "            this.helpers.closeQuietly(resultSet);"], [266, "            this.helpers.closeQuietly(stmt);"], [267, "            this.helpers.closeQuietly(conn);"], [274, ""], [276, ""], [277, "        Connection conn = null;"], [278, "        PreparedStatement stmt = null;"], [281, "            conn = this.dbConfig.getConnection();"], [294, "            stmt = conn.prepareStatement(query, Statement.RETURN_GENERATED_KEYS);"], [295, "            stmt.setInt(1, 31337);"], [296, "            stmt.setInt(2, languageType.get().getId());"], [297, "            stmt.setInt(3, 31337);"], [298, "            stmt.setInt(4, 31337);"], [299, "            stmt.setInt(5, 31337);"], [300, "            stmt.setString(6, this.getLocation(codeIndexDocument));"], [301, "            stmt.setString(7, codeIndexDocument.getFileName());"], [302, "            stmt.setString(8, codeIndexDocument.getContents());"], [303, "            stmt.setString(9, codeIndexDocument.getHash());"], [304, "            stmt.setString(10, \"simhash\");"], [305, "            stmt.setInt(11, codeIndexDocument.getLines());"], [306, "            stmt.setString(12, \"{}\");"], [307, ""], [308, "            stmt.execute();"], [309, "            ResultSet tableKeys = stmt.getGeneratedKeys();"], [316, "            this.helpers.closeQuietly(stmt);"], [317, "            // this.helpers.closeQuietly(conn);"]]}, "num_lines_added": 91, "num_lines_removed": 120}