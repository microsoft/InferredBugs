{"hash": "4428b11b66272c3c888fd86c6a94a562b449c5ba", "message": "Adding convinence signature to hbase_put so it accepts map of key values.", "file_num_lines": 96, "diff_parsed": {"added": [[27, "import java.io.IOException;"], [28, "import java.util.*;"], [29, "import java.util.Map.Entry;"], [30, ""], [37, "    value = \"string _FUNC_(config, map<string, string> key_value) - \\n\" +"], [38, "        \"string _FUNC_(config, key, value) - Do a HBase Put on a table. \" +"], [39, "        \" Config must contain zookeeper \\n\" +"], [60, "    checkConfig(configIn);"], [75, "  public String evaluate(Map<String, String> configIn, Map<String, String> keyValueMap) {"], [76, "    checkConfig(configIn);"], [77, ""], [78, "    try {"], [79, "      List<Put> putList = new ArrayList<Put>();"], [80, "      for (Map.Entry<String, String> keyValue : keyValueMap.entrySet()) {"], [81, "        Put thePut = new Put(keyValue.getKey().getBytes());"], [82, "        thePut.add(configIn.get(FAMILY_TAG).getBytes(),"], [83, "                   configIn.get(QUALIFIER_TAG).getBytes(),"], [84, "                   keyValue.getValue().getBytes());"], [85, "        putList.add(thePut);"], [86, "      }"], [87, ""], [88, "      HTable table = getHTable(configIn.get(TABLE_NAME_TAG), configIn.get(ZOOKEEPER_QUORUM_TAG));"], [89, "      table.put(putList);"], [90, "      return \"Put \" + keyValueMap.toString();"], [91, "    } catch(Exception exc) {"], [92, "      LOG.error(\"Error while doing HBase Puts\");"], [93, "      throw new RuntimeException(exc);"], [94, "    }"], [95, "  }"], [96, ""], [119, ""], [120, "  /**"], [121, "   * Throws RuntimeException if config is incomplete."], [122, "   * @param configIn"], [123, "   */"], [124, "  private void checkConfig(Map<String, String> configIn) {"], [125, "    if (!configIn.containsKey(FAMILY_TAG) ||"], [126, "        !configIn.containsKey(QUALIFIER_TAG) ||"], [127, "        !configIn.containsKey(TABLE_NAME_TAG) ||"], [128, "        !configIn.containsKey(ZOOKEEPER_QUORUM_TAG)) {"], [129, "      String errorMsg = \"Error while doing HBase Puts. Config is missing for: \" + FAMILY_TAG + \" or \" +"], [130, "          QUALIFIER_TAG + \" or \" + TABLE_NAME_TAG + \" or \" + ZOOKEEPER_QUORUM_TAG;"], [131, "      LOG.error(errorMsg);"], [132, "      throw new RuntimeException(errorMsg);"], [133, "    }"], [134, "  }"]], "deleted": [[19, "import java.io.IOException;"], [20, "import java.util.HashMap;"], [21, "import java.util.Iterator;"], [22, "import java.util.Map;"], [23, "import java.util.Map.Entry;"], [24, ""], [39, "    value = \"string _FUNC_(config, key, value) - Do a single HBase Put on a table.  Config must contain zookeeper \\n\" +"], [60, "    if (!configIn.containsKey(FAMILY_TAG) ||"], [61, "        !configIn.containsKey(QUALIFIER_TAG) ||"], [62, "        !configIn.containsKey(TABLE_NAME_TAG) ||"], [63, "        !configIn.containsKey(ZOOKEEPER_QUORUM_TAG)) {"], [64, "      String errorMsg = \"Error while doing HBase Puts. Config is missing for: \" + FAMILY_TAG + \" or \" +"], [65, "      QUALIFIER_TAG + \" or \" + TABLE_NAME_TAG + \" or \" + ZOOKEEPER_QUORUM_TAG;"], [66, "      LOG.error(errorMsg);"], [67, "      throw new RuntimeException(errorMsg);"], [68, "    }"]]}, "num_lines_added": 46, "num_lines_removed": 16}