{"hash": "46419929ca485d7f0bc1fce90dddfb3fcbe73832", "message": "TempJobs unit tests no longer use actual env vars\n\nPreviously having certain env vars set (e.g. HELIOS_HOST_FITLER) would cause\nthe tests to fail. The tests now inject the environment variables they want\nused during the test so the tests aren't affected by the environment.", "file_num_lines": 485, "diff_parsed": {"added": [[75, "import static java.lang.System.getProperty;"], [84, "  private static final String DEFAULT_USER = getProperty(\"user.name\");"], [95, "  private final Map<String, String> env;"], [111, "    this.env = checkNotNull(builder.env, \"env\");"], [180, "                                                                prober, env);"], [436, "    return builder((String) null);"], [440, "    return builder(profile, System.getenv());"], [443, "  static Builder builder(final Map<String, String> env) {"], [444, "    return builder(null, env);"], [445, "  }"], [447, "  static Builder builder(final String profile, final Map<String, String> env) {"], [448, "    return new Builder(profile, TemporaryJobs.loadConfig(), env);"], [449, "  }"], [451, "  public static class Builder {"], [453, "    Builder(String profile, Config rootConfig, Map<String, String> env) {"], [454, "      this.env = env;"], [456, "      // No profile specified so see if there is one specified in the config object."], [457, "      if (profile == null) {"], [458, "        profile = TemporaryJobs.getProfileFromConfig(rootConfig);"], [459, "      }"], [460, ""], [461, "      // If profile is null, use empty config, otherwise load config for this profile. Note,"], [462, "      // the config for each profile is a subnode in the rootConfig object."], [463, "      if (profile == null) {"], [464, "        this.config = ConfigFactory.empty();"], [465, "      } else {"], [467, "        if (rootConfig.hasPath(key)) {"], [468, "          this.config = rootConfig.getConfig(key);"], [473, ""], [474, "      log.info(\"Using profile: \" + profile);"], [475, ""], [501, "      final String heliosHostFilter = env.get(\"HELIOS_HOST_FILTER\");"], [507, "      final String domain = env.get(\"HELIOS_DOMAIN\");"], [514, "      final String endpoints = env.get(\"HELIOS_ENDPOINTS\");"], [530, "      final String dockerHost = env.get(\"DOCKER_HOST\");"], [585, "    private final Map<String, String> env;"], [590, "    private String hostFilter;"]], "deleted": [[83, "  private static final String DEFAULT_USER = System.getProperty(\"user.name\");"], [177, "                                                                prober);"], [433, "    return new Builder();"], [437, "    return new Builder(profile);"], [440, "  public static class Builder {"], [442, "    Builder(final String profile) {"], [443, "      this(profile, TemporaryJobs.loadConfig());"], [444, "    }"], [446, "    Builder() {"], [447, "      this(TemporaryJobs.loadConfig());"], [448, "    }"], [450, "    // I feel like I'm building the y-combinator here because Java insists on the calls to this()"], [451, "    // in a constructor being the first thing in the method."], [452, "    private Builder(final Config preConfig) {"], [453, "      this(TemporaryJobs.getProfileFromConfig(preConfig), preConfig);"], [454, "    }"], [456, "    private Builder(final String profile, final Config preConfig) {"], [457, "      log.info(\"Using profile: \" + profile);"], [458, "      if (profile != null) {"], [460, "        if (preConfig.hasPath(key)) {"], [461, "          this.config = preConfig.getConfig(key);"], [465, "      } else {"], [466, "        this.config = ConfigFactory.empty();"], [493, "      final String heliosHostFilter = System.getenv(\"HELIOS_HOST_FILTER\");"], [499, "      final String domain = System.getenv(\"HELIOS_DOMAIN\");"], [506, "      final String endpoints = System.getenv(\"HELIOS_ENDPOINTS\");"], [522, "      final String dockerHost = System.getenv(\"DOCKER_HOST\");"], [581, "    private String hostFilter = System.getenv(\"HELIOS_HOST_FILTER\");"]]}, "num_lines_added": 37, "num_lines_removed": 28}