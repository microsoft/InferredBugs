{"hash": "2fde18225fcd910661948a486bd6c644b8668f24", "message": "fix/state listener (#285)\n\n* (feat) code format\r\n\r\n* (feat) #284\r\n\r\n* (feat) #284", "file_num_lines": 1418, "diff_parsed": {"added": [[37, "import com.alipay.sofa.jraft.rhea.StateListenerContainer;"], [188, "    private static final Logger                LOG                    = LoggerFactory"], [189, "                                                                          .getLogger(DefaultRheaKVStore.class);"], [195, "    private final StateListenerContainer<Long> stateListenerContainer = new StateListenerContainer<>();"], [196, "    private StoreEngine                        storeEngine;"], [197, "    private PlacementDriverClient              pdClient;"], [198, "    private RheaKVRpcService                   rheaKVRpcService;"], [199, "    private RheaKVStoreOptions                 opts;"], [200, "    private int                                failoverRetries;"], [201, "    private long                               futureTimeoutMillis;"], [202, "    private boolean                            onlyLeaderRead;"], [203, "    private Dispatcher                         kvDispatcher;"], [204, "    private BatchingOptions                    batchingOpts;"], [205, "    private GetBatching                        getBatching;"], [206, "    private GetBatching                        getBatchingOnlySafe;"], [207, "    private PutBatching                        putBatching;"], [209, "    private volatile boolean                   started;"], [240, "            this.storeEngine = new StoreEngine(this.pdClient, this.stateListenerContainer);"], [315, "        this.stateListenerContainer.clear();"], [1415, "        this.stateListenerContainer.addStateListener(regionId, listener);"]], "deleted": [[187, "    private static final Logger   LOG = LoggerFactory.getLogger(DefaultRheaKVStore.class);"], [193, "    private StoreEngine           storeEngine;"], [194, "    private PlacementDriverClient pdClient;"], [195, "    private RheaKVRpcService      rheaKVRpcService;"], [196, "    private RheaKVStoreOptions    opts;"], [197, "    private int                   failoverRetries;"], [198, "    private long                  futureTimeoutMillis;"], [199, "    private boolean               onlyLeaderRead;"], [200, "    private Dispatcher            kvDispatcher;"], [201, "    private BatchingOptions       batchingOpts;"], [202, "    private GetBatching           getBatching;"], [203, "    private GetBatching           getBatchingOnlySafe;"], [204, "    private PutBatching           putBatching;"], [206, "    private volatile boolean      started;"], [237, "            this.storeEngine = new StoreEngine(this.pdClient);"], [1411, "        checkState();"], [1412, "        if (this.storeEngine == null) {"], [1413, "            throw new IllegalStateException(\"current node do not have store engine\");"], [1414, "        }"], [1415, "        final RegionEngine regionEngine = this.storeEngine.getRegionEngine(regionId);"], [1416, "        if (regionEngine == null) {"], [1417, "            throw new IllegalStateException(\"current node do not have this region engine[\" + regionId + \"]\");"], [1418, "        }"], [1419, "        regionEngine.getFsm().addStateListener(listener);"]]}, "num_lines_added": 20, "num_lines_removed": 24}