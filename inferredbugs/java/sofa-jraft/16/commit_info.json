{"hash": "d6ac5c284d8029fa400805135e3ab013eb94ff5a", "message": "(feat) refactor ThreadId and replicator (#169)\n\n* (feat) refactor ThreadId and replicator\r\n\r\n* (feat) Adds javadoc", "file_num_lines": 1296, "diff_parsed": {"added": [[177, "            gauges.put(\"log-lags\","], [178, "                (Gauge<Long>) () -> this.opts.getLogManager().getLastLogIndex() - (this.r.nextIndex - 1));"], [471, "                releaseReader();"], [483, "                releaseReader();"], [530, "        r.releaseReader();"], [728, "    public static void waitForCaughtUp(final ThreadId id, final long maxMargin, final long dueTime,"], [729, "                                       final CatchUpClosure done) {"], [842, "            try {"], [843, "                for (final Inflight inflight : r.inflights) {"], [844, "                    if (inflight != r.rpcInFly) {"], [845, "                        inflight.rpcFuture.cancel(true);"], [846, "                    }"], [848, "                if (r.rpcInFly != null) {"], [849, "                    r.rpcInFly.rpcFuture.cancel(true);"], [850, "                    r.rpcInFly = null;"], [851, "                }"], [852, "                if (r.heartbeatInFly != null) {"], [853, "                    r.heartbeatInFly.cancel(true);"], [854, "                    r.heartbeatInFly = null;"], [855, "                }"], [856, "                if (r.timeoutNowInFly != null) {"], [857, "                    r.timeoutNowInFly.cancel(true);"], [858, "                    r.timeoutNowInFly = null;"], [859, "                }"], [860, "                if (r.heartbeatTimer != null) {"], [861, "                    r.heartbeatTimer.cancel(true);"], [862, "                    r.heartbeatTimer = null;"], [863, "                }"], [864, "                if (r.blockTimer != null) {"], [865, "                    r.blockTimer.cancel(true);"], [866, "                    r.blockTimer = null;"], [867, "                }"], [868, "                if (r.waitId >= 0) {"], [869, "                    r.options.getLogManager().removeWaiter(r.waitId);"], [870, "                }"], [871, "                r.notifyOnCaughtUp(errorCode, true);"], [872, "            } finally {"], [873, "                r.destroy();"], [943, "        releaseReader();"], [952, "    private void releaseReader() {"], [953, "        if (this.reader != null) {"], [954, "            Utils.closeQuietly(this.reader);"], [955, "            this.reader = null;"], [956, "        }"], [957, "    }"], [958, ""], [1144, "        releaseReader();"]], "deleted": [[177, "            gauges.put(\"log-lags\", (Gauge<Long>) () -> this.opts.getLogManager().getLastLogIndex() - (this.r.nextIndex - 1));"], [527, "        if (r.reader != null) {"], [528, "            Utils.closeQuietly(r.reader);"], [529, "            r.reader = null;"], [530, "        }"], [728, "    public static void waitForCaughtUp(final ThreadId id, final long maxMargin, final long dueTime, final CatchUpClosure done) {"], [841, "            for (final Inflight inflight : r.inflights) {"], [842, "                if (inflight != r.rpcInFly) {"], [843, "                    inflight.rpcFuture.cancel(true);"], [846, "            if (r.rpcInFly != null) {"], [847, "                r.rpcInFly.rpcFuture.cancel(true);"], [848, "                r.rpcInFly = null;"], [849, "            }"], [850, "            if (r.heartbeatInFly != null) {"], [851, "                r.heartbeatInFly.cancel(true);"], [852, "                r.heartbeatInFly = null;"], [853, "            }"], [854, "            if (r.timeoutNowInFly != null) {"], [855, "                r.timeoutNowInFly.cancel(true);"], [856, "                r.timeoutNowInFly = null;"], [857, "            }"], [858, "            if (r.heartbeatTimer != null) {"], [859, "                r.heartbeatTimer.cancel(true);"], [860, "                r.heartbeatTimer = null;"], [861, "            }"], [862, "            if (r.waitId >= 0) {"], [863, "                r.options.getLogManager().removeWaiter(r.waitId);"], [864, "            }"], [865, "            r.notifyOnCaughtUp(errorCode, true);"], [866, "            r.destroy();"], [935, "        if (this.reader != null) {"], [936, "            Utils.closeQuietly(this.reader);"], [937, "            this.reader = null;"], [938, "        }"], [1132, "        if (this.reader != null) {"], [1133, "            Utils.closeQuietly(this.reader);"], [1134, "            this.reader = null;"], [1135, "        }"]]}, "num_lines_added": 47, "num_lines_removed": 38}