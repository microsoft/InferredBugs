{"hash": "323811adb2c069b6bf44ea78952f632d94e47b01", "message": "Added outbound event queue to be handled by Notifier stage", "file_num_lines": 196, "diff_parsed": {"added": [[66, "                    break;"], [155, "        LOG.debug(\"handleSubscribe, registering the subscriptions\");"], [194, "//        m_clientIDsLock.lock();"], [195, "//        try {"], [196, "//            m_clientIDs.remove(clientID);"], [197, "//        } finally {"], [198, "//            m_clientIDsLock.unlock();"], [199, "//        }"], [207, "        //session.close(true);"], [208, "        m_messaging.disconnect(session);"], [230, ""], [231, "        LOG.debug(\"notify invoked\");"], [232, "        m_clientIDsLock.lock();"], [233, "        try {"], [234, "            assert m_clientIDs != null;"], [235, "            LOG.debug(\"clientIDs are \" + m_clientIDs);"], [236, "            assert m_clientIDs.get(clientId) != null;"], [237, "            LOG.debug(\"Session for clientId \" + clientId + \" is \" + m_clientIDs.get(clientId).getSession());"], [238, "            m_clientIDs.get(clientId).getSession().write(pubMessage);"], [239, "        }catch(Throwable t) {"], [240, "            LOG.error(null, t);"], [241, "        } finally {"], [242, "            m_clientIDsLock.unlock();"], [243, "        }"], [244, "    }"], [245, ""], [246, "    public void disconnect(IoSession session) {"], [247, "        String clientID = (String) session.getAttribute(ATTR_CLIENTID);"], [248, "        m_clientIDsLock.lock();"], [249, "        try {"], [250, "            m_clientIDs.remove(clientID);"], [251, "        } finally {"], [252, "            m_clientIDsLock.unlock();"], [253, "        }"], [254, "        session.close(true);"]], "deleted": [[66, ""], [155, "        LOG.info(\"registering the subscriptions\");"], [194, "        m_clientIDsLock.lock();"], [195, "        try {"], [196, "            m_clientIDs.remove(clientID);"], [197, "        } finally {"], [198, "            m_clientIDsLock.unlock();"], [199, "        }"], [207, "        session.close(true);"], [229, "        assert m_clientIDs != null;"], [230, "        assert m_clientIDs.get(clientId) != null;"], [231, "        LOG.debug(\"Session for clientId \" + clientId + \" is \" + m_clientIDs.get(clientId).getSession());"], [232, "        m_clientIDs.get(clientId).getSession().write(pubMessage);"]]}, "num_lines_added": 35, "num_lines_removed": 13}