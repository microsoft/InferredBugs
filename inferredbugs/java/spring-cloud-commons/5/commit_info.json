{"hash": "b6df5e24250594e7093267a41c3bd79797837f15", "message": "Add encrypt.salt configuration option", "file_num_lines": 59, "diff_parsed": {"added": [[18, "import java.io.IOException;"], [19, "import java.io.StringReader;"], [20, "import java.io.StringWriter;"], [21, ""], [28, ""], [39, "\tprivate String salt = \"deadbeef\";"], [40, ""], [41, "\tpublic EncryptorFactory() {"], [42, "\t}"], [43, ""], [44, "\tpublic EncryptorFactory(String salt) {"], [45, "\t\tthis.salt = salt;"], [46, "\t}"], [55, "\t\t\t\tencryptor = new RsaSecretEncryptor("], [56, "\t\t\t\t\t\tnormalizedPemData.replaceAll(\"\\\\n\", \"\").replaceAll(\"\\\\r\", \"\"));"], [67, "\t\t\tencryptor = Encryptors.text(data, salt);"], [75, "\t\ttry (PEMParser pemParser = new PEMParser(new StringReader(data))) {"], [80, "\t\t\ttry (PemWriter pemWriter = new PemWriter(textWriter)) {"], [81, "\t\t\t\tPemObjectGenerator pemObjectGenerator = new MiscPEMGenerator("], [82, "\t\t\t\t\t\tprivateKeyInfo);"], [84, "\t\t\t\tpemWriter.writeObject(pemObjectGenerator);"], [85, "\t\t\t\tpemWriter.flush();"], [86, "\t\t\t\treturn textWriter.toString();"], [87, "\t\t\t}"]], "deleted": [[28, "import java.io.IOException;"], [29, "import java.io.StringReader;"], [30, "import java.io.StringWriter;"], [31, ""], [38, "\t// TODO: expose as config property"], [39, "\tprivate static final String SALT = \"deadbeef\";"], [48, "\t\t\t\tencryptor = new RsaSecretEncryptor(normalizedPemData.replaceAll(\"\\\\n\", \"\").replaceAll(\"\\\\r\", \"\"));"], [59, "\t\t\tencryptor = Encryptors.text(data, SALT);"], [66, "\t\tPEMParser pemParser = new PEMParser(new StringReader(data));"], [68, "\t\ttry {"], [73, "\t\t\tPemWriter pemWriter = new PemWriter(textWriter);"], [74, "\t\t\tPemObjectGenerator pemObjectGenerator = new MiscPEMGenerator(privateKeyInfo);"], [76, "\t\t\tpemWriter.writeObject(pemObjectGenerator);"], [77, "\t\t\tpemWriter.flush();"], [78, "\t\t\treturn textWriter.toString();"], [86, ""], [87, ""]]}, "num_lines_added": 24, "num_lines_removed": 17}