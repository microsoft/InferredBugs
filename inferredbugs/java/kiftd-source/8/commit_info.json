{"hash": "675562ebe35c39587637017bffd6200e21527c15", "message": "update to v1.0.17 \u65b0\u589e\u4e86\u89c6\u9891\u8f6c\u7801\u6a21\u5757\u7684\u534a\u6210\u54c1\uff08\u6682\u4e0d\u53ef\u7528\uff09", "file_num_lines": 589, "diff_parsed": {"added": [[41, "\tprivate static Map<String,Integer> keyMap = new HashMap<>();// \u4e0a\u4f20\u94a5\u5319\u8868\uff0c\u7528\u4e8e\u8bb0\u5f55\u7528\u5b8c\u4e00\u6279\u5c31\u6254\u7684\u94a5\u5319"], [82, "\t\t// \u4e3a\u5ba2\u6237\u7aef\u5206\u53d1\u4e00\u628a\u94a5\u5319\uff0c\u8be5\u94a5\u5319\u53ef\u4f7f\u7528\u672c\u6b21\u58f0\u660e\u8981\u4e0a\u4f20\u7684\u6b21\u6570\uff0c\u4f46\u4e0d\u9650\u65f6\u957f\u3002"], [84, "\t\tsynchronized (keyMap) {"], [85, "\t\t\tkeyMap.put(key, namelistObj.size());"], [87, "\t\tCookie c = new Cookie(KIFTD_UPLOAD_KEY, key);"], [89, "\t\t// \u5982\u679c\u5b58\u5728\u540c\u540d\u6587\u4ef6\uff0c\u8fd4\u56de\u540c\u540d\u6587\u4ef6\u7684JSON\u6570\u636e\uff0c\u5426\u5219\u76f4\u63a5\u5141\u8bb8\u4e0a\u4f20"], [113, "\t\t\t\tsynchronized (keyMap) {"], [114, "\t\t\t\t\tInteger i=keyMap.get(c.getValue());"], [115, "\t\t\t\t\tif (i!=null) {// \u6bd4\u5bf9\u94a5\u5319\u6709\u6548\u6027"], [117, "\t\t\t\t\t\ti--;"], [118, "\t\t\t\t\t\tif(i<=0) {"], [119, "\t\t\t\t\t\t\tkeyMap.remove(c.getValue());// \u9500\u6bc1\u8fd9\u628a\u94a5\u5319"], [120, "\t\t\t\t\t\t\tc.setMaxAge(0);"], [121, "\t\t\t\t\t\t\tresponse.addCookie(c);"], [122, "\t\t\t\t\t\t}"]], "deleted": [[41, "\tprivate static List<String> keyList = new ArrayList<>();// \u4e0a\u4f20\u94a5\u5319\u8868\uff0c\u7528\u4e8e\u8bb0\u5f55\u7528\u5b8c\u4e00\u6b21\u5c31\u6254\u7684\u94a5\u5319"], [82, "\t\t// \u5982\u679c\u5b58\u5728\u540c\u540d\u6587\u4ef6\uff0c\u8fd4\u56de\u540c\u540d\u6587\u4ef6\u7684JSON\u6570\u636e\uff0c\u5426\u5219\u76f4\u63a5\u5141\u8bb8\u4e0a\u4f20"], [84, "\t\tsynchronized (keyList) {"], [85, "\t\t\tkeyList.add(key);"], [87, "\t\tCookie c = new Cookie(KIFTD_UPLOAD_KEY, key);// \u4e3a\u5ba2\u6237\u7aef\u5206\u53d1\u4e00\u628a\u94a5\u5319\uff0c\u8be5\u94a5\u5319\u4ec5\u6709\u6548\u4e00\u6b21\uff0c\u4f46\u4e0d\u9650\u65f6\u957f\u3002"], [112, "\t\t\t\tsynchronized (keyList) {"], [113, "\t\t\t\t\tif (keyList.contains(c.getValue())) {// \u6bd4\u5bf9\u94a5\u5319\u6709\u6548\u6027"], [115, "\t\t\t\t\t\tkeyList.remove(c.getValue());// \u9500\u6bc1\u8fd9\u628a\u94a5\u5319"], [116, "\t\t\t\t\t\t c.setMaxAge(0);"], [117, "\t\t\t\t\t\t response.addCookie(c);"]]}, "num_lines_added": 15, "num_lines_removed": 10}