{"hash": "dd8951849ae16b91368922572e5280c85ccfc7ad", "message": "update to v1.0.19 \u7528\u6237\u4e0a\u4f20\u6587\u4ef6\u4f53\u79ef\u9650\u5236\u529f\u80fd\u5b8c\u6210\uff0c\u7248\u672c\u8fdb\u5165\u6d4b\u8bd5\u9636\u6bb5", "file_num_lines": 640, "diff_parsed": {"added": [[65, "\t\tfinal String maxUploadFileSize = request.getParameter(\"maxSize\");"], [66, "\t\tfinal String maxUploadFileIndex = request.getParameter(\"maxFileIndex\");"], [74, "\t\t// \u51c6\u5907\u4e00\u4e2a\u68c0\u67e5\u7ed3\u679c\u5bf9\u8c61"], [75, "\t\tCheckUploadFilesRespons cufr = new CheckUploadFilesRespons();"], [76, "\t\t// \u5f00\u59cb\u6587\u4ef6\u4e0a\u4f20\u4f53\u79ef\u9650\u5236\u68c0\u67e5"], [77, "\t\ttry {"], [78, "\t\t\t// \u83b7\u53d6\u6700\u5927\u6587\u4ef6\u4f53\u79ef\uff08\u4ee5Byte\u4e3a\u5355\u4f4d\uff09"], [79, "\t\t\tlong mufs = Long.parseLong(maxUploadFileSize);"], [80, "\t\t\t// \u83b7\u53d6\u6700\u5927\u6587\u4ef6\u7684\u540d\u79f0"], [81, "\t\t\tString mfname = namelistObj.get(Integer.parseInt(maxUploadFileIndex));"], [82, "\t\t\tlong pMaxUploadSize = ConfigureReader.instance().getUploadFileSize(account);"], [83, "\t\t\tif (pMaxUploadSize >= 0) {"], [84, "\t\t\t\tif (mufs > pMaxUploadSize) {"], [85, "\t\t\t\t\tcufr.setCheckResult(\"fileTooLarge\");"], [86, "\t\t\t\t\tcufr.setMaxUploadFileSize(formatMaxUploadFileSize(pMaxUploadSize));"], [87, "\t\t\t\t\tcufr.setOverSizeFile(mfname);"], [88, "\t\t\t\t\treturn gson.toJson(cufr);"], [89, "\t\t\t\t}"], [90, "\t\t\t}"], [91, "\t\t} catch (Exception e) {"], [92, "\t\t\treturn ERROR_PARAMETER;"], [93, "\t\t}"], [94, "\t\t// \u5f00\u59cb\u6587\u4ef6\u547d\u540d\u51b2\u7a81\u68c0\u67e5"], [124, "\t// \u683c\u5f0f\u5316\u5b58\u50a8\u4f53\u79ef\uff0c\u4fbf\u4e8e\u8fd4\u56de\u4e0a\u4f20\u6587\u4ef6\u4f53\u79ef\u7684\u68c0\u67e5\u63d0\u793a\u4fe1\u606f"], [125, "\tprivate String formatMaxUploadFileSize(long size) {"], [126, "\t\tdouble result = (double) size;"], [127, "\t\tString unit = \"B\";"], [128, "\t\tif (size <= 0) {"], [129, "\t\t\treturn \"\u8bbe\u7f6e\u65e0\u6548\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\";"], [130, "\t\t}"], [131, "\t\tif (size >= 1024 && size < 1048576) {"], [132, "\t\t\tresult = (double) size / 1024;"], [133, "\t\t\tunit = \"KB\";"], [134, "\t\t} else if (size >= 1048576 && size < 1073741824) {"], [135, "\t\t\tresult = (double) size / 1048576;"], [136, "\t\t\tunit = \"MB\";"], [137, "\t\t} else if (size >= 1073741824) {"], [138, "\t\t\tresult = (double) size / 1073741824;"], [139, "\t\t\tunit = \"GB\";"], [140, "\t\t}"], [141, "\t\treturn String.format(\"%.1f\", result) + \" \" + unit;"], [142, "\t}"], [143, ""], [175, "\t\t// \u68c0\u67e5\u4e0a\u4f20\u6587\u4ef6\u4f53\u79ef\u662f\u5426\u8d85\u9650"], [176, "\t\tlong mufs = ConfigureReader.instance().getUploadFileSize(account);"], [177, "\t\tif (mufs >= 0 && file.getSize() > mufs) {"], [178, "\t\t\treturn UPLOADERROR;"], [179, "\t\t}"]], "deleted": [[89, "\t\t// \u88c5\u8ba2\u68c0\u67e5\u7ed3\u679c"], [90, "\t\tCheckUploadFilesRespons cufr = new CheckUploadFilesRespons();"]]}, "num_lines_added": 48, "num_lines_removed": 2}