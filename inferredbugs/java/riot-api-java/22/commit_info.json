{"hash": "5805286febea81ade447ae39aab93cd4bea54d36", "message": "Removed RequestResponse, added RequestState\n\nOriginally I had a different idea of what to do with RequestResponse,\nbut eventually I didn't really need it anymore. There is no use in\nkeeping that extra class.", "file_num_lines": 162, "diff_parsed": {"added": [[37, "\tpublic static final int CODE_SUCCESS_OK = 200;"], [38, "\tpublic static final int CODE_SUCCESS_NOCONTENT = 204;"], [39, "\tpublic static final int CODE_ERROR_BAD_REQUEST = 400;"], [40, "\tpublic static final int CODE_ERROR_UNAUTHORIZED = 401;"], [41, "\tpublic static final int CODE_ERROR_FORBIDDEN = 403;"], [42, "\tpublic static final int CODE_ERROR_NOT_FOUND = 404;"], [43, "\tpublic static final int CODE_ERROR_UNPROCESSABLE_ENTITY = 422;"], [44, "\tpublic static final int CODE_ERROR_RATE_LIMITED = 429;"], [45, "\tpublic static final int CODE_ERROR_SERVER_ERROR = 500;"], [46, "\tpublic static final int CODE_ERROR_SERVICE_UNAVAILABLE = 503;"], [47, ""], [48, "\tprivate RequestState state = RequestState.NotSent;"], [53, ""], [54, "\tprivate int responseCode = -1;"], [55, "\tprivate String responseBody = null;"], [87, "\t\trequireSucceededRequestState();"], [88, "\t\treturn responseCode;"], [92, "\t\trequireSucceededRequestState();"], [93, "\t\treturn responseBody;"], [97, "\t\tif (state != RequestState.NotSent) {"], [98, "\t\t\tthrow new IllegalStateException(\"The request has already been sent\");"], [99, "\t\t}"], [100, "\t\tstate = RequestState.Waiting;"], [122, "\t\t\tresponseCode = connection.getResponseCode();"], [123, "\t\t\tif (responseCode == CODE_ERROR_RATE_LIMITED) {"], [133, "\t\t\t} else if (responseCode < 200 || responseCode >= 300) {"], [134, "\t\t\t\tthrow new RiotApiException(responseCode);"], [138, "\t\t\tif (responseCode != CODE_SUCCESS_NOCONTENT) {"], [146, "\t\t\tresponseBody = responseBodyBuilder.toString();"], [147, "\t\t\tstate = RequestState.Succeeded;"], [149, "\t\t\tstate = RequestState.Failed;"], [160, "\t\trequireSucceededRequestState();"], [161, "\t\tif (responseCode == CODE_SUCCESS_NOCONTENT) {"], [167, "\t\t\tdto = new Gson().fromJson(responseBody, desiredDto);"], [178, "\t\trequireSucceededRequestState();"], [179, "\t\tif (responseCode == CODE_SUCCESS_NOCONTENT) {"], [185, "\t\t\tdto = new Gson().fromJson(responseBody, desiredDto);"], [194, ""], [195, "\tprivate void requireSucceededRequestState() {"], [196, "\t\tif (state == RequestState.NotSent) {"], [197, "\t\t\tthrow new IllegalStateException(\"The request has not yet been sent\");"], [198, "\t\t} else if (state == RequestState.Waiting) {"], [199, "\t\t\tthrow new IllegalStateException(\"The request has not received a response yet\");"], [200, "\t\t} else if (state == RequestState.Failed) {"], [201, "\t\t\tthrow new IllegalStateException(\"The request has failed\");"], [202, "\t\t}"], [203, "\t}"]], "deleted": [[37, ""], [42, "\tprivate RequestResponse response = null;"], [74, "\t\tif (response == null) {"], [75, "\t\t\tthrow new IllegalStateException(\"The request must first be executed\");"], [76, "\t\t}"], [77, "\t\treturn response.getCode();"], [81, "\t\tif (response == null) {"], [82, "\t\t\tthrow new IllegalStateException(\"The request must first be executed\");"], [83, "\t\t}"], [84, "\t\tif (!response.isSuccessful()) {"], [85, "\t\t\tthrow new IllegalStateException(\"The request threw an exception\");"], [86, "\t\t}"], [87, "\t\treturn response.getBody();"], [91, "\t\tresponse = new RequestResponse();"], [113, "\t\t\tresponse.setCode(connection.getResponseCode());"], [114, "\t\t\tif (response.getCode() == RequestResponse.CODE_ERROR_RATE_LIMITED) {"], [124, "\t\t\t} else if (!response.isSuccessful()) {"], [125, "\t\t\t\tthrow new RiotApiException(response.getCode());"], [129, "\t\t\tif (response.getCode() != RequestResponse.CODE_SUCCESS_NOCONTENT) {"], [137, "\t\t\tresponse.setBody(responseBodyBuilder.toString());"], [149, "\t\tif (!response.isSuccessful()) {"], [150, "\t\t\t// I think we can never get here. Let's make sure though"], [151, "\t\t\tthrow new RiotApiException(RiotApiException.IOEXCEPTION);"], [152, "\t\t}"], [153, "\t\tif (response.getCode() == RequestResponse.CODE_SUCCESS_NOCONTENT) {"], [159, "\t\t\tdto = new Gson().fromJson(response.getBody(), desiredDto);"], [170, "\t\tif (!response.isSuccessful()) {"], [171, "\t\t\t// I think we can never get here. Let's make sure though"], [172, "\t\t\tthrow new RiotApiException(RiotApiException.IOEXCEPTION);"], [173, "\t\t}"], [174, "\t\tif (response.getCode() == RequestResponse.CODE_SUCCESS_NOCONTENT) {"], [180, "\t\t\tdto = new Gson().fromJson(response.getBody(), desiredDto);"]]}, "num_lines_added": 47, "num_lines_removed": 32}