{"hash": "98a609c5cdba3c7aba86e43093c281faa1dc4fa6", "message": "shaved off a bit more time by computing a document's token to node map just once.", "file_num_lines": 161, "diff_parsed": {"added": [[41, "\tpublic void addExemplar(InputDocument doc, int[] features, int ws, int hpos) {"], [42, "\t\tdocumentsPerExemplar.add(doc);"], [43, "\t\tfeatureVectors.add(features);"], [44, "\t\tinjectWhitespace.add(ws);"], [45, "\t\tthis.hpos.add(hpos);"], [46, "\t}"], [47, ""], [80, "\t\tlong start = System.nanoTime();"], [82, "\t\tlong stop = System.nanoTime();"], [83, "\t\tSystem.out.printf(\"collectTokenPairsAndSplitListInfo %dms\\n\", (stop-start)/1_000_000);"], [101, "\t\t\tcollectSiblingLists.setTokens(doc.tokens, doc.tree, doc.tokenToNodeMap);"], [151, "\t\t\t// Parse document, save feature vectors to the doc"], [152, "\t\t\tTrainer trainer = new Trainer(this, doc, language.indentSize);"], [153, "\t\t\ttrainer.computeFeatureVectors();"]], "deleted": [[12, "import org.antlr.v4.runtime.misc.Triple;"], [92, "\t\t\tcollectSiblingLists.setTokens(doc.tokens, doc.tree);"], [142, "\t\t\tTriple<List<int[]>, List<Integer>, List<Integer>> results = process(doc);"], [143, "\t\t\tList<int[]> features = results.a;"], [144, "\t\t\tList<Integer> ws = results.b;"], [145, "\t\t\tList<Integer> al = results.c;"], [146, ""], [147, "\t\t\tfor (int i=0; i<features.size(); i++) {"], [148, "\t\t\t\tdocumentsPerExemplar.add(doc);"], [149, "\t\t\t\tint[] featureVec = features.get(i);"], [150, "\t\t\t\tinjectWhitespace.add(ws.get(i));"], [151, "\t\t\t\thpos.add(al.get(i));"], [152, "\t\t\t\tfeatureVectors.add(featureVec);"], [153, "\t\t\t}"], [157, "\t/** Parse document, save feature vectors to the doc */"], [158, "\tpublic Triple<List<int[]>,List<Integer>,List<Integer>> process(InputDocument doc) {"], [159, "\t\tTrainer trainer = new Trainer(this, doc, language.indentSize);"], [160, "\t\ttrainer.computeFeatureVectors();"], [161, ""], [162, "\t\tTriple<List<int[]>,List<Integer>,List<Integer>> results ="], [163, "\t\t\tnew Triple<>(trainer.getFeatureVectors(),"], [164, "\t\t\t\t\t\t trainer.getInjectWhitespace(),"], [165, "\t\t\t\t\t\t trainer.getHPos());"], [166, "//\t\tSystem.out.println(results.a.size()+\" \"+doc.tokens.size()+\" tokens \"+doc.fileName);"], [167, "\t\treturn results;"], [168, "\t}"], [169, ""]]}, "num_lines_added": 14, "num_lines_removed": 27}