{"hash": "21af457af09765b8e97b42b49923d338cff4c32c", "message": "Clarify object ownership in client", "file_num_lines": 425, "diff_parsed": {"added": [[53, "    private final String tableName;"], [54, "    private final Configuration hbaseConfig;"], [63, "    public HBaseCommitTable(Configuration hbaseConfig, String tableName) {"], [64, "        this(hbaseConfig, tableName, defaultKeyGenerator());"], [67, "    private HBaseCommitTable(Configuration hbaseConfig, String tableName, KeyGenerator keygen) {"], [68, "        this.hbaseConfig = hbaseConfig;"], [69, "        this.tableName = tableName;"], [76, "        HBaseWriter(Configuration hbaseConfig, String tableName) throws IOException {"], [77, "            table = new HTable(hbaseConfig, tableName);"], [116, "        HBaseClient(Configuration hbaseConfig, String tableName) throws IOException {"], [117, "            table = new HTable(hbaseConfig, tableName);"], [119, "            deleteTable = new HTable(hbaseConfig, tableName);"], [258, "            f.set(new HBaseWriter(hbaseConfig, tableName));"], [269, "            f.set(new HBaseClient(hbaseConfig, tableName));"], [471, "        CommitTable commitTable = new HBaseCommitTable(hbaseConfig,"], [472, "                                                       COMMIT_TABLE_DEFAULT_NAME, keygen);"]], "deleted": [[53, "    private final HTable baseTable;"], [62, "    public HBaseCommitTable(HTable table) {"], [63, "        this(table, defaultKeyGenerator());"], [66, "    private HBaseCommitTable(HTable table, KeyGenerator keygen) {"], [67, "        this.baseTable = table;"], [74, "        HBaseWriter(HTable baseTable) throws IOException {"], [75, "            table = new HTable(baseTable.getConfiguration(), baseTable.getTableName());"], [114, "        HBaseClient(HTable baseTable) throws IOException {"], [115, "            table = new HTable(baseTable.getConfiguration(), baseTable.getTableName());"], [117, "            deleteTable = new HTable(baseTable.getConfiguration(), baseTable.getTableName());"], [256, "            f.set(new HBaseWriter(baseTable));"], [267, "            f.set(new HBaseClient(baseTable)); // Check this depending on (*)"], [446, "        @Parameter(names = \"-writeBufferSize\", description = \"write buffer size\")"], [447, "        long writeBufferSize = -1;"], [448, ""], [451, ""], [459, "        HTable commitHTable = new HTable(hbaseConfig, COMMIT_TABLE_DEFAULT_NAME);"], [460, "        if (config.writeBufferSize != -1) {"], [461, "            commitHTable.setWriteBufferSize(config.writeBufferSize);"], [462, "        }"], [477, "        CommitTable commitTable = new HBaseCommitTable(commitHTable, keygen);"]]}, "num_lines_added": 16, "num_lines_removed": 21}