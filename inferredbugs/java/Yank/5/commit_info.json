{"hash": "8b13dd4576f2d04e61f605df96c8b1154be9a8f9", "message": "not handling connections manually anymore. Happens inside QueryRunner.", "file_num_lines": 150, "diff_parsed": {"added": [[39, "  private static final YankPoolManager DB_CONNECTION_MANAGER = YankPoolManager.INSTANCE;"], [92, "      returnInt = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).update(sql, params);"], [146, "      returnObject = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).query(sql, resultSetHandler, params);"], [199, "      returnObject = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).query(sql, resultSetHandler, params);"], [251, "      returnList = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).query(sql, resultSetHandler, params);"], [303, "      returnList = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).query(sql, resultSetHandler, params);"], [351, "      // returnList = new QueryRunner().query(con, sql, resultSetHandler, params);"], [352, "      returnList = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).query(sql, resultSetHandler, params);"], [399, "      returnIntArray = new QueryRunner(DB_CONNECTION_MANAGER.getDataSource(poolName)).batch(sql, params);"]], "deleted": [[18, "import java.sql.Connection;"], [19, "import java.sql.SQLException;"], [41, "  private static final DBConnectionManager DB_CONNECTION_MANAGER = DBConnectionManager.INSTANCE;"], [46, "  private static final String ROLLBACK_EXCEPTION_MESSAGE = \"Exception caught while rolling back transaction\";"], [93, "    Connection con = null;"], [94, ""], [96, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [97, ""], [98, "      if (con == null) {"], [99, "        throw new ConnectionException(poolName);"], [100, "      }"], [101, ""], [102, "      con.setAutoCommit(false);"], [103, ""], [104, "      returnInt = new QueryRunner().update(con, sql, params);"], [106, "      con.commit();"], [110, "      if (con != null) {"], [111, "        try {"], [112, "          con.rollback();"], [113, "        } catch (SQLException e1) {"], [114, "          logger.error(ROLLBACK_EXCEPTION_MESSAGE, e1);"], [115, "        }"], [116, "      }"], [117, "    } finally {"], [118, "      DB_CONNECTION_MANAGER.freeConnection(con);"], [165, "    Connection con = null;"], [166, ""], [168, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [169, ""], [170, "      if (con == null) {"], [171, "        throw new ConnectionException(poolName);"], [172, "      }"], [173, ""], [174, "      con.setAutoCommit(false);"], [178, "      returnObject = new QueryRunner().query(con, sql, resultSetHandler, params);"], [179, ""], [180, "      con.commit();"], [184, "      try {"], [185, "        con.rollback();"], [186, "      } catch (SQLException e2) {"], [187, "        logger.error(ROLLBACK_EXCEPTION_MESSAGE, e2);"], [188, "      }"], [189, "    } finally {"], [190, "      DB_CONNECTION_MANAGER.freeConnection(con);"], [236, "    Connection con = null;"], [237, ""], [239, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [240, ""], [241, "      if (con == null) {"], [242, "        throw new ConnectionException(poolName);"], [243, "      }"], [244, ""], [245, "      con.setAutoCommit(false);"], [249, "      returnObject = new QueryRunner().query(con, sql, resultSetHandler, params);"], [250, ""], [251, "      con.commit();"], [255, "      try {"], [256, "        con.rollback();"], [257, "      } catch (SQLException e2) {"], [258, "        logger.error(ROLLBACK_EXCEPTION_MESSAGE, e2);"], [259, "      }"], [260, "    } finally {"], [261, "      DB_CONNECTION_MANAGER.freeConnection(con);"], [306, "    Connection con = null;"], [307, ""], [309, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [310, ""], [311, "      if (con == null) {"], [312, "        throw new ConnectionException(poolName);"], [313, "      }"], [314, ""], [315, "      con.setAutoCommit(false);"], [319, "      returnList = new QueryRunner().query(con, sql, resultSetHandler, params);"], [320, ""], [321, "      con.commit();"], [325, "      try {"], [326, "        con.rollback();"], [327, "      } catch (SQLException e2) {"], [328, "        logger.error(ROLLBACK_EXCEPTION_MESSAGE, e2);"], [329, "      }"], [330, "    } finally {"], [331, "      DB_CONNECTION_MANAGER.freeConnection(con);"], [376, "    Connection con = null;"], [377, ""], [379, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [380, ""], [381, "      if (con == null) {"], [382, "        throw new ConnectionException(poolName);"], [383, "      }"], [384, ""], [385, "      con.setAutoCommit(false);"], [389, "      returnList = new QueryRunner().query(con, sql, resultSetHandler, params);"], [390, ""], [391, "      con.commit();"], [395, "      try {"], [396, "        con.rollback();"], [397, "      } catch (SQLException e2) {"], [398, "        logger.error(ROLLBACK_EXCEPTION_MESSAGE, e2);"], [399, "      }"], [400, "    } finally {"], [401, "      DB_CONNECTION_MANAGER.freeConnection(con);"], [443, "    Connection con = null;"], [444, ""], [446, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [447, ""], [448, "      if (con == null) {"], [449, "        throw new ConnectionException(poolName);"], [450, "      }"], [451, ""], [452, "      con.setAutoCommit(false);"], [455, "      returnList = new QueryRunner().query(con, sql, resultSetHandler, params);"], [457, "      con.commit();"], [460, "      try {"], [461, "        con.rollback();"], [462, "      } catch (SQLException e1) {"], [463, "        logger.error(ROLLBACK_EXCEPTION_MESSAGE, e1);"], [464, "      }"], [465, "    } finally {"], [466, "      DB_CONNECTION_MANAGER.freeConnection(con);"], [508, "    Connection con = null;"], [509, ""], [511, "      con = DB_CONNECTION_MANAGER.getConnection(poolName);"], [512, ""], [513, "      if (con == null) {"], [514, "        throw new ConnectionException(poolName);"], [515, "      }"], [516, ""], [517, "      con.setAutoCommit(false);"], [519, "      returnIntArray = new QueryRunner().batch(con, sql, params);"], [521, "      con.commit();"], [524, "      try {"], [525, "        con.rollback();"], [526, "      } catch (SQLException e1) {"], [527, "        logger.error(ROLLBACK_EXCEPTION_MESSAGE, e1);"], [528, "      }"], [529, "    } finally {"], [530, "      DB_CONNECTION_MANAGER.freeConnection(con);"]]}, "num_lines_added": 9, "num_lines_removed": 137}