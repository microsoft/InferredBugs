{"hash": "6654480d1ead69ba741f951aaa2a8bfb9ad7baef", "message": "delete all segments after crash segment", "file_num_lines": 275, "diff_parsed": {"added": [[122, "        final LogSegment latestSegment = latestSegment();"], [123, "        final long maxOffset = latestSegment.getBaseOffset() + latestSegment.getFileSize();"], [129, "            if (segment.getBaseOffset() != latestSegment.getBaseOffset()) {"], [130, "                LOG.info(\"will remove all segment after max wrote position. current base offset: {}, max base offset: {}\","], [131, "                        segment.getBaseOffset(), latestSegment.getBaseOffset());"], [132, "                deleteSegmentsAfterOffset(offset);"], [133, "            }"], [285, "    private void deleteSegmentsAfterOffset(final long offset) {"], [286, "        Predicate<LogSegment> predicate = segment -> segment.getBaseOffset() > offset;"], [287, "        deleteSegments(predicate, null);"], [288, "    }"], [289, ""]], "deleted": [[122, "        final long maxOffset = latestSegment().getBaseOffset() + latestSegment().getFileSize();"], [128, "            // TODO(keli.wang): should delete crash file"]]}, "num_lines_added": 12, "num_lines_removed": 2}