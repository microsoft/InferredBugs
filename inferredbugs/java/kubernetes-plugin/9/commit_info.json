{"hash": "a4dfd7715856469a899219383ac3dc0af2f2df81", "message": "Refactoring on PlannedNode and KubernetesSlave to improve extensibility\n\n* New extension point PlannedNodeBuilderFactory to allow extensions to provide alternative PlannedNode implementations.\n* Builder pattern for KubernetesSlave to stop the explosion of constructors", "file_num_lines": 21, "diff_parsed": {"added": [[27, "import java.util.concurrent.Callable;"], [30, ""], [31, "import hudson.model.Node;"], [45, "    public ProvisioningCallback(@Nonnull KubernetesCloud cloud, @Nonnull PodTemplate t) {"], [51, "        return KubernetesSlave"], [52, "                .builder()"], [53, "                    .podTemplate(cloud.getUnwrappedTemplate(t))"], [54, "                    .cloud(cloud)"], [55, "                .build();"]], "deleted": [[27, "import hudson.model.Label;"], [28, "import hudson.model.Node;"], [29, "import hudson.slaves.CloudRetentionStrategy;"], [30, "import hudson.slaves.RetentionStrategy;"], [31, "import org.jenkinsci.plugins.durabletask.executors.OnceRetentionStrategy;"], [33, "import javax.annotation.CheckForNull;"], [35, "import java.util.concurrent.Callable;"], [48, "    @CheckForNull"], [49, "    private final Label label;"], [51, "    public ProvisioningCallback(@Nonnull KubernetesCloud cloud, @Nonnull PodTemplate t, @CheckForNull Label label) {"], [54, "        this.label = label;"], [58, "        RetentionStrategy retentionStrategy;"], [59, "        if (t.getIdleMinutes() == 0) {"], [60, "            retentionStrategy = new OnceRetentionStrategy(cloud.getRetentionTimeout());"], [61, "        } else {"], [62, "            retentionStrategy = new CloudRetentionStrategy(t.getIdleMinutes());"], [63, "        }"], [64, ""], [65, "        final PodTemplate unwrappedTemplate = PodTemplateUtils.unwrap(cloud.getTemplate(label),"], [66, "                cloud.getDefaultsProviderTemplate(), cloud.getTemplates());"], [67, "        return new KubernetesSlave(unwrappedTemplate, unwrappedTemplate.getName(), cloud.name,"], [68, "                unwrappedTemplate.getLabel(), retentionStrategy);"]]}, "num_lines_added": 9, "num_lines_removed": 22}