{"hash": "d33d9efea25fe9d2bbbb9e84a4ce7614b544ef2d", "message": "[HELIX-764] TASK: Fix LiveInstanceCurrentState change flag\n\nPreviously, existsLiveInstanceOrCurrentStateChange was getting reset in ClusterDataCache when its getter was called. This was problematic because if there were multiple jobs or multiple workflows, whoever calls this getter would get the correct flag value, and the ensuing callers would get a false because the flag would have been reset. This RB fixes that bug by reseting the flat right in the beginning of refresh() call in ClusterDataCache, which allows all callers during that pipeline would get the same, correct value.\nChangelist:\n1. Change the getter so that it does not reset the flag; instead, reset the flag in the beginning of refresh()", "file_num_lines": 605, "diff_parsed": {"added": [[154, "    // Reset the LiveInstance/CurrentState change flag"], [155, "    _existsLiveInstanceOrCurrentStateChange = false;"], [156, ""], [941, "   * Returns whether there has been LiveInstance or CurrentState change. To be used for"], [942, "   * task-assigning in AbstractTaskDispatcher."], [946, "    return _existsLiveInstanceOrCurrentStateChange;"], [964, "      cachedResourceConfigMap.put(keyBuilder.resourceConfig(resourceConfig),"], [965, "          _resourceConfigMap.get(resourceConfig));"], [972, "    Map<PropertyKey, ResourceConfig> updatedMap = refreshProperties(accessor,"], [973, "        new LinkedList<>(reloadKeys), new ArrayList<>(cachedKeys), cachedResourceConfigMap);"], [1003, "}"]], "deleted": [[938, "   * Returns whether there has been LiveInstance change. Once called, it will be set to false. To be"], [939, "   * used for task-assigning."], [943, "    boolean change = _existsLiveInstanceOrCurrentStateChange;"], [944, "    _existsLiveInstanceOrCurrentStateChange = false;"], [945, "    return change;"], [963, "      cachedResourceConfigMap"], [964, "          .put(keyBuilder.resourceConfig(resourceConfig), _resourceConfigMap.get(resourceConfig));"], [971, "    Map<PropertyKey, ResourceConfig> updatedMap ="], [972, "        refreshProperties(accessor, new LinkedList<>(reloadKeys), new ArrayList<>(cachedKeys),"], [973, "            cachedResourceConfigMap);"], [1003, "}"]]}, "num_lines_added": 11, "num_lines_removed": 11}