{"hash": "3a0a5e5651ed17b462b28257c888caebbf7fbcbd", "message": "Change accessor to helixAccessor in ZKHelixManager. DDS-3309: sync on getPropertyStore()", "file_num_lines": 712, "diff_parsed": {"added": [[35, "import java.util.concurrent.atomic.AtomicReference;"], [61, "import com.linkedin.helix.PropertyKey.Builder;"], [109, "  private final AtomicReference<PropertyStore<ZNRecord>> _propertyStoreRef;"], [165, "    _propertyStoreRef = new AtomicReference<PropertyStore<ZNRecord>>();"], [166, ""], [482, "    // if (!_accessor.setProperty(PropertyType.LIVEINSTANCES, liveInstance, _instanceName))"], [483, "    Builder keyBuilder = _helixAccessor.keyBuilder();"], [484, "    if (!_helixAccessor.setProperty(keyBuilder.liveInstance(_instanceName), liveInstance))"], [638, "    Builder keyBuilder = _helixAccessor.keyBuilder();"], [639, ""], [640, "    if (_helixAccessor.getProperty(keyBuilder.liveInstance(_instanceName)) != null)"], [655, "      if (_helixAccessor.getProperty(keyBuilder.liveInstance(_instanceName)) != null)"], [731, "    Builder keyBuilder = _helixAccessor.keyBuilder();"], [732, "    LiveInstance leader = _helixAccessor.getProperty(keyBuilder.controllerLeader());"], [752, "    Builder keyBuilder = _helixAccessor.keyBuilder();"], [753, ""], [754, "    List<String> subPaths = _helixAccessor.getChildNames(keyBuilder.sessions(_instanceName));"], [757, "      List<CurrentState> previousCurrentStates = _helixAccessor.getChildValues(keyBuilder.currentStates(_instanceName, previousSessionId));"], [766, "          StateModelDefinition stateModel = _helixAccessor.getProperty(keyBuilder.stateModelDef(stateModelDefRef));"], [773, "          _helixAccessor.setProperty(keyBuilder.currentState(_instanceName, _sessionId, previousCurrentState.getId()), previousCurrentState);"], [795, "    synchronized (_propertyStoreRef)"], [797, "      if (_propertyStoreRef.get() == null)"], [804, "        PropertyStore<ZNRecord>_propertyStore ="], [806, "        _propertyStoreRef.set(_propertyStore);"], [809, "    return _propertyStoreRef.get();"]], "deleted": [[107, "  private PropertyStore<ZNRecord> _propertyStore = null;"], [478, "    if (!_accessor.setProperty(PropertyType.LIVEINSTANCES, liveInstance, _instanceName))"], [632, "    if (_accessor.getProperty(PropertyType.LIVEINSTANCES, _instanceName) != null)"], [647, "      if (_accessor.getProperty(PropertyType.LIVEINSTANCES, _instanceName) != null)"], [723, "    LiveInstance leader = _accessor.getProperty(LiveInstance.class, PropertyType.LEADER);"], [743, "    List<String> subPaths = _accessor.getChildNames(PropertyType.CURRENTSTATES, _instanceName);"], [746, "      List<CurrentState> previousCurrentStates = _accessor.getChildValues(CurrentState.class,"], [747, "          PropertyType.CURRENTSTATES, _instanceName, previousSessionId);"], [756, "          StateModelDefinition stateModel = _accessor.getProperty(StateModelDefinition.class,"], [757, "              PropertyType.STATEMODELDEFS, stateModelDefRef);"], [764, "          _accessor.setProperty(PropertyType.CURRENTSTATES, previousCurrentState, _instanceName,"], [765, "              _sessionId, previousCurrentState.getId());"], [787, "    synchronized (_propertyStore)"], [789, "      if (_propertyStore == null)"], [796, "        _propertyStore ="], [800, "    return _propertyStore;"]]}, "num_lines_added": 25, "num_lines_removed": 16}