{"hash": "2cf546d063b6fc573b9e5b7dc99ba5a1387ab663", "message": "RATIS-867. Fix failed UT: TestMetaServer#testListLogs (#107)", "file_num_lines": 312, "diff_parsed": {"added": [[21, "import org.apache.ratis.client.RaftClientConfigKeys;"], [22, "import org.apache.ratis.conf.RaftProperties;"], [67, "    static LogServiceClient client = null;"], [68, ""], [69, "    @BeforeClass"], [70, "    public static void beforeClass() {"], [71, "        cluster = new LogServiceCluster(3);"], [72, "        cluster.createWorkers(3);"], [73, "        workers = cluster.getWorkers();"], [74, "        assert(workers.size() == 3);"], [75, ""], [76, "        RaftProperties properties = new RaftProperties();"], [77, "        RaftClientConfigKeys.Rpc.setRequestTimeout(properties, TimeDuration.valueOf(15, TimeUnit.SECONDS));"], [78, ""], [79, "        cluster.getMasters().parallelStream().forEach(master ->"], [80, "            ((MetaStateMachine)master.getMetaStateMachine()).setProperties(properties));"], [81, ""], [82, "        client = new LogServiceClient(cluster.getMetaIdentity(), properties) {"], [83, "          @Override"], [84, "          public LogStream createLog(LogName logName) throws IOException {"], [87, "          }"], [89, "          @Override"], [90, "          public void deleteLog(LogName logName) throws IOException {"], [93, "          }"], [95, "          @Override"], [96, "          public List<LogInfo> listLogs() throws IOException {"], [99, "          }"], [100, "        };"], [108, ""], [109, "        if (client != null) {"], [110, "          try {"], [111, "            client.close();"], [112, "          } catch (Exception ignored) {"], [113, "          }"], [114, "        }"]], "deleted": [[65, "    LogServiceClient client = new LogServiceClient(cluster.getMetaIdentity()){"], [66, "        @Override public LogStream createLog(LogName logName) throws IOException {"], [69, "        }"], [71, "        @Override public void deleteLog(LogName logName) throws IOException {"], [74, "        }"], [76, "        @Override public List<LogInfo> listLogs() throws IOException {"], [79, "        }"], [80, ""], [81, "    };"], [82, "    @BeforeClass"], [83, "    public static void beforeClass() {"], [84, "        cluster = new LogServiceCluster(3);"], [85, "        cluster.createWorkers(3);"], [86, "        workers = cluster.getWorkers();"], [87, "        assert(workers.size() == 3);"]]}, "num_lines_added": 35, "num_lines_removed": 15}