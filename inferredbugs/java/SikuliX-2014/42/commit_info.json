{"hash": "70cda40c255eb8ab84cbcb9375239cd07005c7ea", "message": "ongoing: track the multi-monitor capture problem on OSX 10.11", "file_num_lines": 285, "diff_parsed": {"added": [[41, "  private int srcScreenId = -1;"], [48, "  private boolean hasFinished = false;"], [49, "  private boolean hasStarted = false;"], [55, ""], [56, "  public int getScrID() {"], [57, "    return srcScreenId;"], [58, "  }"], [62, "    scrOCP = scr;"], [66, ""], [73, "        if (e.getButton() != java.awt.event.MouseEvent.BUTTON1) {"], [74, "          return;"], [76, "        hasStarted = true;"], [90, "        if (e.getButton() != java.awt.event.MouseEvent.BUTTON1) {"], [92, "          Debug.log(3, \"CapturePrompt: aborted: not using left mouse button\");"], [98, "        hasFinished = true;"], [106, "      public void mouseMoved(java.awt.event.MouseEvent e) {"], [107, "        if (promptMsg == null) {"], [108, "          return;"], [109, "        }"], [110, "        promptMsg = null;"], [111, "        repaint();"], [112, "      }"], [113, "      @Override"], [115, "        if (!hasStarted || scr_img == null) {"], [118, "        if (!dragging) {"], [119, "          Screen.closePrompt((Screen) scrOCP);"], [120, "          dragging = true;"], [121, "        }"], [137, "          hasFinished = canceled = true;"], [148, "    Debug.log(4, \"CapturePrompt.close: S(%d) freeing resources\", scrOCP.getID());"], [163, "    if (obs != null) {"], [164, "      obs.update(this);"], [165, "    }"], [185, "    ScreenImage simg = scrOCP.capture();"], [186, "    scr_img = simg.getImage();"], [187, "    darker_factor = 0.6f;"], [188, "    RescaleOp op = new RescaleOp(darker_factor, 0, null);"], [189, "    scr_img_darker = op.filter(scr_img, null);"], [197, "  public boolean isComplete() {"], [198, "    return hasFinished;"], [200, ""], [214, ""], [241, "//    Rectangle ubound = (new ScreenUnion()).getBounds();"], [242, "    Rectangle ubound = scrOCP.getBounds();"], [244, "      if (!Screen.getScreen(i).hasPrompt()) {"], [245, "        continue;"], [246, "      }"]], "deleted": [[9, "import org.sikuli.basics.Settings;"], [14, "import org.sikuli.natives.SysUtil;"], [17, "import org.sikuli.script.RunTime;"], [20, "import org.sikuli.script.ScreenUnion;"], [45, "  private int srcScreenId = 0;"], [51, "  private boolean didPurgeMessage = false;"], [61, "    if (RunTime.get().isOSX10()) {"], [62, "      scrOCP = scr;"], [63, "    } else {"], [64, "      if (Screen.getNumberScreens() > 1) {"], [65, "        scrOCP = new ScreenUnion();"], [66, "      } else {"], [67, "        scrOCP = Screen.getPrimaryScreen();"], [68, "      }"], [69, "    }"], [74, ""], [75, "      @Override"], [76, "      public void mouseMoved(java.awt.event.MouseEvent e) {"], [77, "        if (promptMsg == null) {"], [78, "          return;"], [79, "        }"], [80, "        promptMsg = null;"], [81, "        repaint();"], [82, "      }"], [83, ""], [89, "        if (promptMsg != null) {"], [90, "          promptMsg = null;"], [91, "          didPurgeMessage = true;"], [101, ""], [107, "        if (!dragging && didPurgeMessage) {"], [108, "          didPurgeMessage = false;"], [109, "          return;"], [110, "        }"], [111, "        if (e.getButton() == java.awt.event.MouseEvent.BUTTON3) {"], [113, "          Debug.log(3, \"CapturePrompt: aborted using right mouse button\");"], [127, "        if (scr_img == null) {"], [130, "        dragging = true;"], [146, "          canceled = true;"], [157, "    Debug.log(4, \"CapturePrompt.close: freeing resources\");"], [172, "    obs.update(this);"], [192, "    captureScreen(scrOCP);"], [198, "    if (!Settings.isJava7()) {"], [199, "      if (Settings.isMac()) {"], [200, "        SysUtil.getOSUtil().bringWindowToFront(this, false);"], [201, "      }"], [202, "    }"], [203, "    this.requestFocus();"], [206, "  private void captureScreen(IScreen scr) {"], [207, "    ScreenImage simg = scr.capture();"], [208, "    scr_img = simg.getImage();"], [209, "    darker_factor = 0.6f;"], [210, "    RescaleOp op = new RescaleOp(darker_factor, 0, null);"], [211, "    scr_img_darker = op.filter(scr_img, null);"], [213, ""], [227, ""], [254, "    Rectangle ubound = (new ScreenUnion()).getBounds();"]]}, "num_lines_added": 47, "num_lines_removed": 56}