{"hash": "1ae9d35d83ce607cc7725050bdf35f10cbb4ab8b", "message": "fix rsa block", "file_num_lines": 131, "diff_parsed": {"added": [[9, "import javax.crypto.BadPaddingException;"], [10, "import javax.crypto.Cipher;"], [11, "import javax.crypto.IllegalBlockSizeException;"], [12, "import java.io.IOException;"], [13, "import java.security.Key;"], [14, "import java.security.PrivateKey;"], [15, "import java.security.PublicKey;"], [16, ""], [201, ""], [202, "\t\t\tif(this.encryptBlockSize < 0){"], [203, "\t\t\t\t// \u5728\u5f15\u5165BC\u5e93\u60c5\u51b5\u4e0b\uff0c\u81ea\u52a8\u83b7\u53d6\u5757\u5927\u5c0f"], [204, "\t\t\t\tfinal int blockSize = this.cipher.getBlockSize();"], [205, "\t\t\t\tif(blockSize > 0){"], [206, "\t\t\t\t\tthis.encryptBlockSize = blockSize;"], [207, "\t\t\t\t}"], [208, "\t\t\t}"], [209, ""], [210, "\t\t\treturn doFinal(data, this.encryptBlockSize < 0 ? data.length : this.encryptBlockSize);"], [232, ""], [233, "\t\t\tif(this.decryptBlockSize < 0){"], [234, "\t\t\t\t// \u5728\u5f15\u5165BC\u5e93\u60c5\u51b5\u4e0b\uff0c\u81ea\u52a8\u83b7\u53d6\u5757\u5927\u5c0f"], [235, "\t\t\t\tfinal int blockSize = this.cipher.getBlockSize();"], [236, "\t\t\t\tif(blockSize > 0){"], [237, "\t\t\t\t\tthis.decryptBlockSize = blockSize;"], [238, "\t\t\t\t}"], [239, "\t\t\t}"], [240, ""], [241, "\t\t\treturn doFinal(data, this.decryptBlockSize < 0 ? data.length : this.decryptBlockSize);"]], "deleted": [[3, "import java.io.IOException;"], [4, "import java.security.Key;"], [5, "import java.security.PrivateKey;"], [6, "import java.security.PublicKey;"], [7, ""], [8, "import javax.crypto.BadPaddingException;"], [9, "import javax.crypto.Cipher;"], [10, "import javax.crypto.IllegalBlockSizeException;"], [11, ""], [199, "\t\tfinal int maxBlockSize = this.encryptBlockSize < 0 ? data.length : this.encryptBlockSize;"], [200, ""], [204, "\t\t\treturn doFinal(data, maxBlockSize);"], [223, "\t\tfinal int maxBlockSize = this.decryptBlockSize < 0 ? data.length : this.decryptBlockSize;"], [224, ""], [228, "\t\t\treturn doFinal(data, maxBlockSize);"]]}, "num_lines_added": 28, "num_lines_removed": 15}