{"hash": "3c74ca268b68f8120b7a70b2bb0e777b3df60c1f", "message": "Fix up servlet session handling", "file_num_lines": 723, "diff_parsed": {"added": [[281, "        return servletContext.getSession(exchange.getExchange(), create);"]], "deleted": [[66, "import io.undertow.server.session.Session;"], [67, "import io.undertow.server.session.SessionManager;"], [108, "    private HttpSessionImpl httpSession;"], [284, "        if (httpSession == null) {"], [285, "            Session session = exchange.getExchange().getAttachment(Session.ATTACHMENT_KEY);"], [286, "            if (session != null) {"], [287, "                httpSession = new HttpSessionImpl(session, servletContext, servletContext.getDeployment().getApplicationListeners(), exchange.getExchange(), false);"], [288, "            } else if (create) {"], [289, "                final SessionManager sessionManager = exchange.getExchange().getAttachment(SessionManager.ATTACHMENT_KEY);"], [290, "                try {"], [291, "                    Session newSession = sessionManager.getOrCreateSession(exchange.getExchange()).get();"], [292, "                    httpSession = new HttpSessionImpl(newSession, servletContext, servletContext.getDeployment().getApplicationListeners(), exchange.getExchange(), true);"], [293, "                    servletContext.getDeployment().getApplicationListeners().sessionCreated(httpSession);"], [294, "                } catch (IOException e) {"], [295, "                    throw new RuntimeException(e);"], [296, "                }"], [297, "            }"], [298, "        }"], [299, "        return httpSession;"]]}, "num_lines_added": 1, "num_lines_removed": 19}