{"hash": "9a0f472dea6c4da312bd0453f5d4e07ab4e36953", "message": "OpenSOC grok", "file_num_lines": 78, "diff_parsed": {"added": [[7, "import java.util.Arrays;"], [26, "\t//private transient static OpenSOCGrok grok;"], [27, "\t//private transient static InputStream pattern_url;"], [30, "//\t\tpattern_url = getClass().getClassLoader().getResourceAsStream("], [31, "//\t\t\t\t\"patterns/fireeye\");"], [32, "//"], [33, "//\t\tFile file = ParserUtils.stream2file(pattern_url);"], [34, "//\t\tgrok = OpenSOCGrok.create(file.getPath());"], [35, "//"], [36, "//\t\tgrok.compile(\"%{FIREEYE_BASE}\");"], [52, "\t\t\t//OpenSOCMatch gm = grok.match(toParse);"], [53, "\t\t\t//gm.captures();"], [56, ""], [57, "\t\t\tString[] mTokens = toParse.split(\" \");"], [59, "\t\t\t//toReturn.putAll(gm.toMap());"], [61, "\t\t\tString id = mTokens[0];"], [68, "\t\t\tif(tokens.length == 2 ) {"], [70, "\t\t\t\tString[] array = Arrays.copyOfRange(mTokens, 1, mTokens.length-1);"], [71, "\t\t\tString syslog = Joiner.on(\" \").join(array);"], [97, "\t\t\tSystem.out.println(toReturn);"]], "deleted": [[25, "\tprivate transient static OpenSOCGrok grok;"], [26, "\tprivate transient static InputStream pattern_url;"], [29, "\t\tpattern_url = getClass().getClassLoader().getResourceAsStream("], [30, "\t\t\t\t\"patterns/fireeye\");"], [31, ""], [32, "\t\tFile file = ParserUtils.stream2file(pattern_url);"], [33, "\t\tgrok = OpenSOCGrok.create(file.getPath());"], [34, ""], [35, "\t\tgrok.compile(\"%{FIREEYE_BASE}\");"], [38, "\tpublic BasicFireEyeParser(String filepath) throws Exception {"], [39, ""], [40, "\t\tgrok = OpenSOCGrok.create(filepath);"], [41, "\t\tgrok.compile(\"%{FIREEYE_BASE}\");"], [42, ""], [43, "\t}"], [44, ""], [45, "\tpublic BasicFireEyeParser(String filepath, String pattern) throws Exception {"], [46, ""], [47, "\t\tgrok = OpenSOCGrok.create(filepath);"], [48, "\t\tgrok.compile(\"%{\" + pattern + \"}\");"], [49, "\t}"], [63, "\t\t\tOpenSOCMatch gm = grok.match(toParse);"], [64, "\t\t\tgm.captures();"], [68, "\t\t\ttoReturn.putAll(gm.toMap());"], [70, "\t\t\tString id = toReturn.get(\"uid\").toString();"], [77, "\t\t\tif(tokens.length == 1 ) {"], [79, "\t\t\tString syslog = toReturn.get(\"syslog\").toString();"]]}, "num_lines_added": 20, "num_lines_removed": 27}