{"hash": "0668abf5839f413a1a96a171abc885e8315eac6f", "message": "Make REST class thread safe", "file_num_lines": 247, "diff_parsed": {"added": [[41, " *"], [74, "     *"], [75, "     * @param host The host endpoint"], [84, "     *"], [85, "     * @param host The host endpoint"], [86, "     * @param port The port"], [96, "     *"], [110, "     *"], [125, "     *"], [126, "     * @param path       The request path"], [127, "     * @param parameters The parameters (collection of Parameter objects)"], [162, "        } catch (IllegalAccessException | InstantiationException | SAXException | IOException | InterruptedException | ExecutionException | ParserConfigurationException e) {"], [170, "     * @param path       The request path"], [171, "     * @param parameters The parameters (collection of Parameter objects)"], [185, "        } catch (IllegalAccessException | InterruptedException | ExecutionException | InstantiationException | IOException | SAXException | ParserConfigurationException e) {"], [193, "     * @param path     The request path"], [194, "     * @param metaData The parameters (collection of Parameter objects)"], [217, "        } catch (IllegalAccessException | InterruptedException | ExecutionException | InstantiationException | IOException | SAXException | ParserConfigurationException e) {"], [246, "    private Response handleResponse(OAuthRequest request, OAuth10aService service) throws InterruptedException, ExecutionException, IOException, SAXException, InstantiationException, IllegalAccessException, ParserConfigurationException {"], [250, "        String strXml = scribeResponse.getBody().trim();"], [251, "        if (Flickr.debugStream) {"], [252, "            logger.debug(strXml);"], [254, "        if (strXml.startsWith(\"oauth_problem=\")) {"], [255, "            throw new FlickrRuntimeException(strXml);"], [256, "        }"], [257, ""], [258, "        DocumentBuilder builder = getDocumentBuilder();"], [259, "        Document document = builder.parse(new InputSource(new StringReader(strXml)));"], [260, "        f4jResponse = (Response) responseClass.newInstance();"], [261, "        f4jResponse.parse(document);"], [262, ""], [268, "     * <p>"], [270, "     *"], [271, "     * @param path       The request path"], [272, "     * @param parameters The parameters"], [298, "            DocumentBuilder builder = getDocumentBuilder();"], [299, "            Document document = builder.parse(in);"], [300, "            response = (Response) responseClass.newInstance();"], [301, "            response.parse(document);"], [302, ""], [304, "        } catch (IllegalAccessException | SAXException | IOException | InstantiationException | ParserConfigurationException e) {"], [343, "     * @param parameters"], [366, "     *"], [390, "    private DocumentBuilder getDocumentBuilder() throws ParserConfigurationException {"], [391, "        DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();"], [392, "        return builderFactory.newDocumentBuilder();"], [393, "    }"], [394, ""]], "deleted": [[41, " *"], [51, "    private static final String CHARSET_NAME = \"UTF-8\";"], [52, ""], [59, "    private final DocumentBuilder builder;"], [60, ""], [61, "    private static Object mutex = new Object();"], [62, ""], [76, "        DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();"], [77, "        try {"], [78, "            builder = builderFactory.newDocumentBuilder();"], [79, "        } catch (ParserConfigurationException e) {"], [80, "            throw new FlickrRuntimeException(e);"], [81, "        }"], [86, "     *"], [87, "     * @param host"], [88, "     *            The host endpoint"], [97, "     *"], [98, "     * @param host"], [99, "     *            The host endpoint"], [100, "     * @param port"], [101, "     *            The port"], [111, "     *"], [125, "     *"], [140, "     *"], [141, "     * @param path"], [142, "     *            The request path"], [143, "     * @param parameters"], [144, "     *            The parameters (collection of Parameter objects)"], [179, "        } catch (IllegalAccessException | InstantiationException | SAXException | IOException | InterruptedException | ExecutionException e) {"], [187, "     * @param path"], [188, "     *            The request path"], [189, "     * @param parameters"], [190, "     *            The parameters (collection of Parameter objects)"], [204, "        } catch (IllegalAccessException | InterruptedException | ExecutionException | InstantiationException | IOException | SAXException e) {"], [212, "     * @param path"], [213, "     *            The request path"], [214, "     * @param metaData"], [215, "     *            The parameters (collection of Parameter objects)"], [238, "        } catch (IllegalAccessException | InterruptedException | ExecutionException | InstantiationException | IOException | SAXException e) {"], [267, "    private Response handleResponse(OAuthRequest request, OAuth10aService service) throws InterruptedException, ExecutionException, IOException, SAXException, InstantiationException, IllegalAccessException {"], [271, "        synchronized (mutex) {"], [272, "            String strXml = scribeResponse.getBody().trim();"], [273, "            if (Flickr.debugStream) {"], [274, "                logger.debug(strXml);"], [275, "            }"], [276, "            if (strXml.startsWith(\"oauth_problem=\")) {"], [277, "                throw new FlickrRuntimeException(strXml);"], [278, "            }"], [279, "            Document document = builder.parse(new InputSource(new StringReader(strXml)));"], [280, "            f4jResponse = (Response) responseClass.newInstance();"], [281, "            f4jResponse.parse(document);"], [288, "     *"], [290, "     *"], [291, "     * @param path"], [292, "     *            The request path"], [293, "     * @param parameters"], [294, "     *            The parameters"], [320, "            synchronized (mutex) {"], [321, "                Document document = builder.parse(in);"], [322, "                response = (Response) responseClass.newInstance();"], [323, "                response.parse(document);"], [324, "            }"], [326, "        } catch (IllegalAccessException | SAXException | IOException | InstantiationException e) {"], [334, "     *"], [356, "     *"], [367, "     *  @param parameters"], [390, "     *"]]}, "num_lines_added": 48, "num_lines_removed": 67}