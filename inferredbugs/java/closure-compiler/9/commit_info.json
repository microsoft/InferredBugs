{"hash": "0d3b4994ebd199eb7dc76278c31656db9c2afb56", "message": "-Make RemoveUnusedVars know about goog.inherits\n\nR=nicksantos\nDELTA=135  (132 added, 0 deleted, 3 changed)\n\n\nRevision created by MOE tool push_codebase.\nMOE_MIGRATION=449\n\n\ngit-svn-id: https://closure-compiler.googlecode.com/svn/trunk@760 b0f006be-c8cd-11de-a2e8-8d36a3108c74", "file_num_lines": 542, "diff_parsed": {"added": [[25, "import com.google.javascript.jscomp.CodingConvention.SubclassRelationship;"], [73, "  private final CodingConvention codingConvention;"], [74, ""], [106, "   * Subclass name -> inherits call EXPR node."], [107, "   */"], [108, "  private final Multimap<Var, Node> inheritsCalls ="], [109, "      ArrayListMultimap.create();"], [110, ""], [111, "  /**"], [128, "    this.codingConvention = compiler.getCodingConvention();"], [139, "    Preconditions.checkState(compiler.getLifeCycleStage().isNormalized());"], [141, ""], [227, "      case Token.CALL:"], [228, "        // Look for calls to inheritance-defining calls (such as goog.inherits)."], [229, "        SubclassRelationship subclassRelationship ="], [230, "            codingConvention.getClassesDefinedByCall(n);"], [231, "        if (subclassRelationship != null) {"], [232, "          Var subclassVar = scope.getVar(subclassRelationship.subclassName);"], [233, "          if (!referenced.contains(subclassVar)) {"], [234, "            // Save a reference to the EXPR node."], [235, "            inheritsCalls.put(subclassVar, parent);"], [236, "            continuations.put(subclassVar, new Continuation(n, scope));"], [237, "            return;"], [238, "          }"], [239, "        }"], [240, "        break;"], [241, ""], [290, "    if (codingConvention.isExported(var.getName())) {"], [731, "      // If a subclass is referenced, mark its superclasses as referenced."], [742, "   * assignments to those variables as well."], [745, "    CodingConvention convention = codingConvention;"], [750, "      // Remove calls to inheritance-defining functions where the unreferenced"], [751, "      // class is the subclass."], [752, "      for (Node exprCallNode : inheritsCalls.get(var)) {"], [753, "        NodeUtil.removeChild(exprCallNode.getParent(), exprCallNode);"], [754, "        compiler.reportCodeChange();"], [755, "      }"], [756, ""]], "deleted": [[263, "    if (compiler.getCodingConvention().isExported(var.getName())) {"], [714, "   * assigments to those variables as well."], [717, "    CodingConvention convention = compiler.getCodingConvention();"]]}, "num_lines_added": 38, "num_lines_removed": 3}