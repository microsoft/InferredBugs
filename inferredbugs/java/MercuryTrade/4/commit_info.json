{"hash": "60b9ececf9917e211b11f24b821504c30bc9db7b", "message": "Refactoring config manager, fixed game path seracher, now if game path will be automatically found, will be called GamePathChooser", "file_num_lines": 289, "diff_parsed": {"added": [[20, "@SuppressWarnings(\"unchecked\")"], [36, "    private Map<String,FrameSettings> defaultFramesSettings;"], [37, "    private Map<String,Object> defaultAppSettings;"], [39, "    private WhisperNotifierStatus whisperNotifier = WhisperNotifierStatus.ALWAYS;"], [40, "    private int decayTime = 0;"], [41, "    private int minOpacity = 100;"], [42, "    private int maxOpacity = 100;"], [43, "    private String gamePath = \"\";"], [45, "    private boolean showPatchNotes = false;"], [46, "    private boolean showOnStartUp = true;"], [49, "        defaultFramesSettings = new HashMap<>();"], [50, "        defaultFramesSettings.put(\"TaskBarFrame\",new FrameSettings(new Point(400, 500),new Dimension(109,20)));"], [51, "        defaultFramesSettings.put(\"IncMessageFrame\",new FrameSettings(new Point(700, 600),new Dimension(280,0)));"], [52, "        defaultFramesSettings.put(\"OutMessageFrame\",new FrameSettings(new Point(200, 500),new Dimension(280,115)));"], [53, "        defaultFramesSettings.put(\"TestCasesFrame\",new FrameSettings(new Point(1400, 500),new Dimension(400,100)));"], [54, "        defaultFramesSettings.put(\"SettingsFrame\",new FrameSettings(new Point(600, 600),new Dimension(540,100)));"], [55, "        defaultFramesSettings.put(\"HistoryFrame\",new FrameSettings(new Point(600, 500),new Dimension(280,400)));"], [56, "        defaultFramesSettings.put(\"TimerFrame\",new FrameSettings(new Point(400, 600),new Dimension(240,102)));"], [57, "        defaultFramesSettings.put(\"ChatFilterFrame\",new FrameSettings(new Point(400, 600),new Dimension(200,100)));"], [58, "        defaultFramesSettings.put(\"ItemsGridFrame\",new FrameSettings(new Point(12, 79),new Dimension(641,718)));"], [59, "        defaultFramesSettings.put(\"NotesFrame\",new FrameSettings(new Point(400, 600),new Dimension(540,100)));"], [60, "        defaultFramesSettings.put(\"SetUpLocationFrame\",new FrameSettings(new Point(400, 600),new Dimension(240,30)));"], [61, "        defaultFramesSettings.put(\"ChunkMessagesPicker\",new FrameSettings(new Point(400, 600),new Dimension(240,30)));"], [62, "        defaultFramesSettings.put(\"GamePathChooser\",new FrameSettings(new Point(400, 600),new Dimension(520,30)));"], [63, ""], [77, "        minimumFrameSize.put(\"GamePathChooser\",new Dimension(600,30));"], [78, ""], [79, "        defaultAppSettings = new HashMap<>();"], [80, "        defaultAppSettings.put(\"decayTime\",0);"], [81, "        defaultAppSettings.put(\"minOpacity\",100);"], [82, "        defaultAppSettings.put(\"maxOpacity\",100);"], [83, "        defaultAppSettings.put(\"showOnStartUp\",true);"], [84, "        defaultAppSettings.put(\"showPatchNotes\",false);"], [85, "        defaultAppSettings.put(\"whisperNotifier\",WhisperNotifierStatus.ALWAYS);"], [86, "        defaultAppSettings.put(\"gamePath\",\"\");"], [87, ""], [113, ""], [114, "                saveProperty(\"decayTime\",String.valueOf(defaultAppSettings.get(\"decayTime\")));"], [115, "                saveProperty(\"minOpacity\",String.valueOf(defaultAppSettings.get(\"minOpacity\")));"], [116, "                saveProperty(\"maxOpacity\",String.valueOf(defaultAppSettings.get(\"maxOpacity\")));"], [117, "                saveProperty(\"showOnStartUp\",String.valueOf(defaultAppSettings.get(\"showOnStartUp\")));"], [118, "                saveProperty(\"showPatchNotes\",String.valueOf(defaultAppSettings.get(\"showPatchNotes\")));"], [119, "                saveProperty(\"gamePath\",gamePath);"], [120, "                saveProperty(\"whisperNotifier\", defaultAppSettings.get(\"whisperNotifier\").toString());"], [151, "            whisperNotifier = WhisperNotifierStatus.valueOf(loadProperty(\"whisperNotifier\"));"], [152, "            decayTime = Long.valueOf(loadProperty(\"decayTime\")).intValue();"], [153, "            minOpacity = Long.valueOf(loadProperty(\"minOpacity\")).intValue();"], [154, "            maxOpacity = Long.valueOf(loadProperty(\"maxOpacity\")).intValue();"], [155, "            showOnStartUp = Boolean.valueOf(loadProperty(\"showOnStartUp\"));"], [156, "            showPatchNotes = Boolean.valueOf(loadProperty(\"showPatchNotes\"));"], [157, "            gamePath = loadProperty(\"gamePath\");"], [163, "    private void saveFrameSettings(){"], [164, "        JSONArray frames = new JSONArray();"], [165, "        cachedFramesSettings.forEach((frameName,frameSettings)->{"], [166, "            JSONObject object = new JSONObject();"], [167, "            JSONObject location = new JSONObject();"], [168, "            location.put(\"frameX\",frameSettings.getFrameLocation().x);"], [169, "            location.put(\"frameY\",frameSettings.getFrameLocation().y);"], [170, ""], [171, "            JSONObject size = new JSONObject();"], [172, "            size.put(\"width\",frameSettings.getFrameSize().width);"], [173, "            size.put(\"height\",frameSettings.getFrameSize().height);"], [174, ""], [175, "            object.put(\"location\",location);"], [176, "            object.put(\"size\",size);"], [177, "            object.put(\"frameClassName\", frameName);"], [178, ""], [179, "            frames.add(object);"], [180, "        });"], [181, ""], [182, "        saveProperty(\"framesSettings\",frames);"], [183, "    }"], [184, "    private String loadProperty(String key){"], [185, "        JSONParser parser = new JSONParser();"], [186, "        try {"], [187, "            JSONObject root = (JSONObject) parser.parse(new FileReader(CONFIG_FILE));"], [188, "            Object object = root.get(key);"], [189, "            if(object != null){"], [190, "                return (String) object;"], [191, "            }else {"], [192, "                return String.valueOf(defaultAppSettings.get(key));"], [193, "            }"], [194, "        }catch (Exception e){"], [195, "            logger.error(\"Error while loading property: \" + key,e);"], [196, "        }"], [197, "        return null;"], [198, "    }"], [199, "    private  <T> void saveProperty(String token, T object){"], [200, "        JSONParser parser = new JSONParser();"], [201, "        try {"], [202, "            JSONObject root = (JSONObject) parser.parse(new FileReader(CONFIG_FILE));"], [203, "            Object obj = root.get(token);"], [204, "            if(obj != null){"], [205, "                root.replace(token,object);"], [206, "            }else {"], [207, "                root.put(token,object);"], [208, "            }"], [209, "            FileWriter fileWriter = new FileWriter(CONFIG_FILE);"], [210, "            fileWriter.write(root.toJSONString());"], [211, "            fileWriter.flush();"], [212, "            fileWriter.close();"], [213, "        } catch (Exception e) {"], [214, "            logger.error(\"Error in ConfigManager.saveProperty\",e);"], [215, "        }"], [216, ""], [217, "    }"], [275, "    public String getGamePath(){"], [276, "        return gamePath;"], [277, "    }"], [285, "    public void setDecayTime(int decayTime) {"], [286, "        this.decayTime = decayTime;"], [287, "        saveProperty(\"decayTime\", String.valueOf(this.decayTime));"], [288, "    }"], [289, "    public void setMinOpacity(int minOpacity) {"], [290, "        this.minOpacity = minOpacity;"], [291, "        saveProperty(\"minOpacity\", String.valueOf(this.minOpacity));"], [292, "    }"], [293, "    public void setMaxOpacity(int maxOpacity) {"], [294, "        this.maxOpacity = maxOpacity;"], [295, "        saveProperty(\"maxOpacity\", String.valueOf(this.maxOpacity));"], [296, "    }"], [297, "    public void setShowPatchNotes(boolean showPatchNotes) {"], [298, "        this.showPatchNotes = showPatchNotes;"], [299, "        saveProperty(\"showPatchNotes\", String.valueOf(this.showPatchNotes));"], [300, "    }"], [301, "    public void setShowOnStartUp(boolean showOnStartUp) {"], [302, "        this.showOnStartUp = showOnStartUp;"], [303, "        saveProperty(\"showOnStartUp\", String.valueOf(this.showOnStartUp));"], [304, "    }"], [305, "    public void setWhisperNotifier(WhisperNotifierStatus whisperNotifier) {"], [306, "        this.whisperNotifier = whisperNotifier;"], [307, "        saveProperty(\"whisperNotifier\", whisperNotifier.toString());"], [308, "    }"], [309, "    public void setGamePath(String gamePath){"], [310, "        this.gamePath = gamePath;"], [311, "        saveProperty(\"gamePath\",gamePath);"], [312, "    }"], [313, ""], [323, "        return defaultFramesSettings;"], [328, "    public boolean isValidGamePath(String gamePath){"], [329, "        File file = new File(gamePath + File.separator + \"logs\" + File.separator + \"Client.txt\");"], [330, "        return file.exists();"], [331, "    }"]], "deleted": [[36, "    private WhisperNotifierStatus whisperNotifier;"], [37, "    private int decayTime;"], [38, "    private int minOpacity;"], [39, "    private int maxOpacity;"], [41, "    private boolean showPatchNotes;"], [42, "    private boolean showOnStartUp;"], [58, "        minimumFrameSize.put(\"GamePathChooser\",new Dimension(150,30));"], [84, "                setWhisperNotifier(WhisperNotifierStatus.ALWAYS);"], [85, "                decayTime = 0;"], [86, "                minOpacity = 100;"], [87, "                maxOpacity = 100;"], [88, "                showOnStartUp = true;"], [89, "                showPatchNotes = false;"], [90, "                saveProperty(\"decayTime\",decayTime);"], [91, "                saveProperty(\"minOpacity\",minOpacity);"], [92, "                saveProperty(\"maxOpacity\",maxOpacity);"], [93, "                saveProperty(\"showOnStartUp\",showOnStartUp);"], [94, "                saveProperty(\"showPatchNotes\",showPatchNotes);"], [125, "            whisperNotifier = WhisperNotifierStatus.valueOf((String)root.get(\"whisperNotifier\"));"], [126, "            decayTime = ((Long)root.get(\"decayTime\")).intValue();"], [127, "            minOpacity = ((Long)root.get(\"minOpacity\")).intValue();"], [128, "            maxOpacity = ((Long)root.get(\"maxOpacity\")).intValue();"], [129, "            showOnStartUp = (boolean) root.get(\"showOnStartUp\");"], [130, "            showPatchNotes = (boolean) root.get(\"showPatchNotes\");"], [181, "    private void saveFrameSettings(){"], [182, "        JSONArray frames = new JSONArray();"], [183, "        cachedFramesSettings.forEach((frameName,frameSettings)->{"], [184, "            JSONObject object = new JSONObject();"], [185, "            JSONObject location = new JSONObject();"], [186, "            location.put(\"frameX\",frameSettings.getFrameLocation().x);"], [187, "            location.put(\"frameY\",frameSettings.getFrameLocation().y);"], [188, ""], [189, "            JSONObject size = new JSONObject();"], [190, "            size.put(\"width\",frameSettings.getFrameSize().width);"], [191, "            size.put(\"height\",frameSettings.getFrameSize().height);"], [192, ""], [193, "            object.put(\"location\",location);"], [194, "            object.put(\"size\",size);"], [195, "            object.put(\"frameClassName\", frameName);"], [196, ""], [197, "            frames.add(object);"], [198, "        });"], [199, ""], [200, "        saveProperty(\"framesSettings\",frames);"], [201, "    }"], [202, "    public <T> void saveProperty(String token, T object){"], [203, "        JSONParser parser = new JSONParser();"], [204, "        try {"], [205, "            JSONObject root = (JSONObject) parser.parse(new FileReader(CONFIG_FILE));"], [206, "            Object obj = root.get(token);"], [207, "            if(obj != null){"], [208, "                root.replace(token,object);"], [209, "            }else {"], [210, "                root.put(token,object);"], [211, "            }"], [212, "            FileWriter fileWriter = new FileWriter(CONFIG_FILE);"], [213, "            fileWriter.write(root.toJSONString());"], [214, "            fileWriter.flush();"], [215, "            fileWriter.close();"], [216, "        } catch (Exception e) {"], [217, "            logger.error(\"Error in ConfigManager.saveProperty\",e);"], [218, "        }"], [219, ""], [220, "    }"], [221, ""], [225, ""], [226, "    public void setWhisperNotifier(WhisperNotifierStatus whisperNotifier) {"], [227, "        this.whisperNotifier = whisperNotifier;"], [228, "        saveProperty(\"whisperNotifier\", whisperNotifier.toString());"], [229, "    }"], [230, ""], [234, ""], [238, ""], [242, ""], [259, "        Map<String,FrameSettings> dFramesSettings = new HashMap<>();"], [260, "        dFramesSettings.put(\"TaskBarFrame\",new FrameSettings(new Point(400, 500),new Dimension(109,20)));"], [261, "        dFramesSettings.put(\"IncMessageFrame\",new FrameSettings(new Point(700, 600),new Dimension(280,0)));"], [262, "        dFramesSettings.put(\"OutMessageFrame\",new FrameSettings(new Point(200, 500),new Dimension(280,115)));"], [263, "        dFramesSettings.put(\"TestCasesFrame\",new FrameSettings(new Point(1400, 500),new Dimension(400,100)));"], [264, "        dFramesSettings.put(\"SettingsFrame\",new FrameSettings(new Point(600, 600),new Dimension(540,100)));"], [265, "        dFramesSettings.put(\"HistoryFrame\",new FrameSettings(new Point(600, 500),new Dimension(280,400)));"], [266, "        dFramesSettings.put(\"TimerFrame\",new FrameSettings(new Point(400, 600),new Dimension(240,102)));"], [267, "        dFramesSettings.put(\"ChatFilterFrame\",new FrameSettings(new Point(400, 600),new Dimension(200,100)));"], [268, "        dFramesSettings.put(\"ItemsGridFrame\",new FrameSettings(new Point(12, 79),new Dimension(641,718)));"], [269, "        dFramesSettings.put(\"NotesFrame\",new FrameSettings(new Point(400, 600),new Dimension(540,100)));"], [270, "        dFramesSettings.put(\"SetUpLocationFrame\",new FrameSettings(new Point(400, 600),new Dimension(240,30)));"], [271, "        dFramesSettings.put(\"ChunkMessagesPicker\",new FrameSettings(new Point(400, 600),new Dimension(240,30)));"], [272, "        dFramesSettings.put(\"GamePathChooser\",new FrameSettings(new Point(400, 600),new Dimension(150,30)));"], [273, "        return dFramesSettings;"]]}, "num_lines_added": 143, "num_lines_removed": 89}