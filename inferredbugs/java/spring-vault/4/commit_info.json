{"hash": "1653439c71d646b07fd25ae958962f9db3f91a4d", "message": "Omit Vault namespace header for sys/init and sys/health endpoints\n\nWe now no longer add the default namespace header when issuing requests to opsForSys().init()/health().\n\nCloses gh-534.", "file_num_lines": 442, "diff_parsed": {"added": [[35, "import org.springframework.http.HttpHeaders;"], [43, "import org.springframework.vault.client.VaultHttpHeaders;"], [104, "\t\treturn requireResponse(vaultOperations.doWithSession(restOperations -> {"], [107, "\t\t\t\tResponseEntity<Map<String, Boolean>> body = (ResponseEntity) restOperations"], [108, "\t\t\t\t\t\t.exchange(\"sys/init\", HttpMethod.GET, emptyNamespace(null),"], [109, "\t\t\t\t\t\t\t\tMap.class);"], [111, "\t\t\t\tAssert.state(body.getBody() != null,"], [112, "\t\t\t\t\t\t\"Initialization response must not be null\");"], [114, "\t\t\t\treturn body.getBody().get(\"initialized\");"], [134, "\t\t\t\t\t\t\t\temptyNamespace(vaultInitializationRequest),"], [395, "\tprivate static <T> HttpEntity<T> emptyNamespace(@Nullable T body) {"], [396, "\t\tHttpHeaders headers = new HttpHeaders();"], [397, "\t\theaders.add(VaultHttpHeaders.VAULT_NAMESPACE, \"\");"], [398, "\t\treturn new HttpEntity<>(body, headers);"], [399, "\t}"], [400, ""], [408, "\t\t\t\t\t\t\"sys/health\", HttpMethod.GET, emptyNamespace(null),"], [409, "\t\t\t\t\t\tVaultHealthImpl.class);"]], "deleted": [[102, "\t\treturn requireResponse(vaultOperations.doWithVault(restOperations -> {"], [105, "\t\t\t\tMap<String, Boolean> body = restOperations.getForObject(\"sys/init\","], [106, "\t\t\t\t\t\tMap.class);"], [108, "\t\t\t\tAssert.state(body != null, \"Initialization response must not be null\");"], [110, "\t\t\t\treturn body.get(\"initialized\");"], [130, "\t\t\t\t\t\t\t\tnew HttpEntity<Object>(vaultInitializationRequest),"], [398, "\t\t\t\t\t\t\"sys/health\", HttpMethod.GET, null, VaultHealthImpl.class);"]]}, "num_lines_added": 18, "num_lines_removed": 7}