{"bug_class": "PROVER", "kind": "ERROR", "bug_type": "NULL_DEREFERENCE", "qualifier": "object returned by `principal.getRole()` could be null and is dereferenced at line 108.", "severity": "HIGH", "visibility": "user", "line": 108, "column": -1, "procedure": "Response DeviceResourceImpl.get(String)", "procedure_id": "com.devicehive.resource.impl.DeviceResourceImpl.get(java.lang.String):javax.ws.rs.core.Response.d968a5dd406a4e6711cb0435d4a845d4", "procedure_start_line": 102, "file": "src/main/java/com/devicehive/resource/impl/DeviceResourceImpl.java", "bug_trace": [{"level": 0, "filename": "src/main/java/com/devicehive/resource/impl/DeviceResourceImpl.java", "line_number": 102, "column_number": -1, "description": "start of procedure get(...)"}, {"level": 0, "filename": "src/main/java/com/devicehive/resource/impl/DeviceResourceImpl.java", "line_number": 104, "column_number": -1, "description": ""}, {"level": 0, "filename": "src/main/java/com/devicehive/resource/impl/DeviceResourceImpl.java", "line_number": 106, "column_number": -1, "description": ""}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 333, "column_number": -1, "description": "start of procedure getDeviceWithNetworkAndDeviceClass(...)"}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 335, "column_number": -1, "description": ""}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 404, "column_number": -1, "description": "start of procedure getAllowedDevicesCount(...)"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 405, "column_number": -1, "description": ""}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 93, "column_number": -1, "description": "start of procedure criteriaBuilder()"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 94, "column_number": -1, "description": "return from a call to CriteriaBuilder GenericDAO.criteriaBuilder()"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 406, "column_number": -1, "description": "Skipping createQuery(...): unknown method"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 407, "column_number": -1, "description": "Skipping from(...): unknown method"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 408, "column_number": -1, "description": ""}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 147, "column_number": -1, "description": "start of procedure deviceListPredicates(...)"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 151, "column_number": -1, "description": "Skipping deviceSpecificPrincipalPredicates(...): empty list of specs"}, {"level": 4, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 205, "column_number": -1, "description": "Definition of deviceSpecificPrincipalPredicates(...)"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 152, "column_number": -1, "description": "Taking true branch"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 152, "column_number": -1, "description": "Taking true branch"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 153, "column_number": -1, "description": "Skipping add(...): unknown method"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/CriteriaHelper.java", "line_number": 156, "column_number": -1, "description": "return from a call to javax.persistence.criteria.Predicate[] CriteriaHelper.deviceListPredicates(CriteriaBuilder,Root,List,Optional)"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 409, "column_number": -1, "description": "Skipping where(...): unknown method"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 410, "column_number": -1, "description": ""}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 98, "column_number": -1, "description": "start of procedure createQuery(...)"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 98, "column_number": -1, "description": "return from a call to TypedQuery GenericDAO.createQuery(CriteriaQuery)"}, {"level": 2, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 411, "column_number": -1, "description": "return from a call to long DeviceService.getAllowedDevicesCount(HivePrincipal,List)"}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 335, "column_number": -1, "description": "Taking false branch"}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 340, "column_number": -1, "description": ""}, {"level": 2, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 70, "column_number": -1, "description": "start of procedure createNamedQuery(...)"}, {"level": 2, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 71, "column_number": -1, "description": ""}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 81, "column_number": -1, "description": "start of procedure cacheQuery(...)"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 82, "column_number": -1, "description": "Taking false branch"}, {"level": 3, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 87, "column_number": -1, "description": "return from a call to void GenericDAO.cacheQuery(Query,Optional)"}, {"level": 2, "filename": "src/main/java/com/devicehive/dao/GenericDAO.java", "line_number": 72, "column_number": -1, "description": "return from a call to TypedQuery GenericDAO.createNamedQuery(Class,String,Optional)"}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 341, "column_number": -1, "description": "Skipping setParameter(...): unknown method"}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 342, "column_number": -1, "description": ""}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 343, "column_number": -1, "description": ""}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 345, "column_number": -1, "description": "Taking false branch"}, {"level": 1, "filename": "src/main/java/com/devicehive/service/DeviceService.java", "line_number": 349, "column_number": -1, "description": "return from a call to Device DeviceService.getDeviceWithNetworkAndDeviceClass(String,HivePrincipal)"}, {"level": 0, "filename": "src/main/java/com/devicehive/resource/impl/DeviceResourceImpl.java", "line_number": 108, "column_number": -1, "description": ""}, {"level": 1, "filename": "src/main/java/com/devicehive/auth/HivePrincipal.java", "line_number": 81, "column_number": -1, "description": "start of procedure getRole()"}, {"level": 1, "filename": "src/main/java/com/devicehive/auth/HivePrincipal.java", "line_number": 82, "column_number": -1, "description": "Taking false branch"}, {"level": 1, "filename": "src/main/java/com/devicehive/auth/HivePrincipal.java", "line_number": 85, "column_number": -1, "description": "Taking false branch"}, {"level": 1, "filename": "src/main/java/com/devicehive/auth/HivePrincipal.java", "line_number": 88, "column_number": -1, "description": "Taking false branch"}, {"level": 1, "filename": "src/main/java/com/devicehive/auth/HivePrincipal.java", "line_number": 91, "column_number": -1, "description": "Taking false branch"}, {"level": 1, "filename": "src/main/java/com/devicehive/auth/HivePrincipal.java", "line_number": 94, "column_number": -1, "description": "return from a call to String HivePrincipal.getRole()"}, {"level": 0, "filename": "src/main/java/com/devicehive/resource/impl/DeviceResourceImpl.java", "line_number": 108, "column_number": -1, "description": ""}], "key": "DeviceResourceImpl.java|get|NULL_DEREFERENCE", "node_key": "18086a76ec6f499138a84f176568ec09", "hash": "d87d016b1acd587b2b134fe8fe1b4bc8", "bug_type_hum": "Null Dereference", "censored_reason": ""}