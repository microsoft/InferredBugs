{"hash": "3a69c44f04cddb728299c0149df03987cafefbf9", "message": "checking access key permissions is a bit refactored", "file_num_lines": 196, "diff_parsed": {"added": [[7, "import com.devicehive.dao.AccessKeyDAO;"], [10, "import com.devicehive.model.*;"], [12, "import com.devicehive.util.ThreadLocalVariablesKeeper;"], [13, "import com.google.common.collect.Sets;"], [39, "    private AccessKeyDAO accessKeyDAO;"], [40, "    @EJB"], [65, "            AccessKey currentKey = accessKeyDAO.getWithoutUser(user.getId(), key.getId());"], [66, "            Set<AccessKeyPermission> filtered = CheckPermissionsHelper.filterPermissions(key.getPermissions(), AllowedKeyAction.Action.GET_DEVICE, ThreadLocalVariablesKeeper.getClientIP(), ThreadLocalVariablesKeeper.getHostName());"], [67, "            if (filtered.isEmpty()) {"]], "deleted": [[9, "import com.devicehive.model.AccessKey;"], [10, "import com.devicehive.model.Device;"], [11, "import com.devicehive.model.Network;"], [12, "import com.devicehive.model.NullableWrapper;"], [13, "import com.devicehive.model.User;"], [64, "            key = accessKeyService.find(key.getId(), principal.getKey().getUser().getId());"], [65, "            if (!CheckPermissionsHelper.checkAllPermissions(key, AllowedKeyAction.Action.GET_DEVICE)) {"]]}, "num_lines_added": 9, "num_lines_removed": 7}