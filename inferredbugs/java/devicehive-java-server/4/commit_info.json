{"hash": "29b0f7578b67ea573476274a4e308298524e9b4c", "message": "Rest Auth fix", "file_num_lines": 42, "diff_parsed": {"added": [[37, "            if (requestContext.getSecurityContext().isUserInRole(role)) {"], [41, ""], [42, "        boolean isOauth = Constants.OAUTH_AUTH_SCEME.equals(requestContext.getSecurityContext().getAuthenticationScheme());"], [43, ""], [44, "        requestContext.abortWith(Response"], [45, "                            .status(Response.Status.UNAUTHORIZED)"], [46, "                            .header(HttpHeaders.WWW_AUTHENTICATE, isOauth ? Messages.OAUTH_REALM : Messages.BASIC_REALM)"], [47, "                            .entity(Messages.NOT_AUTHORIZED)"], [48, "                            .build());"]], "deleted": [[36, "        BeanManager beanManager = CDI.current().getBeanManager();"], [37, "        Context requestScope = beanManager.getContext(RequestScoped.class);"], [38, "        HiveSecurityContext hiveSecurityContext = null;"], [39, "        for (Bean<?> bean : beanManager.getBeans(HiveSecurityContext.class)) {"], [40, "            if (requestScope.get(bean) != null) {"], [41, "                hiveSecurityContext = (HiveSecurityContext) requestScope.get(bean);"], [42, "            }"], [43, "        }"], [45, "            if (hiveSecurityContext.isUserInRole(role)) {"], [49, "        HivePrincipal hivePrincipal = hiveSecurityContext.getHivePrincipal();"], [50, "        if (hivePrincipal != null && hivePrincipal.getKey() != null) {"], [51, "            requestContext.abortWith(Response"], [52, "                    .status(Response.Status.UNAUTHORIZED)"], [53, "                    .header(HttpHeaders.AUTHORIZATION, Messages.OAUTH_REALM)"], [54, "                    .entity(Messages.NOT_AUTHORIZED)"], [55, "                    .build());"], [56, "        } else {"], [57, "            requestContext.abortWith(Response"], [58, "                    .status(Response.Status.UNAUTHORIZED)"], [59, "                    .header(HttpHeaders.AUTHORIZATION, Messages.BASIC_REALM)"], [60, "                    .entity(Messages.NOT_AUTHORIZED)"], [61, "                    .build());"], [62, "        }"]]}, "num_lines_added": 9, "num_lines_removed": 23}