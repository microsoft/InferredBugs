{"hash": "ea9bb62f3169b7a1864cfe4ba7d64309e12ab2a1", "message": "notification/subscribe, notification/unsubscribe", "file_num_lines": 276, "diff_parsed": {"added": [[17, "import com.devicehive.websockets.messagebus.ServerResponsesFactory;"], [24, "import com.google.gson.JsonParseException;"], [30, "import javax.transaction.Transactional;"], [127, "        Date timestamp;"], [128, "        try {"], [129, "            timestamp = gson.fromJson(message.get(JsonMessageBuilder.TIMESTAMP), Date.class);"], [130, "        } catch (JsonParseException e) {"], [131, "            throw new HiveException(e.getCause().getMessage() + \" Date must be in format \\\"yyyy-MM-dd HH:mm:ss\" +"], [132, "                    \".SSS\\\"\", e);"], [133, "        }"], [134, "        if (timestamp == null){"], [135, "            timestamp = new Date();"], [142, "            processNotificationSubscribeNullCase(session, timestamp);"], [144, "            processNotificationSubscribeNotNullCase(list, session, timestamp);"], [152, "    @Transactional"], [153, "    public void processNotificationSubscribeNullCase(Session session, Date timestamp) {"], [180, "                    WebsocketSession.addMessagesToQueue(session,"], [181, "                            ServerResponsesFactory.createNotificationInsertMessage(deviceNotification));"], [192, "    @Transactional"], [193, "    public void processNotificationSubscribeNotNullCase(List<UUID> guids, Session session, Date timestamp) {"], [223, "                    WebsocketSession.addMessagesToQueue(session,"], [224, "                            ServerResponsesFactory.createNotificationInsertMessage(deviceNotification));"], [231, ""], [233, ""], [247, "                logger.debug(\"notification/unsubscribe. found \" + devices.size() +"], [248, "                        \" devices. \" + \"Session \" + session.getId());"]], "deleted": [[124, "        Date timestamp = gson.fromJson(message.get(JsonMessageBuilder.TIMESTAMP), Date.class);"], [125, "        if (timestamp == null) {"], [126, "            timestamp = new Date(System.currentTimeMillis());"], [133, "            processNotificationSubscribeNullCase(session, timestamp, gson);"], [135, "            processNotificationSubscribeNotNullCase(list, session, timestamp, gson);"], [137, ""], [138, ""], [145, "    private void processNotificationSubscribeNullCase(Session session, Date timestamp, Gson gson) {"], [172, "                    WebsocketSession.addMessagesToQueue(session, gson.toJsonTree(deviceNotification,"], [173, "                            DeviceNotification.class));"], [184, "    private void processNotificationSubscribeNotNullCase(List<UUID> guids, Session session,"], [185, "                                                         Date timestamp, Gson gson) {"], [215, "                    WebsocketSession.addMessagesToQueue(session, gson.toJsonTree(deviceNotification,"], [216, "                            DeviceNotification.class));"], [237, ""], [239, "            logger.debug(\"notification/unsubscribe. found \" + devices.size() +"], [240, "                    \" devices. \" + \"Session \" + session.getId());"]]}, "num_lines_added": 26, "num_lines_removed": 17}