{"hash": "b10c781d1a10aa2f84b71086091ef773451427ce", "message": "LanguageIdDriver uses Behemoth reducer and can filter output", "file_num_lines": 105, "diff_parsed": {"added": [[47, "import com.digitalpebble.behemoth.BehemothReducer;"], [80, "\t\toptions.addOption(\"w\", \"overwrite\", false, \"overwrite the output\");"], [85, "\t\tboolean overWrite = false;"], [86, ""], [103, "\t\t\tif (cmdLine.hasOption(\"overwrite\")) {"], [104, "\t\t\t\toverWrite = true;"], [105, "\t\t\t}"], [109, ""], [111, "\t\tif (fs.exists(outputPath)) {"], [112, "\t\t\tif (!overWrite) {"], [113, "\t\t\t\tSystem.out.println(\"Output path \" + outputPath"], [114, "\t\t\t\t\t\t+ \" already exists. Use option -w to overwrite.\");"], [115, "\t\t\t\treturn 0;"], [116, "\t\t\t} else"], [117, "\t\t\t\tfs.delete(outputPath, true);"], [135, "\t\t// TODO make this optional based on presence of parameters"], [136, "\t\tjob.setReducerClass(BehemothReducer.class);"]], "deleted": [[102, ""], [104, "\t\tif (fs.exists(outputPath)){"], [105, "\t\t\t  System.out.println(\"Output path \"+outputPath + \" already exists. Overwrite [y/n]?\");"], [106, "\t\t\t  InputStreamReader inp = new InputStreamReader(System.in);"], [107, "\t\t\t  BufferedReader br = new BufferedReader(inp);"], [108, "\t\t\t  String str = br.readLine();"], [109, "\t\t\t  br.close();"], [110, "\t\t\t  if (str.equals(\"y\")){"], [111, "\t\t\t\t  fs.delete(outputPath, true);"], [112, "\t\t\t  }"], [113, "\t\t\t  else return 0;"], [131, "\t\tjob.setNumReduceTasks(0);"]]}, "num_lines_added": 17, "num_lines_removed": 12}