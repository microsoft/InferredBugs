{"hash": "a5e618b56ac69c6ea5e0b9afcd3ce502bf5e472e", "message": "Solve the synchronization problem in case we have thrown exception in\nconnect/disconnect methods", "file_num_lines": 378, "diff_parsed": {"added": [[110, "\t\ttry {"], [111, "\t\t\tsynchronized (this) {"], [112, "\t\t\t\tif (LOG.isLoggable(Level.FINE)) {"], [113, "\t\t\t\t\tLOG.log(Level.FINE, \"Start connect session\");"], [114, "\t\t\t\t}"], [115, "\t\t\t\tblockedByRunUpOperation = true;"], [116, ""], [117, "\t\t\t\tconnect(false);"], [118, ""], [119, "\t\t\t\tblockedByRunUpOperation = false;"], [120, ""], [121, "\t\t\t\tif (LOG.isLoggable(Level.FINER)) {"], [122, "\t\t\t\t\tLOG.log(Level.FINER, \"End connect session\");"], [123, "\t\t\t\t}"], [124, ""], [125, "\t\t\t}"], [126, "\t\t} catch (IOException e) {"], [127, "\t\t\tblockedByRunUpOperation = false;"], [128, "\t\t\tthrow e;"], [129, "\t\t} catch (InterruptedException e) {"], [130, "\t\t\tblockedByRunUpOperation = false;"], [131, "\t\t\tthrow e;"], [132, "\t\t} catch (ServiceLocatorException e) {"], [133, "\t\t\tblockedByRunUpOperation = false;"], [134, "\t\t\tthrow e;"], [135, "\t\t} catch (Exception e) {"], [136, "\t\t\tblockedByRunUpOperation = false;"], [137, "\t\t\tif (LOG.isLoggable(Level.SEVERE)) {"], [138, "\t\t\t\tLOG.log(Level.SEVERE, \"Connect not passed: \" + e.getMessage());"], [139, "\t\t\t}"], [140, "\t\t}"], [141, ""], [144, "\tprivate void connect(boolean immediately) throws IOException,"], [146, "\t\tdisconnect(immediately);"], [175, "\t\ttry {"], [176, "\t\t\tsynchronized (this) {"], [177, "\t\t\t\tif (LOG.isLoggable(Level.FINE)) {"], [178, "\t\t\t\t\tLOG.log(Level.FINE, \"Start disconnect session\");"], [179, "\t\t\t\t}"], [180, ""], [181, "\t\t\t\tblockedByRunUpOperation = true;"], [182, ""], [183, "\t\t\t\tdisconnect(false);"], [184, ""], [185, "\t\t\t\tblockedByRunUpOperation = false;"], [186, ""], [187, "\t\t\t\tif (LOG.isLoggable(Level.FINER)) {"], [188, "\t\t\t\t\tLOG.log(Level.FINER, \"End disconnect session\");"], [189, "\t\t\t\t}"], [190, "\t\t\t}"], [191, "\t\t} catch (InterruptedException e) {"], [192, "\t\t\tblockedByRunUpOperation = false;"], [193, "\t\t\tthrow e;"], [194, "\t\t} catch (ServiceLocatorException e) {"], [195, "\t\t\tblockedByRunUpOperation = false;"], [196, "\t\t\tthrow e;"], [197, "\t\t} catch (Exception e) {"], [198, "\t\t\tblockedByRunUpOperation = false;"], [199, "\t\t\tif (LOG.isLoggable(Level.SEVERE)) {"], [200, "\t\t\t\tLOG.log(Level.SEVERE, \"Connect not passed: \" + e.getMessage());"], [201, "\t\t\t}"], [202, "\t\t}"], [203, ""], [206, "\tprivate void disconnect(boolean immediately)"], [208, "\t\tif (businessOperations != 0 && !immediately) {"], [211, "\t\t\t\t if (LOG.isLoggable(Level.FINE)) {"], [212, "\t\t\t\t LOG.fine(\"Waiting \""], [213, "\t\t\t\t + waitingTimeout"], [214, "\t\t\t\t + \" ms for some business operations to complete its work\");"], [215, "\t\t\t\t }"], [217, "\t\t\t\t\tThread.sleep(1);"], [218, "\t\t\t\t\twaiting++;"]], "deleted": [[110, "\t\tconnect(false);"], [113, "\tsynchronized public void connect(boolean immediately) throws IOException,"], [115, "\t\tif (LOG.isLoggable(Level.FINE)) {"], [116, "\t\t\tLOG.log(Level.FINE, \"Start connect session\");"], [117, "\t\t}"], [118, "\t\tblockedByRunUpOperation = true;"], [119, "\t\tdisconnect(false, immediately);"], [132, "\t\tblockedByRunUpOperation = false;"], [133, ""], [134, "\t\tif (LOG.isLoggable(Level.FINER)) {"], [135, "\t\t\tLOG.log(Level.FINER, \"End connect session\");"], [136, "\t\t}"], [153, "\t\tdisconnect(true, false);"], [156, "\tsynchronized public void disconnect(boolean notify, boolean immediately)"], [158, "\t\tif (LOG.isLoggable(Level.FINE)) {"], [159, "\t\t\tLOG.log(Level.FINE, \"Start disconnect session\");"], [160, "\t\t}"], [161, "\t\tblockedByRunUpOperation = true;"], [162, "\t\tif (!immediately) {"], [165, "\t\t\t\tif (LOG.isLoggable(Level.FINE)) {"], [166, "\t\t\t\t\tLOG.fine(\"Waiting \""], [167, "\t\t\t\t\t\t\t+ waitingTimeout"], [168, "\t\t\t\t\t\t\t+ \" ms for some business operations to complete its work\");"], [169, "\t\t\t\t}"], [171, "\t\t\t\t\t\tThread.sleep(1);"], [172, "\t\t\t\t\t\twaiting++;"], [194, "\t\tif (notify) {"], [195, "\t\t\tblockedByRunUpOperation = false;"], [196, "\t\t}"], [197, "\t\tif (LOG.isLoggable(Level.FINER)) {"], [198, "\t\t\tLOG.log(Level.FINER, \"End disconnect session\");"], [199, "\t\t}"], [200, ""]]}, "num_lines_added": 72, "num_lines_removed": 33}