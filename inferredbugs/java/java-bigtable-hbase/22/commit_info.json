{"hash": "39cbdf9839cce7b3b4f8af547d8c0b8959168fad", "message": "Removing an NPE when auth token retrieval fails fast (#1651)\n\nAbstractRetryingOperation now uses a no-op Call to replace the notion of\r\n\"null\".\r\nWhen Auth fails, the interceptor immediately calls close, thereby\r\nsetting call to null.  RetryingReadRowsOperation broke in those\r\ncoditions.  I added a test to confirm this behavior before the fix, and\r\nthen retested with AbstractRetryingOperation.", "file_num_lines": 217, "diff_parsed": {"added": [[55, "  private class CallToStreamObserverAdapter extends ClientCallStreamObserver<ReadRowsRequest> {"], [59, "    public void onNext(ReadRowsRequest value) {"], [112, "  private CallToStreamObserverAdapter adapter;"], [149, "    adapter = new CallToStreamObserverAdapter();"], [157, "      lastResponseMs = clock.currentTimeMillis();"]], "deleted": [[35, "import io.grpc.ClientCall;"], [56, "  private static class CallToStreamObserverAdapter<T> extends ClientCallStreamObserver<T> {"], [57, "    private final ClientCall<T, ?> call;"], [60, "    public CallToStreamObserverAdapter(ClientCall<T, ?> call) {"], [61, "      this.call = call;"], [62, "    }"], [63, ""], [65, "    public void onNext(T value) {"], [118, "  private CallToStreamObserverAdapter<ReadRowsRequest> adapter;"], [154, "    lastResponseMs = clock.currentTimeMillis();"], [159, "      adapter = new CallToStreamObserverAdapter<ReadRowsRequest>(call);"]]}, "num_lines_added": 5, "num_lines_removed": 11}