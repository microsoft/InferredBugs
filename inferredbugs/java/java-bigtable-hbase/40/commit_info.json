{"hash": "a18d941684937f14db499b970931ce6258303138", "message": "RetryingReadRowsOperation uses more final variables (#1715)\n\n* RetryingReadRowsOperation uses more final variables\r\n- RowMerger is final and now has a reset method\r\n- CallToStreamObserverAdapter is now final, and use required no modification.\r\n\r\n* Adding better signals to RowMerger\r\n- renaming reset() to clearRowInProgress() to better communicate the intent of the method.\r\n- Adding isComplete() and isInNewState() for better communication of intent of the state of the RowMerger for testing purposes\r\n- RowMerger now only updates the rowInProgress and state when performning a reset\r\n- RetryingReadRowsOperation now properly sends onError\r\n- RowMerger clears row in progress when a retry request is being built.\r\n- fixing a typo in buildUpdatedRequst(\r\n- rowCountInLastMessage is now an Integer rather than an int so that it can express a non-initialized state better than -1.\r\n\r\n* Clarifying RetryingReadRowsOperationTest.testScanTimeoutSucceed.\r\n\r\n* Adding annotations, and moving methods around", "file_num_lines": 226, "diff_parsed": {"added": [[107, "  private final RowMerger rowMerger;"], [112, "  private final CallToStreamObserverAdapter adapter;"], [127, "    this.rowMerger = new RowMerger(rowObserver);"], [128, "    this.adapter = new CallToStreamObserverAdapter();"], [240, "    rowMerger.onError(exception);"], [313, "    buildUpdatedRequest();"], [318, "  ReadRowsRequest buildUpdatedRequest() {"], [319, "    this.rowMerger.clearRowInProgress();"]], "deleted": [[107, "  private RowMerger rowMerger;"], [112, "  private CallToStreamObserverAdapter adapter;"], [149, "      this.rowMerger = new RowMerger(rowObserver);"], [150, "      adapter = new CallToStreamObserverAdapter();"], [240, "    rowObserver.onError(exception);"], [241, "    // cleanup any state that was in RowMerger. There may be a partial row in progress which needs"], [242, "    // to be reset."], [243, "    rowMerger = new RowMerger(rowObserver);"], [316, "    buildUpdatedRequst();"], [321, "  ReadRowsRequest buildUpdatedRequst() {"]]}, "num_lines_added": 8, "num_lines_removed": 10}