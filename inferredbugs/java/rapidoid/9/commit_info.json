{"hash": "4dc1c9c170af6b6ff5dc782eaabfd32a9600a462", "message": "Implemented injection and persistence of session-scoped page fields.", "file_num_lines": 9, "diff_parsed": {"added": [[30, "\t\treturn Pages.emit(x);"]], "deleted": [[23, "import java.util.Map;"], [24, ""], [25, "import org.rapidoid.html.TagContext;"], [26, "import org.rapidoid.html.Tags;"], [29, "import org.rapidoid.pages.impl.PageRenderer;"], [30, "import org.rapidoid.util.U;"], [36, ""], [37, "\t\tint event = U.num(x.data(\"event\"));"], [38, ""], [39, "\t\tTagContext ctx = Pages.ctx(x);"], [40, ""], [41, "\t\tMap<Integer, Object> inp = Pages.inputs(x);"], [42, "\t\tctx.emit(inp, event);"], [43, ""], [44, "\t\tObject page = U.newInstance(currentPage(x));"], [45, ""], [46, "\t\tctx = Tags.context();"], [47, "\t\tx.setSession(Pages.SESSION_CTX, ctx);"], [48, ""], [49, "\t\tObject body = Pages.contentOf(x, page);"], [50, ""], [51, "\t\tif (body == null) {"], [52, ""], [53, "\t\t}"], [54, ""], [55, "\t\tif (body instanceof HttpExchange) {"], [56, "\t\t\treturn body;"], [57, "\t\t}"], [58, ""], [59, "\t\tSystem.out.println(body);"], [60, "\t\tString html = PageRenderer.get().toHTML(ctx, body, x);"], [61, ""], [62, "\t\tMap<String, String> changes = U.map();"], [63, "\t\tchanges.put(\"body\", html);"], [64, ""], [65, "\t\tx.json();"], [66, "\t\treturn changes;"], [67, "\t}"], [68, ""], [69, "\tprivate Class<?> currentPage(HttpExchange x) {"], [70, "\t\treturn x.session(Pages.SESSION_CURRENT_PAGE);"]]}, "num_lines_added": 1, "num_lines_removed": 41}