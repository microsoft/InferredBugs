{"hash": "878ba5ddc25f45a81e7443f1541e84b44b1fd3e1", "message": "Fix for POOL-137. Correct inconsistent synchronization.\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/pool/trunk@776074 13f79535-47bb-0310-9956-ffa450edef68", "file_num_lines": 642, "diff_parsed": {"added": [[929, "        byte whenExhaustedAction;"], [930, "        long maxWait;"], [932, "            // Get local copy of current config. Can't sync when used later as"], [933, "            // it can result in a deadlock. Has the added advantage that config"], [934, "            // is consistent for entire method execution"], [935, "            whenExhaustedAction = _whenExhaustedAction;"], [936, "            maxWait = _maxWait;"], [937, ""], [938, "            // Add this request to the queue"], [955, "                    switch(whenExhaustedAction) {"], [967, "                                    if(maxWait <= 0) {"], [973, "                                        final long waitTime = maxWait - elapsed;"], [984, "                            if(maxWait > 0 && ((System.currentTimeMillis() - starttime) >= maxWait)) {"], [990, "                            throw new IllegalArgumentException(\"WhenExhaustedAction property \" + whenExhaustedAction + \" not recognized.\");"]], "deleted": [[946, "                    switch(_whenExhaustedAction) {"], [958, "                                    if(_maxWait <= 0) {"], [964, "                                        final long waitTime = _maxWait - elapsed;"], [975, "                            if(_maxWait > 0 && ((System.currentTimeMillis() - starttime) >= _maxWait)) {"], [981, "                            throw new IllegalArgumentException(\"WhenExhaustedAction property \" + _whenExhaustedAction + \" not recognized.\");"]]}, "num_lines_added": 14, "num_lines_removed": 5}