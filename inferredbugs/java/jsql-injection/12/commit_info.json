{"hash": "2f2e1dfbbad96ba3bbcef946b6564e306801de5d", "message": "Various fixes following tests on Pentesterlab\n\n- Add Pentesterlab URLs\n- Add column metadata in Network tab to know purpose of URL calls\n- Fix Tomcat Cookie processor broken by Spring upgrade\n- Replace concat_ws() with plain concat for PostgreSQL < v9.1\n- Replace ending comment --+- with # for MySQL\n- Make tampering able to change outer SQL as well as inner SQL\n- Fix tamper x() => /*!x*/(), escape method substring()\n- Fix tamper x() => x/**/(), add additional escaping\n- Simplify tampers ' ' => #\\n, --\\n, /**/\n- Fix tamper random-case broken since Maven multimodule refactoring\n- Fix cleaning of comments like /*x*/", "file_num_lines": 132, "diff_parsed": {"added": [[108, "        // Transform only SQL query without HTTP parameters and syntax changed, like p=1'+[sql]"], [118, "        if (this.isEval) {"], [119, ""], [120, "            sqlQuery = eval(sqlQuery, this.customTamper);"], [121, "        }"], [122, ""], [123, "        if (this.isRandomCase) {"], [124, ""], [125, "            sqlQuery = eval(sqlQuery, TamperingType.RANDOM_CASE.instance().getJavascript());"], [126, "        }"], [127, ""], [128, "        if (this.isEqualToLike) {"], [129, ""], [130, "            sqlQuery = eval(sqlQuery, TamperingType.EQUAL_TO_LIKE.instance().getJavascript());"], [131, "        }"], [132, ""], [133, "        sqlQuery = lead + sqlQuery + trail;"], [134, ""], [135, "        sqlQuery = sqlQuery.replaceAll(\"(?i)<tampering>\", StringUtils.EMPTY);"], [136, "        sqlQuery = sqlQuery.replaceAll(\"(?i)</tampering>\", StringUtils.EMPTY);"], [137, ""], [143, ""], [144, "        // Transform all query, SQL and HTTP"]], "deleted": [[143, "        if (this.isEqualToLike) {"], [144, ""], [145, "            sqlQuery = eval(sqlQuery, TamperingType.EQUAL_TO_LIKE.instance().getJavascript());"], [146, "        }"], [147, ""], [162, "        if (this.isRandomCase) {"], [163, ""], [164, "            sqlQuery = eval(sqlQuery, TamperingType.RANDOM_CASE.instance().getJavascript());"], [165, "        }"], [166, ""], [167, "        if (this.isEval) {"], [168, ""], [169, "            sqlQuery = eval(sqlQuery, this.customTamper);"], [170, "        }"], [171, ""], [177, "        sqlQuery = lead + sqlQuery + trail;"], [178, ""], [185, "        // Problme si le tag contient des caractres spciaux"], [186, "        sqlQuery = sqlQuery.replaceAll(\"(?i)<tampering>\", StringUtils.EMPTY);"], [187, "        sqlQuery = sqlQuery.replaceAll(\"(?i)</tampering>\", StringUtils.EMPTY);"], [188, ""]]}, "num_lines_added": 23, "num_lines_removed": 21}