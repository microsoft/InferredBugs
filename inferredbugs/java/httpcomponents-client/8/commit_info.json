{"hash": "077281ba270427cab95491033ac2aae5eb195197", "message": "HTTPCLIENT-881: Methods mutating the internal state of the AbstractClientConnAdapter class and its subclasses made synchronized; ThreadSafeClientConnManager#releaseConnection method now synchronizes access to the BasicPooledConnAdapter instance\n\ngit-svn-id: https://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk@825999 13f79535-47bb-0310-9956-ffa450edef68", "file_num_lines": 180, "diff_parsed": {"added": [[223, "        synchronized (hca) {"], [225, "            if (entry == null) {"], [226, "                return;"], [228, "            try {"], [229, "                // make sure that the response has been read completely"], [230, "                if (hca.isOpen() && !hca.isMarkedReusable()) {"], [231, "                    // In MTHCM, there would be a call to"], [232, "                    // SimpleHttpConnectionManager.finishLastResponse(conn);"], [233, "                    // Consuming the response is handled outside in 4.0."], [234, ""], [235, "                    // make sure this connection will not be re-used"], [236, "                    // Shut down rather than close, we might have gotten here"], [237, "                    // because of a shutdown trigger."], [238, "                    // Shutdown of the adapter also clears the tracked route."], [239, "                    hca.shutdown();"], [240, "                }"], [241, "            } catch (IOException iox) {"], [242, "                if (log.isDebugEnabled())"], [243, "                    log.debug(\"Exception shutting down released connection.\","], [244, "                              iox);"], [245, "            } finally {"], [246, "                boolean reusable = hca.isMarkedReusable();"], [247, "                if (log.isDebugEnabled()) {"], [248, "                    if (reusable) {"], [249, "                        log.debug(\"Released connection is reusable.\");"], [250, "                    } else {"], [251, "                        log.debug(\"Released connection is not reusable.\");"], [252, "                    }"], [253, "                }"], [254, "                hca.detach();"]], "deleted": [[223, ""], [224, "        try {"], [225, "            // make sure that the response has been read completely"], [226, "            if (hca.isOpen() && !hca.isMarkedReusable()) {"], [227, "                // In MTHCM, there would be a call to"], [228, "                // SimpleHttpConnectionManager.finishLastResponse(conn);"], [229, "                // Consuming the response is handled outside in 4.0."], [230, ""], [231, "                // make sure this connection will not be re-used"], [232, "                // Shut down rather than close, we might have gotten here"], [233, "                // because of a shutdown trigger."], [234, "                // Shutdown of the adapter also clears the tracked route."], [235, "                hca.shutdown();"], [236, "            }"], [237, "        } catch (IOException iox) {"], [238, "            //@@@ log as warning? let pass?"], [239, "            if (log.isDebugEnabled())"], [240, "                log.debug(\"Exception shutting down released connection.\","], [241, "                          iox);"], [242, "        } finally {"], [244, "            boolean reusable = hca.isMarkedReusable();"], [245, "            if (log.isDebugEnabled()) {"], [246, "                if (reusable) {"], [247, "                    log.debug(\"Released connection is reusable.\");"], [248, "                } else {"], [249, "                    log.debug(\"Released connection is not reusable.\");"], [250, "                }"], [252, "            hca.detach();"], [253, "            if (entry != null) {"]]}, "num_lines_added": 30, "num_lines_removed": 29}