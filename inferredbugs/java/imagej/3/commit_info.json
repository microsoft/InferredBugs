{"hash": "ab2e3405b2b0fefed77ac6925cb5e55bbb6895dd", "message": "Move getTotalSamples() into ImageUtils. Improve performance in ImgLibProcessor via change in use of planePosition\n\nThis used to be revision r1358.", "file_num_lines": 1902, "diff_parsed": {"added": [[58, "//     Must investigate. (as a workaround for now we are incrementing indexes from left to right)"], [67, "//       where you want to specify them. Also allow new Image<UnsignedByte>(rows,cols,pixels)."], [72, "//       Also could do cursor.fwd(\"t\" or some enum value) which would iterate forward in the (here t) plane of the image skipping large groups of"], [89, "\tprivate final int[] planePosition;"], [93, "\tprivate final boolean isIntegral;"], [136, "\t\t//this.imageProperties.setPlanePosition( thisPlanePosition );"], [137, "\t\tthis.planePosition = thisPlanePosition.clone();"], [357, ""], [358, "\t\tfinal boolean isUnsignedShort = this.type instanceof UnsignedShortType;"], [359, "\t\tfinal boolean isGenericShort = this.type instanceof GenericShortType<?>;"], [360, "\t\tfinal boolean isIntegral = this.isIntegral;"], [361, "\t\tfinal double range = max - min;"], [362, "\t\tfinal double  c = value;"], [364, "\t\tdouble v1, v2;"], [365, ""], [366, "\t\tfinal int xEdge = roiX + roiWidth;"], [367, "\t\tfinal int yEdge = roiY + roiHeight;"], [368, "\t\tfor (int y=roiY; y<yEdge; y++)"], [369, "\t\t{"], [370, "\t\t\tfor (int x=roiX; x<xEdge; x++)"], [371, "\t\t\t{"], [372, "\t\t\t\tv1 = getd(x,y);"], [373, ""], [388, "\t\t\t\t\t\tif (isIntegral)"], [394, "\t\t\t\t\t\tif (isIntegral)"], [400, "\t\t\t\t\t\tif (isIntegral)"], [406, "\t\t\t\t\t\tif (isIntegral)"], [422, "\t\t\t\t\t\tif (isIntegral)"], [440, "\t\t\t\t\t\tif (isGenericShort)"], [449, "\t\t\t\t\t\t\tif (isUnsignedShort)"], [478, "\t\t\t\tif (isIntegral)"], [481, "\t\t\t\tsetd(x, y, v2);"], [484, ""], [968, "\t\tif (numPixels != ImageUtils.getTotalSamples(theImage))"], [1562, "\tpublic long getTotalSamples()"], [1564, "\t\treturn ImageUtils.getTotalSamples(this.imageData);"], [1646, "\tpublic final int[] getPlanePosition()"], [1648, "\t\treturn this.planePosition;"], [1649, "\t\t// this next line slows down all calculations by 10% !!!!!"], [1650, "\t\t// return this.imageProperties.getPlanePosition();"], [2328, "\t\tlong size = ImageUtils.getTotalSamples(this.imageData);"], [2331, "\t\t\tfp = new FloatProcessor(width, height, new float[(int)size], super.cm);  // TODO : notice that we can't get more than 2 gig of floats"]], "deleted": [[58, "//     Must investigate."], [67, "//       where you want to specify them. Also allow new Image<T extends RealType<T>>(rows,cols,pixels)."], [72, "//       Also could do cursor.fwd(\"t\" or some enum T) which would iterate forward in the (here T) plane of the image skipping large groups of"], [92, "\tprivate boolean isIntegral;"], [135, "\t\tthis.imageProperties.setPlanePosition( thisPlanePosition );"], [355, ""], [356, "\t\tdouble range = max - min;"], [357, "\t\tdouble c, v1, v2;"], [359, "\t\tc = value;"], [360, "\t\tfor (int y=roiY; y<(roiY+roiHeight); y++) {"], [361, "\t\t\tint i = y * width + roiX;"], [362, "\t\t\tfor (int x=roiX; x<(roiX+roiWidth); x++) {"], [363, "\t\t\t\tv1 = getf(i);"], [378, "\t\t\t\t\t\tif (this.isIntegral)"], [384, "\t\t\t\t\t\tif (this.isIntegral)"], [390, "\t\t\t\t\t\tif (this.isIntegral)"], [396, "\t\t\t\t\t\tif (this.isIntegral)"], [412, "\t\t\t\t\t\tif (this.isIntegral)"], [430, "\t\t\t\t\t\tif (this.type instanceof GenericShortType<?>)"], [439, "\t\t\t\t\t\t\tif (this.type instanceof UnsignedShortType)"], [468, "\t\t\t\tif (this.isIntegral)"], [471, "\t\t\t\tsetd(i++, v2);"], [923, "\t// belongs elsewhere"], [924, ""], [925, "\tprivate long getNumPixels(Image<T> image)"], [926, "\t{"], [927, "\t\treturn ImageUtils.getTotalSamples(image.getDimensions());"], [928, "\t}"], [929, ""], [964, "\t\tif (numPixels != getNumPixels(theImage))"], [1558, "\tpublic long getNumPixels()"], [1560, "\t\treturn getNumPixels(this.imageData);"], [1642, "\tpublic int[] getPlanePosition()"], [1644, "\t\treturn this.imageProperties.getPlanePosition();"], [2322, "\t\tlong size = getNumPixels(this.imageData);"], [2325, "\t\t\tfp = new FloatProcessor(width, height, new float[(int)size], super.cm);"]]}, "num_lines_added": 42, "num_lines_removed": 36}