{"hash": "31c674a826b188c93713d6057ae9dc3238d564c3", "message": "PHOENIX-4440 Local index split/merge IT tests are failing(Rajeshbabu)", "file_num_lines": 209, "diff_parsed": {"added": [[25, "import org.apache.hadoop.hbase.CellBuilder;"], [26, "import org.apache.hadoop.hbase.CellBuilderFactory;"], [27, "import org.apache.hadoop.hbase.CellBuilderType;"], [28, "import org.apache.hadoop.hbase.CellComparatorImpl;"], [43, "    private CellComparatorImpl comparator;"], [48, "        super(reader, reader.getScanner(cacheBlocks, pread, isCompaction), !isCompaction, reader"], [54, "        this.comparator = (CellComparatorImpl)getComparator();"], [132, "            if (this.comparator.compare(kv, firstKey.get(), true) <= 0) {"], [135, "            Cell replacedKey = getKeyPresentInHFiles(kv);"], [144, "            KeyValue splitKeyValue = new KeyValue.KeyOnlyKeyValue(reader.getSplitkey());"], [145, "            if (this.comparator.compare(kv, splitKeyValue, true) >= 0) {"], [205, "    private KeyValue getKeyPresentInHFiles(Cell keyValue) {"], [211, "                new byte[length + keyValue.getRowArray().length - (rowOffset + rowLength) + ROW_LENGTH_SIZE];"], [217, "        System.arraycopy(keyValue.getRowArray(), rowOffset + rowLength, replacedKey,"], [219, "                    + ROW_LENGTH_SIZE, keyValue.getRowArray().length - (rowOffset + rowLength));"], [231, "        Cell keyToSeek = cell;"], [232, "        KeyValue splitKeyValue = new KeyValue.KeyOnlyKeyValue(reader.getSplitkey());"], [234, "            if(this.comparator.compare(cell, splitKeyValue, true) < 0){"], [240, "            keyToSeek = getKeyPresentInHFiles(cell);"], [243, "            if (this.comparator.compare(cell, splitKeyValue, true) >= 0) {"], [248, "                keyToSeek = getKeyPresentInHFiles(cell);"], [254, "    private boolean seekOrReseekToProperKey(boolean isSeek, Cell kv)"]], "deleted": [[29, "import org.apache.hadoop.hbase.io.hfile.HFileScanner;"], [44, "        super(reader, reader.getScanner(cacheBlocks, pread, isCompaction), true, reader"], [127, "            byte[] fk = PhoenixKeyValueUtil.maybeCopyCell(firstKey.get()).getKey();"], [128, "            if (getComparator().compare(kv, firstKey.get()) <= 0) {"], [131, "            KeyValue replacedKey = getKeyPresentInHFiles(kv.getRowArray());"], [140, "            KeyValue splitKeyValue = KeyValueUtil.createKeyValueFromKey(reader.getSplitkey());"], [141, "            if (getComparator().compare(kv, splitKeyValue) >= 0) {"], [201, "    private KeyValue getKeyPresentInHFiles(byte[] key) {"], [202, "        KeyValue keyValue = new KeyValue(key);"], [208, "                new byte[length + key.length - (rowOffset + rowLength) + ROW_LENGTH_SIZE];"], [214, "        System.arraycopy(key, rowOffset + rowLength, replacedKey,"], [216, "                    + ROW_LENGTH_SIZE, key.length - (rowOffset + rowLength));"], [228, "        KeyValue kv = PhoenixKeyValueUtil.maybeCopyCell(cell);"], [229, "        KeyValue keyToSeek = kv;"], [230, "        KeyValue splitKeyValue = KeyValueUtil.createKeyValueFromKey(reader.getSplitkey());"], [232, "            if(getComparator().compare(kv, splitKeyValue) < 0){"], [238, "            keyToSeek = getKeyPresentInHFiles(kv.getRowArray());"], [241, "            if (getComparator().compare(kv, splitKeyValue) >= 0) {"], [246, "                keyToSeek = getKeyPresentInHFiles(kv.getRowArray());"], [252, "    private boolean seekOrReseekToProperKey(boolean isSeek, KeyValue kv)"], [272, ""]]}, "num_lines_added": 22, "num_lines_removed": 21}