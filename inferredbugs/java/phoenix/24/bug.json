{"bug_class": "PROVER", "kind": "ERROR", "bug_type": "THREAD_SAFETY_VIOLATION", "qualifier": "Read/Write race. Non-private method `org.apache.phoenix.coprocessor.UngroupedAggregateRegionObserver.doPostScannerOpen` indirectly reads with synchronization from `types.PDataTypeFactory.org.apache.phoenix.schema.types.PDataTypeFactory.INSTANCE`. Potentially races with unsynchronized write in method `UngroupedAggregateRegionObserver.doPostScannerOpen(...)`.\n Reporting because this access may occur on a background thread.", "severity": "HIGH", "visibility": "user", "line": 451, "column": -1, "procedure": "RegionScanner UngroupedAggregateRegionObserver.doPostScannerOpen(ObserverContext,Scan,RegionScanner)", "procedure_id": "org.apache.phoenix.coprocessor.UngroupedAggregateRegionObserver.doPostScannerOpen(org.apache.hadoop..272dadab310788572d54d545fc6e61a2", "procedure_start_line": 253, "file": "phoenix-core/src/main/java/org/apache/phoenix/coprocessor/UngroupedAggregateRegionObserver.java", "bug_trace": [{"level": 0, "filename": "phoenix-core/src/main/java/org/apache/phoenix/coprocessor/UngroupedAggregateRegionObserver.java", "line_number": 451, "column_number": -1, "description": "<Read trace>"}, {"level": 0, "filename": "phoenix-core/src/main/java/org/apache/phoenix/coprocessor/UngroupedAggregateRegionObserver.java", "line_number": 451, "column_number": -1, "description": "call to int PTableImpl.newKey(ImmutableBytesWritable,byte[][])"}, {"level": 1, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/PTableImpl.java", "line_number": 641, "column_number": -1, "description": "call to ParseNode SQLParser.parseExpression()"}, {"level": 2, "filename": "phoenix-core/src/main/java/org/apache/phoenix/parse/SQLParser.java", "line_number": 148, "column_number": -1, "description": "call to ParseNode PhoenixSQLParser.expression()"}, {"level": 3, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 6887, "column_number": -1, "description": "call to ParseNode PhoenixSQLParser.or_expression()"}, {"level": 4, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 6922, "column_number": -1, "description": "call to ParseNode PhoenixSQLParser.and_expression()"}, {"level": 5, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 6985, "column_number": -1, "description": "call to ParseNode PhoenixSQLParser.not_expression()"}, {"level": 6, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 7140, "column_number": -1, "description": "call to ParseNode PhoenixSQLParser.boolean_expression()"}, {"level": 7, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 7623, "column_number": -1, "description": "call to ParseNode PhoenixSQLParser.subquery_expression()"}, {"level": 8, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 4633, "column_number": -1, "description": "call to SelectStatement PhoenixSQLParser.select_node()"}, {"level": 9, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 4938, "column_number": -1, "description": "call to LimitNode PhoenixSQLParser.limit()"}, {"level": 10, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 5586, "column_number": -1, "description": "call to LiteralParseNode PhoenixSQLParser.int_or_long_literal()"}, {"level": 11, "filename": "phoenix-core/target/generated-sources/antlr3/org/apache/phoenix/parse/PhoenixSQLParser.java", "line_number": 10190, "column_number": -1, "description": "call to LiteralParseNode ParseNodeFactory.intOrLong(String)"}, {"level": 12, "filename": "phoenix-core/src/main/java/org/apache/phoenix/parse/ParseNodeFactory.java", "line_number": 551, "column_number": -1, "description": "call to LiteralParseNode.<init>(Object)"}, {"level": 13, "filename": "phoenix-core/src/main/java/org/apache/phoenix/parse/LiteralParseNode.java", "line_number": 52, "column_number": -1, "description": "call to PDataType PDataType.fromLiteral(Object)"}, {"level": 14, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/types/PDataType.java", "line_number": 1153, "column_number": -1, "description": "call to org.apache.phoenix.schema.types.PDataType[] PDataType.values()"}, {"level": 15, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/types/PDataType.java", "line_number": 70, "column_number": -1, "description": "call to PDataTypeFactory PDataTypeFactory.getInstance()"}, {"level": 16, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/types/PDataTypeFactory.java", "line_number": 38, "column_number": -1, "description": "access to `types.PDataTypeFactory.org.apache.phoenix.schema.types.PDataTypeFactory.INSTANCE`"}, {"level": 0, "filename": "phoenix-core/src/main/java/org/apache/phoenix/coprocessor/UngroupedAggregateRegionObserver.java", "line_number": 334, "column_number": -1, "description": "<Write trace>"}, {"level": 0, "filename": "phoenix-core/src/main/java/org/apache/phoenix/coprocessor/UngroupedAggregateRegionObserver.java", "line_number": 334, "column_number": -1, "description": "call to TupleProjector IndexUtil.getTupleProjector(Scan,org.apache.phoenix.hbase.index.covered.update.ColumnReference[])"}, {"level": 1, "filename": "phoenix-core/src/main/java/org/apache/phoenix/util/IndexUtil.java", "line_number": 442, "column_number": -1, "description": "call to KeyValueSchema IndexUtil.deserializeLocalIndexJoinSchemaFromScan(Scan)"}, {"level": 2, "filename": "phoenix-core/src/main/java/org/apache/phoenix/util/IndexUtil.java", "line_number": 427, "column_number": -1, "description": "call to void ValueSchema.readFields(DataInput)"}, {"level": 3, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/ValueSchema.java", "line_number": 375, "column_number": -1, "description": "call to void ValueSchema$Field.readFields(DataInput)"}, {"level": 4, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/ValueSchema.java", "line_number": 264, "column_number": -1, "description": "call to org.apache.phoenix.schema.types.PDataType[] PDataType.values()"}, {"level": 5, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/types/PDataType.java", "line_number": 70, "column_number": -1, "description": "call to PDataTypeFactory PDataTypeFactory.getInstance()"}, {"level": 6, "filename": "phoenix-core/src/main/java/org/apache/phoenix/schema/types/PDataTypeFactory.java", "line_number": 39, "column_number": -1, "description": "access to `types.PDataTypeFactory.org.apache.phoenix.schema.types.PDataTypeFactory.INSTANCE`"}], "key": "UngroupedAggregateRegionObserver.java|doPostScannerOpen|THREAD_SAFETY_VIOLATION", "node_key": "9c5d6d9028928346cc4fb44cced5dea1", "hash": "97d34afe258e541fb39573eebec2eecb", "bug_type_hum": "Thread Safety Violation", "censored_reason": ""}