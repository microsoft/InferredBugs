{"hash": "2de90020eddd7997cb6ff7920d35fe8be32dadb8", "message": "fixed caching+synchronization+brute-force-denial\n\ngit-svn-id: https://svn.berlios.de/svnroot/repos/yacy/trunk@67 6c8d7289-2bf4-0310-a012-ef5d649a1542", "file_num_lines": 550, "diff_parsed": {"added": [[79, "    public static Hashtable bfHost = new Hashtable(); // for brute-force prevention"], [302, "\tString clientIP = \"\"+controlSocket.getInetAddress().getHostAddress();"], [303, "        if (bfHost.get(clientIP) != null) {"], [304, "            log.logInfo(\"SLOWING DOWN ACCESS FOR BRUTE-FORCE PREVENTION FROM \" + clientIP);"], [305, "\t    // add a delay to make brute-force harder"], [306, "\t    try {Thread.currentThread().sleep(1000);} catch (InterruptedException e) {}"], [307, "\t}"], [308, "        if ((this.denyHost == null) || (this.denyHost.get(clientIP) == null)) {"], [312, "            //log.logDebug(\"* NEW SESSION: \" + connection.request + \" from \" + clientIP);"], [314, "            System.out.println(\"ACCESS FROM \" + clientIP + \" DENIED\");"], [764, "\t\t\t\t    if (denyHost != null)"], [765, "\t\t\t\t\tdenyHost.put((\"\"+userAddress.getHostAddress()), \"deny\"); // block client: hacker attempt"], [766, "\t\t\t\t}"]], "deleted": [[301, "        if ((this.denyHost == null) || (this.denyHost.get((\"\"+controlSocket.getInetAddress().getHostAddress())) == null)) {"], [302, "            //log.logDebug(\"* catched request from \" + controlSocket.getInetAddress().getHostAddress());"], [304, ""], [307, ""], [308, "            //try {Thread.currentThread().sleep(1000);} catch (InterruptedException e) {} // wait for debug"], [309, "            // activeThreads.put(connection, new Long(System.currentTimeMillis()));"], [310, "            //log.logDebug(\"* NEW SESSION: \" + connection.request);"], [311, ""], [313, "            System.out.println(\"ACCESS FROM \" + controlSocket.getInetAddress().getHostAddress() + \" DENIED\");"], [763, "                                        if (denyHost != null)"], [764, "                                            denyHost.put((\"\"+userAddress.getHostAddress()), \"deny\"); // block client: hacker attempt"], [765, "                        }"]]}, "num_lines_added": 13, "num_lines_removed": 12}