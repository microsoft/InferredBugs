{"hash": "bce1ae9979d94302ec3a72b6765c5f99565b490f", "message": "fixed linux cpu load", "file_num_lines": 110, "diff_parsed": {"added": [[15, "import oshi.util.FormatUtil;"], [35, "\t\tScanner in = null;"], [36, "\t\ttry {"], [37, "\t\t\tin = new Scanner(new FileReader(\"/proc/stat\"));"], [38, "\t\t} catch (FileNotFoundException e) {"], [39, "\t\t\tSystem.err.println(\"Problem with: /proc/stat\");"], [40, "\t\t\tSystem.err.println(e.getMessage());"], [41, "\t\t\treturn -1;"], [42, "\t\t}"], [43, "\t\tin.useDelimiter(\"\\n\");"], [44, "\t\tString[] result = in.next().split(\" \");"], [45, "\t\tArrayList<Float> loads = new ArrayList<Float>();"], [46, "\t\tfor (String load : result) {"], [47, "\t\t\tif (load.matches(\"-?\\\\d+(\\\\.\\\\d+)?\")) {"], [48, "\t\t\t\tloads.add(Float.valueOf(load));"], [49, "\t\t\t}"], [50, "\t\t}"], [51, "\t\t// ((Total-PrevTotal)-(Idle-PrevIdle))/(Total-PrevTotal) - see http://stackoverflow.com/a/23376195/4359897"], [52, "\t\tfloat totalCpuLoad = (loads.get(0) + loads.get(2))*100 / (loads.get(0) + loads.get(2) + loads.get(3));"], [53, "\t\treturn FormatUtil.round(totalCpuLoad, 2);"]], "deleted": [[34, ""], [35, "\t\t// should be same as on Mac. Not tested."], [36, "\t\tArrayList<String> topResult = ExecutingCommand.runNative(\"top -l 1 -R -F -n1\"); // cpu load is in [3]"], [37, "\t\tString[] idle = topResult.get(3).split(\" \"); // idle value is in [6]"], [38, "\t\treturn 100 - Float.valueOf(idle[6].replace(\"%\", \"\"));"]]}, "num_lines_added": 20, "num_lines_removed": 5}