{"hash": "f8f3b5603c010b67f3efd61b6442008bd4f12aed", "message": "Discard expired sessions and correctly handle login redirects", "file_num_lines": 60, "diff_parsed": {"added": [[34, "import pt.ua.dicoogle.server.web.auth.Authentication;"], [64, "                rolesObj.add(r.getName());"], [81, ""], [82, "\t\tString token = req.getHeader(\"Authorization\");"], [83, "\t\tUser user = Authentication.getInstance().getUsername(token);"], [84, ""], [85, "\t\tif(user == null) {"], [91, "        json_resp.put(\"user\", user.getUsername());"], [92, "        json_resp.put(\"admin\", user.isAdmin());"], [94, "        for (Role r : user.getRoles()) {"]], "deleted": [[28, "import javax.servlet.http.HttpSession;"], [64, "                if (r!=null)"], [65, "                    rolesObj.add(r.getName());"], [82, "        //resp.addHeader(\"Access-Control-Allow-Origin\", \"*\");"], [83, "\t\tHttpSession session = req.getSession(false);"], [84, ""], [85, "\t\tLoggedIn mLoggedIn = Session.getUserLoggedIn(session);"], [86, "\t\tif(mLoggedIn == null){"], [92, "        json_resp.put(\"user\", mLoggedIn.getUserName());"], [93, "        json_resp.put(\"admin\", mLoggedIn.isAdmin());"], [94, "        User u = UsersStruct.getInstance().getUser(mLoggedIn.getUserName());"], [96, "        for (Role r : u.getRoles())"], [97, "        {"], [109, ""]]}, "num_lines_added": 10, "num_lines_removed": 14}