{"hash": "4727b8392f2d9111ca3b5aaf39c1afd69dcdbb4c", "message": "Factored out and tested argument parsing", "file_num_lines": 45, "diff_parsed": {"added": [[13, "import java.util.ArrayList;"], [14, "import java.util.Arrays;"], [15, "import java.util.Collection;"], [16, "import java.util.List;"], [36, "        Arguments arguments = Arguments.parseArgs(args);"], [37, "        String statsdServer = arguments.statsdServer;"], [38, "        int statsdPort = arguments.statsdPort;"], [39, "        String prefix = arguments.metricsPrefix.or(\"statsd-jvm-profiler\");"], [40, "        List<String> filterPackages = arguments.filterPackages.or(new ArrayList<String>());"]], "deleted": [[13, "import java.util.*;"], [27, "     * Parses profiler arguments into a map"], [28, "     *"], [29, "     * @param args A string containing the arguments"], [30, "     * @return A map of argument names to values"], [31, "     */"], [32, "    private static Map<String, String> parseArgs(final String args) {"], [33, "        Map<String, String> parsed = new HashMap<>();"], [34, "        for (String argPair : args.split(\",\")) {"], [35, "            String[] tokens = argPair.split(\"=\");"], [36, "            if (tokens.length != 2) {"], [37, "                throw new IllegalArgumentException(\"statsd-jvm-profiler takes a comma-delimited list of arguments in k=v form\");"], [38, "            }"], [39, ""], [40, "            parsed.put(tokens[0], tokens[1]);"], [41, "        }"], [42, ""], [43, "        return parsed;"], [44, "    }"], [45, ""], [46, "    /**"], [53, "        Map<String, String> argMap = parseArgs(args);"], [54, "        String statsdServer = argMap.get(\"server\");"], [55, "        int statsdPort = Integer.valueOf(argMap.get(\"port\"));"], [56, "        String prefix = argMap.get(\"prefix\");"], [57, "        List<String> filterPackages = Arrays.asList(argMap.get(\"filterPackages\").split(\":\"));"]]}, "num_lines_added": 9, "num_lines_removed": 26}