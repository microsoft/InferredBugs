{"hash": "367a1609ca7547b209b6a578e633f4937a5e3410", "message": "refactor(samples): Mark open and closeNow as non-delegated and define their implementation in DeviceClientManager", "file_num_lines": 146, "diff_parsed": {"added": [[22, ""], [23, "    private interface DeviceClientNonDelegatedFunction {"], [24, "        void open();"], [25, "        void closeNow();"], [26, "    }"], [27, ""], [28, "    // The methods defined in the interface DeviceClientNonDelegatedFunction will be called on DeviceClientManager, and not on DeviceClient."], [29, "    @Delegate(excludes = DeviceClientNonDelegatedFunction.class)"], [39, "    public void open() {"], [50, "    private void doConnect() {"], [51, "        // Device client does not have retry on the initial open() call. Will need to be re-opened by the calling application"], [52, "        while (connectionStatus == ConnectionStatus.CONNECTING) {"], [53, "            synchronized (lock) {"], [54, "                if(connectionStatus == ConnectionStatus.CONNECTING) {"], [55, "                    try {"], [56, "                        log.debug(\"[connect] - Opening the device client instance...\");"], [57, "                        client.open();"], [58, "                        connectionStatus = ConnectionStatus.CONNECTED;"], [59, "                        break;"], [60, "                    }"], [61, "                    catch (Exception ex) {"], [62, "                        log.error(\"[connect] - Exception thrown while opening DeviceClient instance: \", ex);"], [63, "                    }"], [64, "                }"], [65, "            }"], [66, ""], [67, "            try {"], [68, "                log.debug(\"[connect] - Sleeping for 10 secs before attempting another open()\");"], [69, "                Thread.sleep(SLEEP_TIME_BEFORE_RECONNECTING_IN_SECONDS * 1000);"], [70, "            }"], [71, "            catch (InterruptedException ex) {"], [72, "                log.error(\"[connect] - Exception in thread sleep: \", ex);"], [73, "            }"], [74, "        }"], [75, "    }"], [76, ""], [77, "    public void closeNow() {"], [135, "    private void handleRecoverableDisconnection() {"]], "deleted": [[22, "    @Delegate"], [32, "    public void connect() {"], [43, "    public void disconnect() {"], [101, "    void handleRecoverableDisconnection() {"], [130, ""], [131, "    void doConnect() {"], [132, "        // Device client does not have retry on the initial open() call. Will need to be re-opened by the calling application"], [133, "        while (connectionStatus == ConnectionStatus.CONNECTING) {"], [134, "            synchronized (lock) {"], [135, "                if(connectionStatus == ConnectionStatus.CONNECTING) {"], [136, "                    try {"], [137, "                        log.debug(\"[connect] - Opening the device client instance...\");"], [138, "                        client.open();"], [139, "                        connectionStatus = ConnectionStatus.CONNECTED;"], [140, "                        break;"], [141, "                    }"], [142, "                    catch (Exception ex) {"], [143, "                        log.error(\"[connect] - Exception thrown while opening DeviceClient instance: \", ex);"], [144, "                    }"], [145, "                }"], [146, "            }"], [147, ""], [148, "            try {"], [149, "                log.debug(\"[connect] - Sleeping for 10 secs before attempting another open()\");"], [150, "                Thread.sleep(SLEEP_TIME_BEFORE_RECONNECTING_IN_SECONDS * 1000);"], [151, "            }"], [152, "            catch (InterruptedException ex) {"], [153, "                log.error(\"[connect] - Exception in thread sleep: \", ex);"], [154, "            }"], [155, "        }"], [156, "    }"]]}, "num_lines_added": 38, "num_lines_removed": 31}