{"hash": "8b7e50ae2ddd57dda77c397b550c04cf571c2a3f", "message": "#99 RtcpHandler sends RTCP_BYE as soon as it leave the RTP session. No longer uses a separate thread to send the BYE.\n\nRtcpHandler no longer closes the DatagramChannel. That responsibility is delegated to the owner of the handler only.", "file_num_lines": 340, "diff_parsed": {"added": [[198, ""], [199, "            // Send BYE"], [200, "            // Do not run in separate thread so channel can be properly closed by the owner of this handler"], [201, "            this.statistics.setRtcpPacketType(RtcpPacketType.RTCP_BYE);"], [202, "            this.scheduledTask = new TxTask(RtcpPacketType.RTCP_BYE);"], [203, "            this.scheduledTask.run();"], [586, "                    // Send BYE and stop scheduling further packets"], [587, "                    RtcpPacket bye = RtcpPacketFactory.buildBye(statistics);"], [588, ""], [589, "                    // Set the avg_packet_size to the size of the compound BYE packet"], [590, "                    statistics.setRtcpAvgSize(bye.getSize());"], [591, ""], [592, "                    // Send the BYE and close channel"], [593, "                    sendRtcpPacket(bye);"], [594, "                    break;"]], "deleted": [[198, "            scheduleNow(RtcpPacketType.RTCP_BYE);"], [581, "//                    if (tn <= tc) {"], [582, "                        // Send BYE and stop scheduling further packets"], [583, "                        RtcpPacket bye = RtcpPacketFactory.buildBye(statistics);"], [584, ""], [585, "                        // Set the avg_packet_size to the size of the compound BYE packet"], [586, "                        statistics.setRtcpAvgSize(bye.getSize());"], [587, ""], [588, "                        // Send the BYE and close channel"], [589, "                        sendRtcpPacket(bye);"], [590, "                        closeChannel();"], [591, "                        reset();"], [592, "                        return;"], [593, "//                    } else {"], [594, "                        // Delay BYE"], [595, "//                        scheduleRtcp(tn, RtcpPacketType.RTCP_BYE);"], [596, "//                    }"], [597, "//                    break;"]]}, "num_lines_added": 15, "num_lines_removed": 18}