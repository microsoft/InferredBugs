{"hash": "208479c8a038b1db1846febe6f6f1cd6918af784", "message": "Polish leader elector and enhance unit tests", "file_num_lines": 306, "diff_parsed": {"added": [[33, "    private int heartBeatTimeIntervalMs = 500;"], [36, "    private boolean needIncreaseTermImmediately = false;"], [116, "    }"], [117, ""], [118, "    //just for test"], [119, "    public void revote(long term) {"], [120, "        changeRoleToCandidate(term);"], [121, "        lastParseResult = VoteResponse.PARSE_RESULT.WAIT_TO_VOTE_NEXT;"], [152, "                needIncreaseTermImmediately = true;"], [209, "                    logger.info(\"[{}][HeartBeatTimeOut] lastLeaderHeartBeatTime: {} heartBeatTimeIntervalMs: {}\", memberState.getSelfId(), lastLeaderHeartBeatTime, heartBeatTimeIntervalMs);"], [210, "                    changeRoleToCandidate(memberState.currTerm());"], [249, "        if (System.currentTimeMillis() < nextTimeToRequestVote && !needIncreaseTermImmediately) {"], [259, "            if (lastParseResult == VoteResponse.PARSE_RESULT.WAIT_TO_VOTE_NEXT || needIncreaseTermImmediately) {"], [269, "        if (needIncreaseTermImmediately) {"], [270, "            nextTimeToRequestVote = System.currentTimeMillis() + minVoteIntervalMs + random.nextInt(maxVoteIntervalMs - minVoteIntervalMs);"], [271, "            needIncreaseTermImmediately = false;"], [272, "            return;"], [273, "        }"], [315, "                    changeRoleToCandidate(knownMaxTermInGroup);"]], "deleted": [[33, "    private int heartBeatTimeIntervalMs = 300;"], [201, "                    memberState.changeToCandidate(memberState.currTerm());"], [240, "        if (System.currentTimeMillis() < nextTimeToRequestVote) {"], [250, "            if (lastParseResult == VoteResponse.PARSE_RESULT.WAIT_TO_VOTE_NEXT) {"], [301, "                    memberState.changeToCandidate(knownMaxTermInGroup);"]]}, "num_lines_added": 19, "num_lines_removed": 5}