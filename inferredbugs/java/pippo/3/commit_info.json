{"hash": "506196f2d265774f4c1b83427ec03ca85a2d2018", "message": "Use hashcode for the version & allow subclasses to override version", "file_num_lines": 94, "diff_parsed": {"added": [[38, "    private static final Pattern VERSION_PATTERN = Pattern.compile(\"-ver-[0-9a-f]+\\\\.\");"], [62, "    protected String getResourceVersion(String resourcePath) {"], [63, "        URL resourceUrl = getResourceUrl(resourcePath);"], [64, "        try {"], [65, "            long lastModified = resourceUrl.openConnection().getLastModified();"], [66, "            return Long.toHexString(lastModified);"], [67, "        } catch (IOException e) {"], [68, "            throw new PippoRuntimeException(\"Failed to read lastModified property for {}\", e, resourceUrl);"], [69, "        }"], [70, "    }"], [71, ""], [76, "        String version = getResourceVersion(resourcePath);"], [77, "        if (StringUtils.isNullOrEmpty(version)) {"], [78, "            // unversioned, pass-through resource path"], [79, "            return resourcePath;"], [80, "        }"], [82, "        // check for extension"], [83, "        int extensionAt = resourcePath.lastIndexOf('.');"], [85, "        StringBuilder versionedResourcePath = new StringBuilder();"], [87, "        if (extensionAt == -1) {"], [88, "            versionedResourcePath.append(resourcePath);"], [89, "            versionedResourcePath.append(\"-ver-\").append(version);"], [90, "        } else {"], [91, "            versionedResourcePath.append(resourcePath.substring(0, extensionAt));"], [92, "            versionedResourcePath.append(\"-ver-\").append(version);"], [93, "            versionedResourcePath.append(resourcePath.substring(extensionAt, resourcePath.length()));"], [94, "        }"], [96, "        log.trace(\"Inject version in resource path: '{}' => '{}'\", resourcePath, versionedResourcePath);"], [98, "        return versionedResourcePath.toString();"]], "deleted": [[38, "    private static final Pattern VERSION_PATTERN = Pattern.compile(\"-ver-[0-9]+\\\\.\");"], [66, "        URL resourceUrl = getResourceUrl(resourcePath);"], [67, "        try {"], [68, "            long lastModified = resourceUrl.openConnection().getLastModified();"], [70, "            // check for extension"], [71, "            int extensionAt = resourcePath.lastIndexOf('.');"], [73, "            StringBuilder versionedResourcePath = new StringBuilder();"], [75, "            if (extensionAt == -1) {"], [76, "                versionedResourcePath.append(resourcePath);"], [77, "                versionedResourcePath.append(\"-ver-\").append(lastModified);"], [78, "            } else {"], [79, "                versionedResourcePath.append(resourcePath.substring(0, extensionAt));"], [80, "                versionedResourcePath.append(\"-ver-\").append(lastModified);"], [81, "                versionedResourcePath.append(resourcePath.substring(extensionAt, resourcePath.length()));"], [82, "            }"], [84, "            log.trace(\"Inject version in resource path: '{}' => '{}'\", resourcePath, versionedResourcePath);"], [86, "            return versionedResourcePath.toString();"], [87, "        } catch (IOException e) {"], [88, "            throw new PippoRuntimeException(\"Failed to read lastModified property for {}\", e, resourceUrl);"], [89, "        }"]]}, "num_lines_added": 29, "num_lines_removed": 20}