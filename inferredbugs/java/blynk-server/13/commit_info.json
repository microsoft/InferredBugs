{"hash": "4da853ae3e3f636702c12d057ca059e097cde041", "message": "#339 preparing code for devices", "file_num_lines": 518, "diff_parsed": {"added": [[24, "import cc.blynk.server.core.dao.TokenValue;"], [133, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [135, "        if (tokenValue == null) {"], [140, "        final User user = tokenValue.user;"], [141, "        final int dashId = tokenValue.dashId;"], [153, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [155, "        if (tokenValue == null) {"], [160, "        final User user = tokenValue.user;"], [161, "        final int dashId = tokenValue.dashId;"], [173, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [175, "        if (tokenValue == null) {"], [180, "        final User user = tokenValue.user;"], [181, "        final int dashId = tokenValue.dashId;"], [205, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [207, "        if (tokenValue == null) {"], [212, "        final User user = tokenValue.user;"], [213, "        final int dashId = tokenValue.dashId;"], [248, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [250, "        if (tokenValue == null) {"], [255, "        final User user = tokenValue.user;"], [256, "        final int dashId = tokenValue.dashId;"], [277, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [279, "        if (tokenValue == null) {"], [284, "        final User user = tokenValue.user;"], [285, "        final int dashId = tokenValue.dashId;"], [368, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [370, "        if (tokenValue == null) {"], [375, "        final User user = tokenValue.user;"], [376, "        final int dashId = tokenValue.dashId;"], [485, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [487, "        if (tokenValue == null) {"], [492, "        final User user = tokenValue.user;"], [493, "        final int dashId = tokenValue.dashId;"], [547, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [549, "        if (tokenValue == null) {"], [554, "        final User user = tokenValue.user;"], [555, "        final int dashId = tokenValue.dashId;"], [602, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [604, "        if (tokenValue == null) {"], [609, "        final User user = tokenValue.user;"], [610, "        final int dashId = tokenValue.dashId;"], [645, "        TokenValue tokenValue = tokenManager.getUserByToken(token);"], [647, "        if (tokenValue == null) {"], [652, "        DashBoard dash = tokenValue.user.profile.getDashById(tokenValue.dashId);"], [654, "        if (dash == null || !dash.isActive) {"], [673, "        log.trace(\"Sending Mail for user {}, with message : '{}'.\", tokenValue.user.name, message.subj);"], [674, "        mail(tokenValue.user.name, message.to, message.subj, message.title);"]], "deleted": [[132, "        User user = tokenManager.getUserByToken(token);"], [134, "        if (user == null) {"], [139, "        Integer dashId = user.getDashIdByToken(token);"], [140, ""], [141, "        if (dashId == null) {"], [142, "            log.error(\"Dash id for token {} not found. User {}\", token, user.name);"], [143, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [144, "        }"], [156, "        User user = tokenManager.getUserByToken(token);"], [158, "        if (user == null) {"], [163, "        Integer dashId = user.getDashIdByToken(token);"], [164, ""], [165, "        if (dashId == null) {"], [166, "            log.error(\"Dash id for token {} not found. User {}\", token, user.name);"], [167, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [168, "        }"], [180, "        User user = tokenManager.getUserByToken(token);"], [182, "        if (user == null) {"], [187, "        Integer dashId = user.getDashIdByToken(token);"], [188, ""], [189, "        if (dashId == null) {"], [190, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [191, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [192, "        }"], [216, "        User user = tokenManager.getUserByToken(token);"], [218, "        if (user == null) {"], [223, "        Integer dashId = user.getDashIdByToken(token);"], [224, ""], [225, "        if (dashId == null) {"], [226, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [227, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [228, "        }"], [263, "        User user = tokenManager.getUserByToken(token);"], [265, "        if (user == null) {"], [270, "        Integer dashId = user.getDashIdByToken(token);"], [271, ""], [272, "        if (dashId == null) {"], [273, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [274, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [275, "        }"], [296, "        User user = tokenManager.getUserByToken(token);"], [298, "        if (user == null) {"], [303, "        Integer dashId = user.getDashIdByToken(token);"], [304, ""], [305, "        if (dashId == null) {"], [306, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [307, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [308, "        }"], [391, "        User user = tokenManager.getUserByToken(token);"], [393, "        if (user == null) {"], [398, "        Integer dashId = user.getDashIdByToken(token);"], [399, ""], [400, "        if (dashId == null) {"], [401, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [402, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [403, "        }"], [512, "        User user = tokenManager.getUserByToken(token);"], [514, "        if (user == null) {"], [519, "        Integer dashId = user.getDashIdByToken(token);"], [520, ""], [521, "        if (dashId == null) {"], [522, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [523, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [524, "        }"], [578, "        User user = tokenManager.getUserByToken(token);"], [580, "        if (user == null) {"], [585, "        Integer dashId = user.getDashIdByToken(token);"], [586, ""], [587, "        if (dashId == null) {"], [588, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [589, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [590, "        }"], [637, "        User user = tokenManager.getUserByToken(token);"], [639, "        if (user == null) {"], [644, "        Integer dashId = user.getDashIdByToken(token);"], [645, ""], [646, "        if (dashId == null) {"], [647, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [648, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [649, "        }"], [684, "        User user = tokenManager.getUserByToken(token);"], [686, "        if (user == null) {"], [691, "        Integer dashId = user.getDashIdByToken(token);"], [692, ""], [693, "        if (dashId == null) {"], [694, "            log.debug(\"Dash id for token {} not found. User {}\", token, user.name);"], [695, "            return Response.badRequest(\"Didn't find dash id for token.\");"], [696, "        }"], [697, ""], [698, "        DashBoard dash = user.profile.getDashById(dashId);"], [700, "        if (!dash.isActive) {"], [719, "        log.trace(\"Sending Mail for user {}, with message : '{}'.\", user.name, message.subj);"], [720, "        mail(user.name, message.to, message.subj, message.title);"]]}, "num_lines_added": 47, "num_lines_removed": 93}