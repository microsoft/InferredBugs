{"hash": "d1cd5f2fad489090fb7449272bff99057bf13023", "message": "Added support for the AGENT type in 2.1 vCards (they are nested).", "file_num_lines": 72, "diff_parsed": {"added": [[3, "import static org.junit.Assert.assertEquals;"], [4, ""], [5, "import java.io.StringWriter;"], [10, "import ezvcard.VCardVersion;"], [11, "import ezvcard.types.AgentType;"], [13, "import ezvcard.types.NoteType;"], [66, "\t\tStringWriter sw = new StringWriter();"], [67, "\t\tVCardWriter vcw = new VCardWriter(sw, VCardVersion.V2_1);"], [68, "\t\tvcw.write(vcard);"], [69, "\t\tSystem.out.println(sw.toString());"], [70, "\t}"], [71, ""], [72, "\t/**"], [73, "\t * AGENT types for 2.1 vCards are nested."], [74, "\t */"], [75, "\t@Test"], [76, "\tpublic void nestedAgent() throws Exception {"], [77, "\t\tVCard vcard = new VCard();"], [78, ""], [79, "\t\tFormattedNameType fn = new FormattedNameType(\"Michael Angstadt\");"], [80, "\t\tvcard.setFormattedName(fn);"], [81, ""], [82, "\t\tVCard agentVcard = new VCard();"], [83, "\t\tagentVcard.setFormattedName(new FormattedNameType(\"Agent 007\"));"], [84, "\t\tagentVcard.getNotes().add(new NoteType(\"Make sure that it properly folds long lines which are part of a nested AGENT type in a version 2.1 vCard.\"));"], [85, "\t\tAgentType agent = new AgentType(agentVcard);"], [86, "\t\tvcard.setAgent(agent);"], [87, ""], [88, "\t\t//i herd u liek AGENTs..."], [89, "\t\tVCard secondAgentVCard = new VCard();"], [90, "\t\tsecondAgentVCard.setFormattedName(new FormattedNameType(\"Agent 009\"));"], [91, "\t\tsecondAgentVCard.getNotes().add(new NoteType(\"Make sure that it ALSO properly folds THIS long line because it's part of an AGENT that's inside of an AGENT.\"));"], [92, "\t\tAgentType secondAgent = new AgentType(secondAgentVCard);"], [93, "\t\tagentVcard.setAgent(secondAgent);"], [94, ""], [95, "\t\tStringWriter sw = new StringWriter();"], [96, "\t\tVCardWriter vcw = new VCardWriter(sw, VCardVersion.V2_1);"], [98, "\t\tString actual = sw.toString();"], [99, ""], [100, "\t\t//FIXME this test may fail on other machines because Class.getDeclaredFields() returns the fields in no particular order"], [101, "\t\t//@formatter:off"], [102, "\t\tStringBuilder sb = new StringBuilder();"], [103, "\t\tsb.append(\"BEGIN: vcard\\r\\n\");"], [104, "\t\tsb.append(\"VERSION: 2.1\\r\\n\");"], [105, "\t\tsb.append(\"FN: Michael Angstadt\\r\\n\");"], [106, "\t\tsb.append(\"AGENT: \\r\\n\"); //nested types should not have X-GENERATOR"], [107, "\t\t\tsb.append(\"BEGIN: vcard\\r\\n\");"], [108, "\t\t\tsb.append(\"VERSION: 2.1\\r\\n\");"], [109, "\t\t\tsb.append(\"FN: Agent 007\\r\\n\");"], [110, "\t\t\tsb.append(\"AGENT: \\r\\n\");"], [111, "\t\t\t\tsb.append(\"BEGIN: vcard\\r\\n\");"], [112, "\t\t\t\tsb.append(\"VERSION: 2.1\\r\\n\");"], [113, "\t\t\t\tsb.append(\"FN: Agent 009\\r\\n\");"], [114, "\t\t\t\tsb.append(\"NOTE: Make sure that it ALSO properly folds THIS long line because it's par\\r\\n\");"], [115, "\t\t\t\tsb.append(\" t of an AGENT that's inside of an AGENT.\\r\\n\");"], [116, "\t\t\t\tsb.append(\"END: vcard\\r\\n\");"], [117, "\t\t\tsb.append(\"NOTE: Make sure that it properly folds long lines which are part of a neste\\r\\n\");"], [118, "\t\t\tsb.append(\" d AGENT type in a version 2.1 vCard.\\r\\n\");"], [119, "\t\t\tsb.append(\"END: vcard\\r\\n\");"], [120, "\t\tsb.append(\"X-GENERATOR: EZ vCard v0.1 http://code.google.com/p/ez-vcard\\r\\n\");"], [121, "\t\tsb.append(\"END: vcard\\r\\n\");"], [122, "\t\tString expected = sb.toString();"], [123, "\t\t//@formatter:on"], [124, ""], [125, "\t\tassertEquals(expected, actual);"]], "deleted": [[3, "import java.io.OutputStreamWriter;"], [61, "\t\tVCardWriter vcw = new VCardWriter(new OutputStreamWriter(System.out));"]]}, "num_lines_added": 65, "num_lines_removed": 2}