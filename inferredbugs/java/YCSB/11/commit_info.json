{"hash": "025f3b4e8b4320b99b05deeab1f2c6cf792698c5", "message": "[hbase098] changes to use hbase connection and to be able to work with secured hbase cluster", "file_num_lines": 404, "diff_parsed": {"added": [[26, "import org.apache.hadoop.security.UserGroupInformation;"], [31, "import org.apache.hadoop.hbase.client.HConnectionManager;"], [32, "import org.apache.hadoop.hbase.client.HConnection;"], [33, "import org.apache.hadoop.hbase.client.HTableInterface;"], [66, "    public HConnection _hConn=null;"], [67, "    public HTableInterface _hTable=null;"], [102, "        if (\"kerberos\".equalsIgnoreCase(config.get(\"hbase.security.authentication\"))) {"], [103, "          config.set(\"hadoop.security.authentication\", \"Kerberos\");"], [104, "          UserGroupInformation.setConfiguration(config);"], [105, "        }"], [106, "        if ( (getProperties().getProperty(\"principal\")!=null) && (getProperties().getProperty(\"keytab\")!=null) ){"], [107, "            try {"], [108, "                UserGroupInformation.loginUserFromKeytab(getProperties().getProperty(\"principal\"), getProperties().getProperty(\"keytab\"));"], [109, "            } catch (IOException e) {"], [110, "                System.err.println(\"Keytab file is not readable or not found\");"], [111, "                throw new DBException(e);"], [112, "            }"], [113, "        }"], [114, "        try {"], [115, "            _hConn = HConnectionManager.createConnection(config);"], [116, "        } catch (IOException e) {"], [117, "            System.err.println(\"Connection to HBase was not successful\");"], [118, "            throw new DBException(e);"], [119, "        }"], [134, "\t      HTableInterface ht = _hConn.getTable(table);"], [157, "            if (_hConn != null) {"], [158, "                _hConn.close();"], [159, "            }"], [170, "            _hTable = _hConn.getTable(table);"]], "deleted": [[62, "    public HTable _hTable=null;"], [97, ""], [112, "\t      HTable ht = new HTable(config, table);"], [145, "            _hTable = new HTable(config, table);"]]}, "num_lines_added": 29, "num_lines_removed": 4}