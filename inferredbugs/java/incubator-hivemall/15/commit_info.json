{"hash": "4347a7f4076065787fb44a0f479ebcb0622dbe25", "message": "Added train_randomforest_classifier UDTF and tree_predict UDF", "file_num_lines": 133, "diff_parsed": {"added": [[18, "import org.apache.hadoop.hive.serde2.io.DoubleWritable;"], [152, "        String opScript = tree.predictOpCodegen(StackMachine.SEP);"], [154, "        IntWritable result = (IntWritable) TreePredictByStackMachineUDF.evaluate(opScript, x, true);"], [158, "    private static double evalPredict(RegressionTree tree, double[] x) throws HiveException,"], [160, "        String opScript = tree.predictOpCodegen();"], [162, "        DoubleWritable result = (DoubleWritable) TreePredictByStackMachineUDF.evaluate(opScript, x, false);"]], "deleted": [[18, "import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;"], [19, "import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;"], [20, "import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;"], [154, "        ArrayList<String> opScript = tree.predictOpCodegen();"], [156, "        TreePredictByStackMachineUDF udf = new TreePredictByStackMachineUDF();"], [157, "        udf.initialize(new ObjectInspector[] {"], [158, "                PrimitiveObjectInspectorFactory.javaStringObjectInspector,"], [159, "                ObjectInspectorFactory.getStandardListObjectInspector(PrimitiveObjectInspectorFactory.javaDoubleObjectInspector) });"], [160, "        IntWritable result = (IntWritable) udf.evaluate(opScript, x, true);"], [161, "        udf.close();"], [165, "    private static int evalPredict(RegressionTree tree, double[] x) throws HiveException,"], [167, "        ArrayList<String> opScript = tree.predictOpCodegen();"], [169, "        TreePredictByStackMachineUDF udf = new TreePredictByStackMachineUDF();"], [170, "        udf.initialize(new ObjectInspector[] {"], [171, "                PrimitiveObjectInspectorFactory.javaStringObjectInspector,"], [172, "                ObjectInspectorFactory.getStandardListObjectInspector(PrimitiveObjectInspectorFactory.javaDoubleObjectInspector) });"], [173, "        IntWritable result = (IntWritable) udf.evaluate(opScript, x, true);"], [174, "        udf.close();"]]}, "num_lines_added": 6, "num_lines_removed": 18}