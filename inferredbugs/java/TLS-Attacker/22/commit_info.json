{"hash": "fd0aeed9277e492689c038983d6a65f376c60231", "message": "Fixed TLS-Attacker Certificate usage, TLS-Attacker now only uses bouncy castle crypto.tls certificates and converts them only if necessary. These Certificates contain the complete certificate chain and not only the leaf certificate", "file_num_lines": 63, "diff_parsed": {"added": [[14, "import de.rub.nds.tlsattacker.tls.exceptions.WorkflowExecutionException;"], [26, "import java.security.cert.CertificateParsingException;"], [29, "import java.util.logging.Level;"], [32, "import org.bouncycastle.crypto.tls.Certificate;"], [44, "        X509CertificateObject cert;"], [45, "        try {"], [46, "            cert = new X509CertificateObject(fetchServerCertificate(config).getCertificateAt(0));"], [47, "        } catch (CertificateParsingException ex) {"], [48, "            throw new WorkflowExecutionException(\"Could not get public key from server certificate\", ex);"], [49, "        }"], [53, "    public static Certificate fetchServerCertificate(TlsConfig config) {"], [77, "        return context.getServerCertificate();"]], "deleted": [[39, "    public static PublicKey fetchServerPublicKey(String connect, List<CipherSuite> cipherSuites) {"], [40, "        TlsConfig config = new TlsConfig();"], [41, "        config.setHost(connect);"], [42, "        config.setSupportedCiphersuites(cipherSuites);"], [43, "        X509CertificateObject cert = fetchServerCertificate(config);"], [44, "        return cert.getPublicKey();"], [45, "    }"], [46, ""], [47, "    public static X509CertificateObject fetchServerCertificate(String connect, List<CipherSuite> cipherSuites) {"], [48, "        TlsConfig config = new TlsConfig();"], [49, "        config.setHost(connect);"], [50, "        config.setSupportedCiphersuites(cipherSuites);"], [51, "        return fetchServerCertificate(config);"], [52, "    }"], [53, ""], [55, "        X509CertificateObject cert = fetchServerCertificate(config);"], [59, "    public static X509CertificateObject fetchServerCertificate(TlsConfig config) {"], [83, "        return context.getX509ServerCertificateObject();"]]}, "num_lines_added": 12, "num_lines_removed": 18}