{"hash": "8799484b2d6dd26db70f269308646aa34b0f4f1b", "message": "Windows: Fix breaking AVDs config.ini by refactoring config file handling.\nThe new parameter 'image.sysdir.1' in AVDs config.ini is stored with backslash\non Windows, as the ini file was treated as Java-Properties file by the plugin.\nAs soon as they were read the backslash got removed and on update the broken entry\nwas written. This prevented the emulator to start the AVD.\nThe change moves the confing reading and writing to a own class (ConfigFileUtils).\nConfigFileUtils treats the given File either as INI or Java-Properties dependent\nof the file-extension or throws an IOException on unkown files.\nThe INI format is treated as simple key-value paired, without sections, etc.\nNothing more is needed, according to the Android SDK source-code.", "file_num_lines": 536, "diff_parsed": {"added": [[14, "import hudson.plugins.android_emulator.util.ConfigFileUtils;"], [302, "        return ConfigFileUtils.parseConfigFile(configFile);"], [305, "    private void writeAvdConfigFile(File homeDir, Map<String,String> values) throws IOException {"], [306, "        final File configFile = getAvdConfigFile(homeDir);"], [307, "        ConfigFileUtils.writeConfigFile(configFile, values);"]], "deleted": [[21, "import java.io.FileNotFoundException;"], [25, "import java.io.PrintWriter;"], [303, "        return Utils.parseConfigFile(configFile);"], [306, "    private void writeAvdConfigFile(File homeDir, Map<String,String> values) throws FileNotFoundException {"], [307, "        StringBuilder sb = new StringBuilder();"], [308, ""], [309, "        for (String key : values.keySet()) {"], [310, "            sb.append(key);"], [311, "            sb.append(\"=\");"], [312, "            sb.append(values.get(key));"], [313, "            sb.append(\"\\r\\n\");"], [314, "        }"], [315, ""], [316, "        File configFile = new File(getAvdDirectory(homeDir), \"config.ini\");"], [317, "        PrintWriter out = new PrintWriter(configFile);"], [318, "        out.print(sb.toString());"], [319, "        out.flush();"], [320, "        out.close();"]]}, "num_lines_added": 5, "num_lines_removed": 18}