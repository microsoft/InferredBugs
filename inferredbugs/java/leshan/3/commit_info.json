{"hash": "8279220bd03c99fc39e275c3b8f4b1d97aaad0e8", "message": "Add cfg parameter and use json format for bootstrap server config file\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch-si.com>", "file_num_lines": 98, "diff_parsed": {"added": [[15, " *     Achim Kraus (Bosch Software Innovations GmbH) - add json as storage format"], [22, "import java.io.InputStreamReader;"], [24, "import java.io.OutputStreamWriter;"], [25, "import java.lang.reflect.Type;"], [37, "import com.google.gson.Gson;"], [38, "import com.google.gson.GsonBuilder;"], [39, "import com.google.gson.reflect.TypeToken;"], [40, ""], [49, "    public static final String DEFAULT_FILE = \"data/bootstrap.json\";"], [52, "    private final Gson gson;"], [53, "    private final Type gsonType;"], [64, "        GsonBuilder builder = new GsonBuilder();"], [65, "        builder.setPrettyPrinting();"], [66, "        this.gson = builder.create();"], [67, "        this.gsonType = new TypeToken<Map<String, BootstrapConfig>>() {"], [68, "        }.getType();"], [103, "                try (InputStreamReader in = new InputStreamReader(new FileInputStream(file))) {"], [104, "                    Map<String, BootstrapConfig> config = gson.fromJson(in, gsonType);"], [105, "                    bootstrapByEndpoint.putAll(config);"], [106, "                }"], [107, "            } else {"], [108, "                // TODO temporary code for retro compatibility: remove it later."], [109, "                if (DEFAULT_FILE.equals(filename)) {"], [110, "                    file = new File(\"data/bootstrap.data\");// old bootstrap configurations default filename"], [111, "                    if (file.exists()) {"], [112, "                        try (ObjectInputStream in = new ObjectInputStream(new FileInputStream(file))) {"], [113, "                            bootstrapByEndpoint.putAll((Map<String, BootstrapConfig>) in.readObject());"], [114, "                        }"], [115, "                    }"], [136, "            try (OutputStreamWriter out = new OutputStreamWriter(new FileOutputStream(filename))) {"], [137, "                out.write(gson.toJson(getBootstrapConfigs(), gsonType));"]], "deleted": [[22, "import java.io.ObjectOutputStream;"], [24, "import java.util.HashMap;"], [43, "    private static final String DEFAULT_FILE = \"data/bootstrap.data\";"], [56, ""], [91, "                try (ObjectInputStream in = new ObjectInputStream(new FileInputStream(file))) {"], [92, "                    bootstrapByEndpoint.putAll((Map<String, BootstrapConfig>) in.readObject());"], [113, "            try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(filename))) {"], [114, "                Map<String, BootstrapConfig> copy = new HashMap<>(bootstrapByEndpoint);"], [115, "                out.writeObject(copy);"]]}, "num_lines_added": 31, "num_lines_removed": 9}