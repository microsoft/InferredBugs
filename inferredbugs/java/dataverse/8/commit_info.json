{"hash": "cdda1c3b6f92f00248681bf31d81384371f6c6e1", "message": "Add Versioning\n\nGive ability to re-publish drafts with major or minor releases\ndepending on whether files are added.  (More rules to follow.)", "file_num_lines": 153, "diff_parsed": {"added": [[44, "    public Dataset() {"], [45, "        DatasetVersion datasetVersion = new DatasetVersion();"], [46, "        datasetVersion.setDataset(this);"], [47, "        datasetVersion.setVersionState(DatasetVersion.VersionState.DRAFT);"], [48, "        datasetVersion.setFileMetadatas(new ArrayList());"], [49, "        datasetVersion.setDatasetFields(null);"], [50, "        datasetVersion.setVersionNumber(new Long(1));"], [51, "        datasetVersion.setMinorVersionNumber(new Long(0));"], [52, "        versions.add(datasetVersion);"], [53, "    }"], [54, ""], [114, "    @OrderBy(\"id DESC\")"], [166, ""], [167, "    public DatasetVersion getReleasedVersion() {"], [168, "        for (DatasetVersion version : this.getVersions()){"], [169, "            if (!version.isWorkingCopy()){"], [170, "                return version;"], [171, "            }"], [172, "        }"], [173, "        return null;"], [174, "    }"]], "deleted": [[103, "    @OrderBy(\"versionNumber DESC\")"], [107, "        if (versions.isEmpty()) {"], [108, "            DatasetVersion datasetVersion = new DatasetVersion();"], [109, "            //datasetVersion.setMetadata(new Metadata());"], [110, "            datasetVersion.setDataset(this);"], [111, "            datasetVersion.setVersionState(DatasetVersion.VersionState.DRAFT);"], [112, "            datasetVersion.setVersionNumber(new Long(1));"], [113, "            this.versions.add(datasetVersion);"], [114, "            return datasetVersion;"], [115, "        } else {"], [117, "        }"], [148, ""], [149, "        dsv.setVersionNumber(latestVersion.getVersionNumber() + 1);"]]}, "num_lines_added": 21, "num_lines_removed": 13}