{"hash": "5daa2f4617a37f14022e890f4c8b63c5e1b75cee", "message": "Improvements to the readOne() based on stack trace monitoring, closes #184", "file_num_lines": 353, "diff_parsed": {"added": [[381, "        try (DocumentContext context = in.readingDocument()) {"], [382, "            if (!context.isPresent())"], [383, "                return false;"], [384, "            if (context.isMetaData())"], [385, "                return readOneMetaData(context);"], [387, "            assert context.isData();"], [389, "            messageHistory.reset(context.sourceId(), context.index());"], [390, "            wireParser.accept(context.wire());"], [391, "        }"], [392, "        return true;"], [393, "    }"], [395, "    private boolean readOneMetaData(DocumentContext context) {"], [396, "        StringBuilder sb = Wires.acquireStringBuilder();"], [397, ""], [398, "        Wire wire = context.wire();"], [399, "        Bytes<?> bytes = wire.bytes();"], [400, "        long r = bytes.readPosition();"], [401, "        try {"], [402, "            wire.readEventName(sb);"], [403, ""], [404, "            for (String s : metaIgnoreList) {"], [405, "                // we wish to ignore our system meta data field"], [406, "                if (s.contentEquals(sb))"], [407, "                    return false;"], [409, "        } finally {"], [410, "            // roll back position to where is was before we read the SB"], [411, "            bytes.readPosition(r);"], [414, "        wireParser.accept(wire);"], [415, ""], [416, "        return true;"]], "deleted": [[381, "        for (; ; ) {"], [383, "            try (DocumentContext context = in.readingDocument()) {"], [384, "                if (!context.isPresent())"], [385, "                    return false;"], [386, "                if (context.isMetaData()) {"], [387, "                    StringBuilder sb = Wires.acquireStringBuilder();"], [388, ""], [389, "                    long r = context.wire().bytes().readPosition();"], [390, "                    try {"], [391, "                        context.wire().readEventName(sb);"], [392, ""], [393, "                        for (String s : metaIgnoreList) {"], [394, "                            // we wish to ignore our system meta data field"], [395, "                            if (s.contentEquals(sb))"], [396, "                                return false;"], [397, "                        }"], [398, "                    } finally {"], [399, "                        // roll back position to where is was before we read the SB"], [400, "                        context.wire().bytes().readPosition(r);"], [401, "                    }"], [403, "                    wireParser.accept(context.wire());"], [405, "                    return true;"], [406, "                }"], [407, "                if (!context.isData())"], [408, "                    continue;"], [409, "                MessageHistory history = messageHistory;"], [410, "                history.reset(context.sourceId(), context.index());"], [411, "                wireParser.accept(context.wire());"], [413, "            return true;"]]}, "num_lines_added": 30, "num_lines_removed": 29}