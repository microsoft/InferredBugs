{"hash": "f916d75c8449bff8b093e4a74a20a36c4334c4ce", "message": "Make DbmsMetaDataCache independent of Jdbc\n\n\nFormer-commit-id: e6895078d665a37c7cebb5351209cb245b269bf1", "file_num_lines": 55, "diff_parsed": {"added": [[39, "    schemaCache.addAll(connection.getSchemas());"], [47, "    tablesCache.addAll(connection.getTables(schema));"], [50, ""], [55, "    columnsCache.addAll(connection.getColumns(schema, table));"], [73, "    partitionCache.addAll(getPartitionColumns(schema, table));"]], "deleted": [[39, "    DbmsQueryResult queryResult = connection.executeQuery(syntax.getSchemaCommand());"], [40, "    JdbcResultSet jdbcQueryResult = new JdbcResultSet(queryResult);"], [41, "    while (queryResult.next()) {"], [42, "      schemaCache.add(jdbcQueryResult.getString(syntax.getSchemaNameColumnIndex()));"], [43, "    }"], [51, "    DbmsQueryResult queryResult = connection.executeQuery(syntax.getTableCommand(schema));"], [52, "    JdbcResultSet jdbcQueryResult = new JdbcResultSet(queryResult);"], [53, "    while (queryResult.next()) {"], [54, "      tablesCache.add(jdbcQueryResult.getString(syntax.getTableNameColumnIndex()));"], [55, "    }"], [58, ""], [63, "    DbmsQueryResult queryResult = connection.executeQuery(syntax.getColumnsCommand(schema, table));"], [64, "    JdbcResultSet jdbcQueryResult = new JdbcResultSet(queryResult);"], [65, "    while (queryResult.next()) {"], [66, "      String type = jdbcQueryResult.getString(syntax.getColumnTypeColumnIndex());"], [67, "      // remove the size of type"], [68, "      type = type.replaceAll(\"\\\\(.*\\\\)\", \"\");"], [69, "      columnsCache.add(new ImmutablePair<>(jdbcQueryResult.getString(syntax.getColumnNameColumnIndex()),"], [70, "          DataTypeConverter.typeInt(type)));"], [71, "    }"], [89, "    DbmsQueryResult queryResult = connection.executeQuery(syntax.getPartitionCommand(schema, table));"], [90, "    JdbcResultSet jdbcQueryResult = new JdbcResultSet(queryResult);"], [91, "    while (queryResult.next()) {"], [92, "      partitionCache.add(jdbcQueryResult.getString(0));"], [93, "    }"]]}, "num_lines_added": 5, "num_lines_removed": 25}