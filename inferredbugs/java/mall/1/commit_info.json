{"hash": "b0a945d2429748577035ff892e0fb713cfc7428a", "message": "JWT\u8ba4\u8bc1\u6388\u6743\u529f\u80fd\u5b8c\u5584", "file_num_lines": 78, "diff_parsed": {"added": [[3, "import io.jsonwebtoken.*;"], [4, "import org.slf4j.Logger;"], [5, "import org.slf4j.LoggerFactory;"], [11, "import java.util.HashMap;"], [26, "    private static final Logger LOGGER = LoggerFactory.getLogger(JwtTokenUtil.class);"], [37, "    private String generateToken(Map<String, Object> claims) {"], [41, "                .signWith(SignatureAlgorithm.HS512, secret)"], [48, "    private Claims getClaimsFromToken(String token) {"], [49, "        Claims claims = null;"], [55, "        } catch (Exception e) {"], [56, "            LOGGER.info(\"JWT\u683c\u5f0f\u9a8c\u8bc1\u5931\u8d25:{}\",token);"], [75, "            username =  claims.getSubject();"], [105, "        Claims claims = getClaimsFromToken(token);"], [106, "        return claims.getExpiration();"], [107, "    }"], [108, ""], [109, "    /**"], [110, "     * \u6839\u636e\u7528\u6237\u4fe1\u606f\u751f\u6210token"], [111, "     */"], [112, "    public String generateToken(UserDetails userDetails) {"], [113, "        Map<String, Object> claims = new HashMap<>();"], [114, "        claims.put(CLAIM_KEY_USERNAME, userDetails.getUsername());"], [115, "        claims.put(CLAIM_KEY_CREATED, new Date());"], [116, "        return generateToken(claims);"], [117, "    }"], [118, ""], [119, "    /**"], [120, "     * \u5224\u65adtoken\u662f\u5426\u53ef\u4ee5\u88ab\u5237\u65b0"], [121, "     */"], [122, "    public boolean canRefresh(String token) {"], [123, "        return !isTokenExpired(token);"], [126, "    /**"], [127, "     * \u5237\u65b0token"], [128, "     */"], [129, "    public String refreshToken(String token) {"], [130, "        Claims claims = getClaimsFromToken(token);"], [131, "        claims.put(CLAIM_KEY_CREATED, new Date());"], [132, "        return generateToken(claims);"], [133, "    }"]], "deleted": [[3, "import io.jsonwebtoken.Claims;"], [4, "import io.jsonwebtoken.Jwts;"], [5, "import io.jsonwebtoken.SignatureAlgorithm;"], [35, "    String generateToken(Map<String, Object> claims) {"], [39, "                .signWith(SignatureAlgorithm.RS512, secret)"], [46, "    Claims getClaimsFromToken(String token) {"], [47, "        Claims claims;"], [53, "        } finally {"], [54, "            claims = null;"], [73, "            username = claims.getSubject();"], [75, "            e.printStackTrace();"], [104, "        Date expiredDate = null;"], [105, "        try {"], [106, "            Claims claims = getClaimsFromToken(token);"], [107, "            expiredDate = claims.getExpiration();"], [108, "        } catch (Exception e) {"], [109, "            e.printStackTrace();"], [110, "        }"], [111, "        return expiredDate;"]]}, "num_lines_added": 39, "num_lines_removed": 19}