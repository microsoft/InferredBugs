{"hash": "4a203fd9a119ffd2555523badefaa8f2fa7d596e", "message": "Refreshes status message when the xmpp peer connects.\n\nWhen reconnecting xmpp call we need to update the status as we start\ninitializing the call again (sending initializing status message) and it\n was only sip peer connected to update the status, while now sip peer\n stays connected even with no xmpp call for some time.\n.", "file_num_lines": 1034, "diff_parsed": {"added": [[253, "     * The last status we sent in the conference using setPresenceStatus."], [254, "     */"], [255, "    private String jvbParticipantStatus = null;"], [256, ""], [257, "    /**"], [792, "    synchronized void setPresenceStatus(String statusMsg)"], [794, "        if (statusMsg.equals(jvbParticipantStatus))"], [795, "        {"], [796, "            return;"], [797, "        }"], [798, ""], [807, ""], [808, "            jvbParticipantStatus = statusMsg;"], [1072, "            if (peer != null)"], [1074, "                peer.addCallPeerConferenceListener(JvbConference.this);"], [1075, ""], [1076, "                peer.addCallPeerListener(new CallPeerAdapter()"], [1078, "                    @Override"], [1079, "                    public void peerStateChanged(CallPeerChangeEvent evt)"], [1080, "                    {"], [1081, "                        CallPeer p = evt.getSourceCallPeer();"], [1082, "                        CallPeerState peerState = p.getState();"], [1083, ""], [1084, "                        if (CallPeerState.CONNECTED.equals(peerState))"], [1085, "                        {"], [1086, "                            p.removeCallPeerListener(this);"], [1087, "                            setPresenceStatus(peerState.getStateString());"], [1088, "                        }"], [1089, "                    }"], [1090, "                });"], [1095, "                    + \"CallPeerConferenceListener because CallPeer is null\");"]], "deleted": [[787, "    void setPresenceStatus(String statusMsg)"], [1060, "            if(jvbCall != null)"], [1062, "                CallPeer peerToAdd = jvbCall.getCallPeers().next();"], [1063, "                if (peerToAdd != null)"], [1064, "                {"], [1065, "                    peerToAdd.addCallPeerConferenceListener(JvbConference.this);"], [1066, "                }"], [1067, "                else"], [1069, "                    logger.warn(callContext + \" Could not add JvbConference as \""], [1070, "                        + \"CallPeerConferenceListener because CallPeer is null\""], [1071, "                    );"], [1072, "                }"], [1077, "                    + \"CallPeerConferenceListener because jvbCall is null\");"]]}, "num_lines_added": 31, "num_lines_removed": 13}