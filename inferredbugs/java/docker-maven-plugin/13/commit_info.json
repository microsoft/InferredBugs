{"hash": "1dd01dd88bc6f76b494d87caed81b8b1b8cf2225", "message": "#351: Support for dedicarted pull and push registries added.\n\nRegistries can now be specified with 'docker.pull.registry' and 'docker.push.registry' (with a fallback 'docker.registry') as properties (or '<pullRegistry>' and '<pushRegistry>' in the plugin configuration.\nAuthentication can be specified also separately with 'docker.pull.username' / 'docker.push.username', ... and within the configuration in '<authConfig><push><username>...</username></push></authConfig' ....\n\nAlso added support autopulling and authentication of base images included in dockerfiles when 'dockerFileDir' is used. This fixes #358.", "file_num_lines": 283, "diff_parsed": {"added": [[38, "    private boolean isPush = true;"], [39, ""], [62, "        assertNull(factory.createAuthConfig(isPush, null, settings, null, \"blubberbla:1611\"));"], [67, "        System.setProperty(\"docker.push.username\",\"roland\");"], [68, "        System.setProperty(\"docker.push.password\", \"secret\");"], [69, "        System.setProperty(\"docker.push.email\", \"roland@jolokia.org\");"], [71, "            AuthConfig config = factory.createAuthConfig(true, null, settings, null, null);"], [74, "            System.clearProperty(\"docker.push.username\");"], [75, "            System.clearProperty(\"docker.push.password\");"], [76, "            System.clearProperty(\"docker.push.email\");"], [97, "                AuthConfig config = factory.createAuthConfig(isPush, null, settings, \"roland\", null);"], [119, "    private void checkDockerLogin(File homeDir,String configRegistry, String lookupRegistry)"], [120, "            throws IOException, MojoExecutionException {"], [122, "        AuthConfig config = factory.createAuthConfig(isPush, null, settings, \"roland\", lookupRegistry);"], [156, "                AuthConfig config = factory.createAuthConfig(isPush, authConfigMap, settings, \"roland\", null);"], [170, "                    AuthConfig config = factory.createAuthConfig(isPush, null, settings, \"roland\", null);"], [189, "                    AuthConfig config = factory.createAuthConfig(isPush, authConfigMap, settings, \"roland\", null);"], [206, "                AuthConfig config = factory.createAuthConfig(isPush, authConfigMap, settings, \"roland\", null);"], [227, "            factory.createAuthConfig(isPush, null, settings, null, null);"], [240, "        AuthConfig config = factory.createAuthConfig(isPush, pluginConfig, settings, null, null);"], [241, "        verifyAuthConfig(config, \"roland\", \"secret\", \"roland@jolokia.org\");"], [242, "    }"], [243, ""], [244, "    @Test"], [245, "    public void testFromPluginConfigurationPull() throws MojoExecutionException {"], [246, "        Map pullConfig = new HashMap();"], [247, "        pullConfig.put(\"username\", \"roland\");"], [248, "        pullConfig.put(\"password\", \"secret\");"], [249, "        pullConfig.put(\"email\", \"roland@jolokia.org\");"], [250, "        Map pluginConfig = new HashMap();"], [251, "        pluginConfig.put(\"pull\",pullConfig);"], [252, "        AuthConfig config = factory.createAuthConfig(false, pluginConfig, settings, null, null);"], [261, "        factory.createAuthConfig(isPush, pluginConfig, settings, null, null);"], [267, "        AuthConfig config = factory.createAuthConfig(isPush, null, settings, \"roland\", \"test.org\");"], [275, "        AuthConfig config = factory.createAuthConfig(isPush, null, settings, \"rhuss\", \"test.org\");"], [283, "        AuthConfig config = factory.createAuthConfig(isPush, null, settings, \"tanja\", null);"], [291, "        assertNull(factory.createAuthConfig(isPush, null, settings, \"roland\", \"another.repo.org\"));"]], "deleted": [[60, "        assertNull(factory.createAuthConfig(null, settings, null, \"blubberbla:1611\"));"], [65, "        System.setProperty(\"docker.username\",\"roland\");"], [66, "        System.setProperty(\"docker.password\", \"secret\");"], [67, "        System.setProperty(\"docker.email\", \"roland@jolokia.org\");"], [69, "            AuthConfig config = factory.createAuthConfig(null,settings, null, null);"], [72, "            System.clearProperty(\"docker.username\");"], [73, "            System.clearProperty(\"docker.password\");"], [74, "            System.clearProperty(\"docker.email\");"], [95, "                AuthConfig config = factory.createAuthConfig(null, settings, \"roland\", null);"], [117, "    private void checkDockerLogin(File homeDir,String configRegistry, String lookupRegistry) throws IOException,"], [118, "                                                                                    MojoExecutionException {"], [120, "        AuthConfig config = factory.createAuthConfig(null, settings, \"roland\", lookupRegistry);"], [154, "                AuthConfig config = factory.createAuthConfig(authConfigMap, settings, \"roland\", null);"], [168, "                    AuthConfig config = factory.createAuthConfig(null, settings, \"roland\", null);"], [187, "                    AuthConfig config = factory.createAuthConfig(authConfigMap, settings, \"roland\", null);"], [204, "                AuthConfig config = factory.createAuthConfig(authConfigMap, settings, \"roland\", null);"], [217, ""], [218, "    @Test(expected = MojoExecutionException.class)"], [219, "    public void testSystemPropertyNoUser() throws Exception {"], [220, "        checkException(\"docker.password\");"], [221, "    }"], [222, ""], [231, "            factory.createAuthConfig(null, settings, null, null);"], [244, "        AuthConfig config = factory.createAuthConfig(pluginConfig,settings,null,null);"], [253, "        factory.createAuthConfig(pluginConfig, settings, null, null);"], [259, "        AuthConfig config = factory.createAuthConfig(null,settings, \"roland\", \"test.org\");"], [267, "        AuthConfig config = factory.createAuthConfig(null,settings, \"rhuss\", \"test.org\");"], [275, "        AuthConfig config = factory.createAuthConfig(null,settings,\"tanja\",null);"], [283, "        assertNull(factory.createAuthConfig(null, settings, \"roland\", \"another.repo.org\"));"]]}, "num_lines_added": 37, "num_lines_removed": 29}