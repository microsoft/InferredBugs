{"hash": "b62acc88c17442763d6856ad4c7757e3fd37015b", "message": "update consensus code", "file_num_lines": 204, "diff_parsed": {"added": [[84, "            if (chain.size() == 0) {"], [100, "        BlockLog.info(str.toString());"], [106, "                if (longestChain.contains(hd)) {"], [118, "                if (approvingChain.contains(hd)) {"], [139, "            if (header.getPreHash().getDigestHex().equals(chain.getLastHd().getHash())) {"], [142, "            } else if (chain.contains(new HeaderDigest(header.getPreHash().getDigestHex(), header.getHeight() - 1, 0L))) {"], [148, "        if (this.chainList.size() > 0) {"], [149, "            System.out.println();"], [150, "        }"], [207, "        Set<HeaderDigest> removeHashSet = new HashSet<>();"], [208, "        for (int i = chainList.size() - 1; i >= 0; i--) {"], [209, "            BlockHeaderChain chain = chainList.get(i);"], [210, "            if (chain.size() < (approvingChain.size() - 6)) {"], [211, "                removeHashSet.addAll(chain.getHeaderDigestList());"], [212, "                this.chainList.remove(chain);"], [213, "            }"], [214, "        }"], [215, ""], [216, "        for (HeaderDigest hd : removeHashSet) {"], [217, "            if (!approvingChain.contains(hd)) {"], [218, "                confirmingBlockCacheManager.removeBlock(hd.getHash());"], [219, "            }"], [220, "        }"], [221, ""]], "deleted": [[59, "    private long tempIndex = 0L;"], [60, ""], [86, "            if(chain.size()==0){"], [102, "        if(tempIndex%2==0) {"], [103, "            BlockLog.info(str.toString());"], [104, "            tempIndex++;"], [105, "        }"], [111, "                if(longestChain.contains(hd)){"], [123, "                if(approvingChain.contains(hd)){"], [130, "        Set<String> rightHashSet = new HashSet<>();"], [131, "        Set<String> removeHashSet = new HashSet<>();"], [132, "        for (int i = chainList.size() - 1; i >= 0; i--) {"], [133, "            BlockHeaderChain chain = chainList.get(i);"], [134, "            if (chain.size() < (maxSize - 6)) {"], [135, "                removeHashSet.addAll(chain.getHashSet());"], [136, "                this.chainList.remove(chain);"], [137, "            } else {"], [138, "                rightHashSet.addAll(chain.getHashSet());"], [139, "            }"], [140, "        }"], [141, ""], [142, "        for (String hash : removeHashSet) {"], [143, "            if (!rightHashSet.contains(hash)) {"], [144, "                confirmingBlockCacheManager.removeBlock(hash);"], [145, "            }"], [146, "        }"], [161, "            int index = chain.indexOf(header.getPreHash().getDigestHex(), header.getHeight() - 1, header.getTime());"], [162, "            if (index == chain.size() - 1) {"], [165, "            } else if (index >= 0) {"], [171, ""]]}, "num_lines_added": 24, "num_lines_removed": 30}