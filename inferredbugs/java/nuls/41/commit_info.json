{"hash": "0fb2fae8f1edffe70828856fe479788d2556d6e0", "message": "update agent&deposit", "file_num_lines": 208, "diff_parsed": {"added": [[35, "import io.nuls.network.entity.Node;"], [36, "import io.nuls.network.service.NetworkService;"], [52, "    private NetworkService networkService = NulsContext.getServiceBean(NetworkService.class);"], [79, "        return this.request(height, height, 1, sendList);"], [93, "            if (null == sendList) {"], [95, "                List<Node> nodes = networkService.getAvailableNodes();"], [96, "                for (Node node : nodes) {"], [97, "                    this.nodeIdList.add(node.getId());"], [99, "            } else {"], [100, "                this.nodeIdList = sendList;"], [105, "            for (String nodeId : nodeIdList) {"], [106, "                boolean result = this.eventBroadcaster.sendToNode(event, nodeId);"], [107, "                if (!result) {"], [108, "                    this.nodeIdList.remove(nodeId);"], [109, "                }"], [110, "            }"], [146, "//        if (response.getHeightList().get(response.getHeightList().size() - 1) < end) {"], [147, "//            return true;"], [148, "//        }"], [234, "            if ((TimeService.currentTimeMillis() - startTime) > (timeout - 1000L) && hashesMap.size() >= ((nodeIdList.size() + 1) / 2) && end <= 0) {"], [266, "            }else if ((TimeService.currentTimeMillis() - startTime) > timeout && !(hashesMap.size() >= ((nodeIdList.size() + 1) / 2))) {"]], "deleted": [[76, "        return this.request(height, height, 1,nodeIdList);"], [90, "            if(null==sendList||sendList.isEmpty()){"], [91, "                nodeIdList = this.eventBroadcaster.broadcastAndCache(event, false);"], [92, "            }else{"], [94, "                for(String nodeId:sendList){"], [95, "                    boolean result = this.eventBroadcaster.sendToNode(event,nodeId);"], [96, "                    if(result){"], [97, "                        this.nodeIdList.add(nodeId);"], [98, "                    }"], [139, "        if (response.getHeightList().get(response.getHeightList().size() - 1) < end) {"], [140, "            return true;"], [141, "        }"], [227, "            if ((TimeService.currentTimeMillis() - startTime) > (timeout - 1000L) && hashesMap.size() >= ((nodeIdList.size() + 1) / 2) && start == end && start <= 0) {"], [259, "            } else if ((TimeService.currentTimeMillis() - startTime) > timeout && !(hashesMap.size() >= ((nodeIdList.size() + 1) / 2) && start == end && start <= 0)) {"], [267, ""]]}, "num_lines_added": 21, "num_lines_removed": 15}