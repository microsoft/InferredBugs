{"bug_class": "PROVER", "kind": "ERROR", "bug_type": "NULL_DEREFERENCE", "qualifier": "object returned by `getBlock(block.getHeader().getPreHash().getDigestHex())` could be null and is dereferenced by call to `calc(...)` at line 209.", "severity": "HIGH", "visibility": "user", "line": 209, "column": -1, "procedure": "void BlockManager.rollbackAppraval(Block)", "procedure_id": "io.nuls.consensus.manager.BlockManager.rollbackAppraval(io.nuls.core.chain.entity.Block):void.be90ff19b4c1bed81e47b320e8812aa1", "procedure_start_line": 203, "file": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "bug_trace": [{"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 203, "column_number": -1, "description": "start of procedure rollbackAppraval(...)"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 204, "column_number": -1, "description": "Taking false branch"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 208, "column_number": -1, "description": ""}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/Block.java", "line_number": 91, "column_number": -1, "description": "start of procedure getTxs()"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/Block.java", "line_number": 92, "column_number": -1, "description": "return from a call to List Block.getTxs()"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 208, "column_number": -1, "description": ""}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/Block.java", "line_number": 91, "column_number": -1, "description": "start of procedure getTxs()"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/Block.java", "line_number": 92, "column_number": -1, "description": "return from a call to List Block.getTxs()"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 208, "column_number": -1, "description": "Skipping rollbackTxList(...): empty list of specs"}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 185, "column_number": -1, "description": "Definition of rollbackTxList(...)"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 209, "column_number": -1, "description": ""}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/PackingRoundManager.java", "line_number": 91, "column_number": -1, "description": "start of procedure getValidateInstance()"}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/PackingRoundManager.java", "line_number": 92, "column_number": -1, "description": "return from a call to PackingRoundManager PackingRoundManager.getValidateInstance()"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 209, "column_number": -1, "description": ""}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/Block.java", "line_number": 99, "column_number": -1, "description": "start of procedure getHeader()"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/Block.java", "line_number": 100, "column_number": -1, "description": "return from a call to BlockHeader Block.getHeader()"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 209, "column_number": -1, "description": ""}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/BlockHeader.java", "line_number": 125, "column_number": -1, "description": "start of procedure getPreHash()"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/BlockHeader.java", "line_number": 126, "column_number": -1, "description": "return from a call to NulsDigestData BlockHeader.getPreHash()"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 209, "column_number": -1, "description": ""}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/NulsDigestData.java", "line_number": 101, "column_number": -1, "description": "start of procedure getDigestHex()"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/NulsDigestData.java", "line_number": 103, "column_number": -1, "description": "Skipping serialize(): empty list of specs"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/chain/entity/BaseNulsData.java", "line_number": 72, "column_number": -1, "description": "Definition of serialize()"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/NulsDigestData.java", "line_number": 103, "column_number": -1, "description": ""}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 36, "column_number": -1, "description": "start of procedure encode(...)"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 37, "column_number": -1, "description": "Skipping StringBuffer(...): unknown method"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 40, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 41, "column_number": -1, "description": "Taking false branch"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 45, "column_number": -1, "description": "Skipping append(...): unknown method"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 40, "column_number": -1, "description": "Taking false branch"}, {"level": 2, "filename": "core/src/main/java/io/nuls/core/utils/crypto/Hex.java", "line_number": 48, "column_number": -1, "description": "return from a call to String Hex.encode(byte[])"}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/NulsDigestData.java", "line_number": 103, "column_number": -1, "description": ""}, {"level": 1, "filename": "core/src/main/java/io/nuls/core/chain/entity/NulsDigestData.java", "line_number": 106, "column_number": -1, "description": "return from a call to String NulsDigestData.getDigestHex()"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 209, "column_number": -1, "description": ""}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 227, "column_number": -1, "description": "start of procedure getBlock(...)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 86, "column_number": -1, "description": "start of procedure getBlock(...)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 87, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 87, "column_number": -1, "description": "Taking false branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 90, "column_number": -1, "description": ""}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "start of procedure get(...)"}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "return from a call to Object CacheMap.get(Object)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 90, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 91, "column_number": -1, "description": ""}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "start of procedure get(...)"}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "return from a call to Object CacheMap.get(Object)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 91, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 92, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 92, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 92, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 93, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/ConfirmingBlockCacheManager.java", "line_number": 98, "column_number": -1, "description": "return from a call to Block ConfirmingBlockCacheManager.getBlock(String)"}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 228, "column_number": -1, "description": "Taking true branch"}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 229, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 89, "column_number": -1, "description": "start of procedure getBlock(...)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 90, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 90, "column_number": -1, "description": "Taking false branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 93, "column_number": -1, "description": ""}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "start of procedure get(...)"}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "return from a call to Object CacheMap.get(Object)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 93, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 94, "column_number": -1, "description": ""}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "start of procedure get(...)"}, {"level": 3, "filename": "cache/src/main/java/io/nuls/cache/util/CacheMap.java", "line_number": 75, "column_number": -1, "description": "return from a call to Object CacheMap.get(Object)"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 94, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 95, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 95, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 95, "column_number": -1, "description": "Taking true branch"}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 96, "column_number": -1, "description": ""}, {"level": 2, "filename": "consensus-impl/src/main/java/io/nuls/consensus/cache/manager/block/BlockCacheBuffer.java", "line_number": 101, "column_number": -1, "description": "return from a call to Block BlockCacheBuffer.getBlock(String)"}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 231, "column_number": -1, "description": "return from a call to Block BlockManager.getBlock(String)"}, {"level": 0, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/BlockManager.java", "line_number": 209, "column_number": -1, "description": ""}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/PackingRoundManager.java", "line_number": 418, "column_number": -1, "description": "start of procedure calc(...)"}, {"level": 1, "filename": "consensus-impl/src/main/java/io/nuls/consensus/manager/PackingRoundManager.java", "line_number": 419, "column_number": -1, "description": ""}], "key": "BlockManager.java|rollbackAppraval|NULL_DEREFERENCE", "node_key": "1a10361befdb402b6dd5aef86313edb7", "hash": "998df08f248adf6abb70aafcfaf2b8c5", "bug_type_hum": "Null Dereference", "censored_reason": ""}