{"hash": "4c302ac983a5bc263da80d09873f49de22c480f5", "message": "origin header usage", "file_num_lines": 115, "diff_parsed": {"added": [[13, "import static org.jboss.netty.handler.codec.http.HttpHeaders.Names.*;"], [14, "import static org.jboss.netty.handler.codec.http.HttpHeaders.Values.*;"], [28, "import org.jboss.netty.handler.codec.http.HttpHeaders;"], [51, "\tprivate String origin;"], [70, "    \tthis.isKeepAlive = HttpHeaders.isKeepAlive(req);"], [71, "    \tthis.origin = req.getHeader(HttpHeaders.Names.ORIGIN);"], [77, "    private synchronized ChannelFuture sendPayload() {"], [90, "        res.addHeader(CONNECTION, KEEP_ALIVE);"], [91, "        if (origin != null) {"], [92, "        \tres.addHeader(\"Access-Control-Allow-Origin\", origin);"], [93, "        \tres.addHeader(\"Access-Control-Allow-Credentials\", \"true\");"], [94, "        }"], [96, "        \tres.addHeader(CONTENT_TYPE, \"application/javascript\");"], [100, "        HttpHeaders.setContentLength(res, res.getContent().readableBytes());"], [104, "        origin = null;"]], "deleted": [[13, "import static org.jboss.netty.handler.codec.http.HttpHeaders.isKeepAlive;"], [14, "import static org.jboss.netty.handler.codec.http.HttpHeaders.setContentLength;"], [15, "import static org.jboss.netty.handler.codec.http.HttpHeaders.Names.CONTENT_TYPE;"], [69, "    \tisKeepAlive = isKeepAlive(req);"], [75, "    private ChannelFuture sendPayload() {"], [88, "        res.addHeader(\"Access-Control-Allow-Origin\", \"*\");"], [89, "        res.addHeader(\"Access-Control-Allow-Credentials\", \"true\");"], [90, "        res.addHeader(\"Connection\", \"keep-alive\");"], [92, "        \tres.addHeader(\"Content-Type\", \"application/javascript\");"], [96, "        setContentLength(res, res.getContent().readableBytes());"], [97, ""]]}, "num_lines_added": 15, "num_lines_removed": 11}