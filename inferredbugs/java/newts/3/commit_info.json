{"hash": "a6c72b8c38ece50aca6e21a31c911425afa3b009", "message": "separate cli options by command", "file_num_lines": 68, "diff_parsed": {"added": [[4, "import java.io.PrintStream;"], [5, ""], [9, "import com.google.common.base.Joiner;"], [10, ""], [14, "    private static void printSynopsis(PrintStream stream) {"], [15, "        stream.printf(\"%njava %s <command> [options...]%n%n\", Main.class.getCanonicalName());"], [16, "    }"], [17, ""], [18, "    private static void printUsage(PrintStream stream, CmdLineParser parser) {"], [19, "        printSynopsis(stream);"], [20, "        parser.printUsage(stream);"], [21, "    }"], [23, "    private static void printCmdUsage(PrintStream stream) {"], [24, "        printSynopsis(stream);"], [25, "        stream.printf(\"Available commands: %s%n%n\", Joiner.on(\", \").join(Config.Command.values()));"], [26, "    }"], [27, ""], [28, "    private static void parseArguments(Config config, String... args) {"], [37, "            printUsage(System.err, parser);"], [41, "        if (config.needHelp()) {"], [42, "            printUsage(System.out, parser);"], [43, "            System.exit(0);"], [44, "        }"], [49, "        // Manually grok the command argument in order to conditionally apply different options."], [50, "        if (args.length < 1) {"], [51, "            System.err.println(\"Missing command argument.\");"], [52, "            printCmdUsage(System.err);"], [53, "            System.exit(1);"], [54, "        }"], [55, ""], [56, "        Config.Command command = null;"], [57, ""], [58, "        try {"], [59, "            command = Config.Command.valueOf(args[0].toUpperCase());"], [60, "        }"], [61, "        catch (IllegalArgumentException ex) {"], [62, "            System.err.println(\"Unknown command: \" + args[0]);"], [63, "            printCmdUsage(System.err);"], [64, "            System.exit(1);"], [65, "        }"], [66, ""], [67, "        Config config;"], [70, "        switch (command) {"], [72, "                config = new InsertConfig();"], [73, "                parseArguments(config, args);"], [74, "                dispatcher = new InsertDispatcher((InsertConfig) config);"], [77, "                config = new SelectConfig();"], [78, "                parseArguments(config, args);"], [79, "                dispatcher = new SelectDispatcher((SelectConfig) config);"]], "deleted": [[10, "    private static Config getConfig(String... args) {"], [12, "        Config config = new Config();"], [21, "            System.err.printf(\"%njava %s [options] <command>%n%n\", Main.class.getCanonicalName());"], [22, "            parser.printUsage(System.err);"], [26, "        return config;"], [31, "        Config config = getConfig(args);"], [34, "        switch (config.getCommand()) {"], [36, "                dispatcher = new InsertDispatcher(config);"], [39, "                dispatcher = new SelectDispatcher(config);"]]}, "num_lines_added": 49, "num_lines_removed": 9}